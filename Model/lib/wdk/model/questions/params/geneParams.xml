<wdkModel>

  <!-- notes

  * need to correct OrganismWithEC cv query

-->


  <!--===========================================================================-->
  <!-- Params  -->
  <!--===========================================================================-->

  <paramSet name="geneParams">

    <!-- Answer params for gene and transcript transforms; the value for this param
         is SQL: either to select from a cache table, or the whole ID query (if uncached).
         The value is populated by WDK automatically from a step ID stable value. -->

    <answerParam name="gene_result"
                 prompt="Input Result Set"
                 readonly="true"
                 visible="false">
      <recordClass ref="TranscriptRecordClasses.TranscriptRecordClass" />
    </answerParam>

    <answerParam name="transcript_result"
                 prompt="Input Result Set"
                 readonly="true"
                 visible="false">
      <recordClass ref="GeneRecordClasses.GeneRecordClass" />
    </answerParam>



    <flatVocabParam name="signalp_version"
                    queryRef="GeneVQ.SignalpVersion"
                    prompt="Version"
                    multiPick="false" >
      <help>SignalP Version</help>
    </flatVocabParam>

    <flatVocabParam name="phenotypeScoreDataset"
                    queryRef="GeneVQ.PhenotypeScoreDataset"
                    prompt="Dataset"
                    quote="false"
                    visible="false"
                    multiPick="false" >
      <help>Internal Dataset Name</help>
    </flatVocabParam>

    <!--
    <flatVocabParam name="phenotypeDataset"
                    queryRef="GeneVQ.PhenotypeDataset"
                    prompt="Dataset"
                    quote="false"
                    visible="false"
                    multiPick="false" >
      <help>Internal Dataset Name</help>
    </flatVocabParam>
    -->

    <!--
      This should be a flatVocabParam that returns all datasets.
      When needed, a query can override the queryRef for a more
      constrained set of datasets.
    -->
    <stringParam name="eda_dataset_id"
                 prompt="EDA Dataset ID"
                 number="false"
                 visible="true">
      <noTranslation value="true"/>
    </stringParam>

    <stringParam name="eda_analysis_spec"
                 prompt="Filter genes based on the data below"
                 number="false"
                 multiLine="true">
      <noTranslation value="true"/>
      <help>Filter genes based on the data below, and then click Get Answer to see your list of genes.</help>
      <visibleHelp><![CDATA[Specify your set of genes by clicking on one or more variables in the panel at left; 
                            then interact with the variable display on the right to subset on the selected variable.<br>
                            After subsetting, click <strong>Get Answer</strong> to get the specified set of genes.]]></visibleHelp>
    </stringParam>


    <enumParam name="metacycle_protocol" prompt="Protocol" quote="false">
      <help>
        Select the algorithm for MetaCycle analysis
      </help>
      <enumList>
        <enumValue>
          <term>JTK_Cycle</term>
          <internal>JTKresult_</internal>
        </enumValue>
        <enumValue>
          <term>ARSER</term>
          <internal>ARSresult_</internal>
        </enumValue>

      </enumList>
    </enumParam>

   <numberRangeParam name="metacycle_period"
                      prompt="Period Range"
                      integer="false"
                      min="20"
                      max="28"
                      increment="1">
      <help>Set the range of period length of interested rhythm that match your search criteria to restrict the number of genes returned.</help>
      <suggest default="{'min': '20', 'max': '28'}" />
   </numberRangeParam>

   <stringParam name="metacycle_amplitude"
                     prompt="Amplitude equals to or greater than (fpkm)"
                     number="true">
       <help>The amplitude value for this search.</help>
       <suggest default="5"/>
     </stringParam>


     <stringParam name="metacycle_pvalue"
                     prompt="P value  equals to or less than"
                     number="true">
       <help>The p value cutoff for this search.
       </help>
       <suggest default="0.05"/>
     </stringParam>



<!-- intronjunction params -->

    <numberRangeParam name="percent_max"
                      prompt="Percent of Most Abundant Intron (MAI)"
                      integer="false"
                      min="1"
                      max="100"
                      increment="100">
      <help>The most abundant intron (MAI; supported by the highest number of intron-spanning reads; ISRs) provides context for the expected observation frequency: introns mistakenly omitted from the gene model are likely to be as abundant as correctly annotated introns; alternative splice variants may be observed at ~20-80%, but you may not be interested in rare 'typographical errors' made by the splicing machinery.</help>
      <suggest default="{'min': '20', 'max': '100'}" />
    </numberRangeParam>

    <numberRangeParam name="number_annot_introns"
                      prompt="Number of annotated introns"
                      integer="true"
                      min="1"
                      max="100"
                      increment="1">
      <help>Set the range of number of exons in the genes you want to consider.  For example, if you don't want to include single exon genes set the min to 2.</help>
      <suggest default="{'min': '1', 'max': '30'}" />
   </numberRangeParam>

   <stringParam name="min_total_unique"
                prompt="Minimum number of unique reads &gt;="
                number="true"
                excludeProjects="VectorBase">
     <help>Enter the minimum number of total unique reads required to consider an intron.</help>
     <suggest default="20" />
   </stringParam>

   <stringParam name="min_total_unique"
                prompt="Minimum unique reads / million (ISRPM) &gt;="
                number="true"
                includeProjects="VectorBase,UniDB">
     <help>Enter the minimum number of total ISRPM (unique intron spaning reads per million intron spanning reads) required to consider an intron.</help>
     <suggest default="20" />
   </stringParam>

   <stringParam name="max_flanking_bp"
                prompt="Consider 5' &amp; 3' Flanking Sequence up to (bp)"
                number="true">
     <help>Enter the maximum number of nucleotides flanking the annotated gene model to explore when looking for unannotated introns.  Search automatically includes the annotated gene model, and only considers putative introns on the same strand. </help>
     <suggest default="0" />
   </stringParam>

    <!-- iterativeWGCNA Starts -->

    <!--
    <flatVocabParam name="wgcna_study" includeProjects="UniDB"
                    queryRef="GeneVQ.wgcna_study"
                    prompt="Study/Experiment"
                    quote="false"
                    multiPick="false" >
      <help>Choose the Study/Experiment that you are interested in</help>
    </flatVocabParam>
-->

    <!--
   <numberRangeParam name="wgcna_kME"
                      prompt="Correlation"
                      integer="false"
                      min="0.00"
                      max="1.00"
                      increment="0.1">
      <help>Set the range of (Module Membership) kME of interested that match your search criteria to restrict the number of genes returned.</help>
      <suggest default="{'min': '0.5', 'max': '1.0'}" />
   </numberRangeParam>


   <stringParam name="wgcna_profileGeneId"
                     prompt="Gene ID"
		     number="false">
       <help>Input of interested gene ID, which will return all matched genes within the same functional module</help>
       <suggest default="PF3D7_0100100"/>
   </stringParam>

-->

  <flatVocabParam name="singleCellDataset" includeProjects="TriTrypDB,PlasmoDB,PiroplasmaDB,ToxoDB,HostDB,CryptoDB,UniDB"
                  queryRef="GeneVQ.singleCellDataset"
                  prompt="Single Cell RNA-Seq Dataset"
                  quote="false"
                  multiPick="false"
                  dependedParamRef="organismParams.organismsWithSingleCell">
    <help>Please choose the datasets you wish to query</help>
  </flatVocabParam>


    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!-- WGCNA module parameters -->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

    <flatVocabParam name="wgcnaDataset"
                    queryRef="GeneVQ.wgcnaDataset"
                    prompt="WGCNA Module Dataset"
                    visible="false"
                    quote="false"
                    multiPick="false" >
      <help>Please choose a dataset.</help>
    </flatVocabParam>

  <flatVocabParam name="wgcnaParam"
                 queryRef="GeneVQ.wgcnaParam"
                 prompt="WGCNA Module (co-expression network)"
                 visible="true"
                 multiPick="false"
                 dependedParamRef="geneParams.wgcnaDataset">

      <help>Gene expression (RNA Seq) was clustered (WGCNA) across all samples in this study to find groups or networks of co-expressed genes (WGCNA module).  Choose a co-expression network to discover what genes are in this network.</help>
    </flatVocabParam>

  <stringParam name="wgcna_correlation_cutoff"
                prompt="Gene expression correlation with module eigengene greater than or equal to"
                number="true"
                visible="true">
      <help>The eigengene is created in the WGCNA analysis and is an imaginary gene whose expression profile represents an average gene within the co-expression network. It is very likely that no gene within the network has the exact expression profile of the eigengene. Choose the correlation coefficient that a gene’s expression profile must share with the eigengene for the gene to be considered a member of the co-expression network.
       </help>
      <suggest default="0.75"/>
  </stringParam>



    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!-- Gene List params -->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

    <flatVocabParam name="geneListDataset"
                    queryRef="GeneVQ.geneListDataset"
                    prompt="Gene List Dataset"
                    visible="false"
                    quote="false"
                    multiPick="false" >
      <help>Please choose a dataset.</help>
    </flatVocabParam>

    <flatVocabParam name="geneListParam"
                    queryRef="GeneVQ.geneListParam"
                    prompt="Gene List"
                    visible="true"
                    multiPick="false"
                    dependedParamRef="geneParams.geneListDataset">

    <help>Please select a list of genes.</help>
  </flatVocabParam>

  <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <!-- LOPIT params -->
  <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <flatVocabParam name="lopit_method" includeProjects="ToxoDB,TriTrypDB,UniDB"
                 queryRef="GeneVQ.lopitMethod"
                 prompt="Method"
                 visible="true"
                 multiPick="false"
                 dependedParamRef="organismParams.organismWithLopitData">
    <help>Please select the organism.</help>
  </flatVocabParam>

    <filterParam name="lopit_filter" includeProjects="ToxoDB,TriTrypDB,UniDB"
                 ontologyQueryRef="GeneVQ.lopitOntologyQuery"
                 metadataQueryRef="GeneVQ.lopitMetadataQuery"
                 backgroundQueryRef="GeneVQ.lopitMetadataQuery"
                 countPredictsAnswerCount="true"
                 filterDataTypeDisplayName="genes"
                 prompt="Subcellular location probabilities"
                 dependedParamRef="geneParams.lopit_method"
                 trimMetadataTerms="true">
      <help>
        Select one of the 26 defined subcellular locations or “Any compartments” to filter proteins based on the localization probability.
      </help>
    </filterParam>


    <filterParam name="gene_model_char"
                 ontologyQueryRef="GeneVQ.GeneModelCharOntology"
                 metadataQueryRef="GeneVQ.GeneModelCharMetadata"
                 backgroundQueryRef="GeneVQ.GeneModelCharMetadata"
                 countPredictsAnswerCount="true"
                 prompt="Gene Model Characteristics"
                 dependedParamRef="geneParams.gene_or_transcript,organismParams.organism_select_all"
                 trimMetadataTerms="true">
      <visibleHelp><![CDATA[
      Be sure to select organism (species) of interest, and specify additional constraints if desired (eg. protein-coding genes, tRNAs, etc).  Both <a href="http://useast.ensembl.org/info/genome/genebuild/biotypes.html">Biotype Classifications</a> and <a href="http://www.sequenceontology.org/">Sequence Ontology Terms</a> are available as filters.
        ]]>
      </visibleHelp>
      <help>
        Be sure to select organism (species) of interest, and specify additional constraints if desired (eg. protein-coding genes, tRNAs, etc).
      </help>
    </filterParam>





    <flatVocabParam name="geneListUserDataset"
                    queryRef="GeneVQ.geneListUserDataset"
                    prompt="Your Gene List Dataset"
                    quote="false"
                    multiPick="false" >
      <help>A Gene List dataset you have imported into your workspace, and that is installed in @PROJECT_ID@ </help>
    </flatVocabParam>



    <enumParam name="RodMalStage"
               prompt="Stage in which phenotype is observed" quote="false">
      <help>
        Select the lifecycle stage in which you want to look for phenotype changes
      </help>
      <enumList>
        <enumValue default="true">
          <term>Gametocyte</term>
          <internal>gametocyte</internal>
        </enumValue>
        <enumValue>
          <term>Asexual</term>
          <internal>asexual</internal>
        </enumValue>
        <enumValue>
          <term>Ookinete</term>
          <internal>ookinete</internal>
        </enumValue>
        <enumValue>
          <term>Oocyst</term>
          <internal>oocyst</internal>
        </enumValue>
        <enumValue>
          <term>Sporozoite</term>
          <internal>sporozoite</internal>
        </enumValue>
        <enumValue>
          <term>Liver Stage</term>
          <internal>liverstage</internal>
        </enumValue>
      </enumList>
    </enumParam>

    <enumParam name="RodMalType"
               prompt="Type of gene modification" multiPick="true" displayType="checkBox">
      <help>
        Select gene modification by mutation or disruption
      </help>
      <enumList>
        <enumValue default="true">
          <term>Mutated</term>
          <internal>mutated</internal>
        </enumValue>
        <enumValue>
          <term>Disrupted</term>
          <internal>disrupted</internal>
        </enumValue>
      </enumList>
    </enumParam>

    <enumParam name="RodMalSuccess"
               prompt="Success of gene modification">
      <help>
        Select whether the modification was successful or not
      </help>
      <enumList>
        <enumValue default="true">
          <term>Successful</term>
          <internal>yes</internal>
        </enumValue>
        <enumValue>
          <term>Unsuccessful</term>
          <internal>no</internal>
        </enumValue>
      </enumList>
    </enumParam>

    <enumParam name="RodMalPhenotype"
               prompt="Effect on Phenotype">
      <help>
        Select the effect on the phenotype from not different to wild-type, changed from wild-type or not tested.  Specifics of phenotype changes can be viewed on the gene record pages
      </help>
      <enumList>
        <enumValue>
          <term>Not Tested</term>
          <internal>0</internal>
        </enumValue>
        <enumValue>
          <term>Not different to wild-type</term>
          <internal>1</internal>
        </enumValue>
        <enumValue default="true">
          <term>Changed from wild-type</term>
          <internal>2</internal>
        </enumValue>
      </enumList>
    </enumParam>



    <enumParam name="protein_coding_only"
               prompt="Protein Coding Only:"
               multiPick="false"
               quote="true">

      <help>Should only protein coding genes be returned?</help>
      <enumList>
        <enumValue default="true">
          <display>protein coding</display>
          <term>yes</term>
          <internal>protein coding gene</internal>
        </enumValue>
        <enumValue>
          <display>all</display>
          <term>no</term>
          <internal>no</internal>
        </enumValue>
      </enumList>
    </enumParam>


    <enumParam name="channel"
               prompt="Channel :"
               multiPick="false"
               visible="false"
               quote="false">
      <help>For two Channel Microarray experiments, percentiles are computed on raw data.  Channel 1 corresponds to the numerator of the ratio and Channel 2 the denominator.  Often it is necessary to look at a corresponding bar graph for this study to determine which channel is approprate.  If the experiment was a two channel w/ a common reference you are most likely interested in channel 1.</help>
      <enumList>
        <enumValue default="true">
          <term>Channel 1</term>
          <internal>channel1</internal>
        </enumValue>
        <enumValue>
          <term>Channel 2</term>
          <internal>channel2</internal>
        </enumValue>
      </enumList>
    </enumParam>

    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!-- Gene Id -->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

    <stringParam name="single_gene_id"
                 prompt="Gene ID"
                 length="100"
                 number="false">
      <help><![CDATA[Enter the ID for the gene that you wish to query. ]]></help>
      <suggest default="%%defaultGene%%"/>
      <regex>
        <![CDATA[
                   ^[^\\]*$
                ]]>
      </regex>
    </stringParam>

    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!-- TFBS chip params -->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

    <flatVocabParam name="tfbs_name" includeProjects="PlasmoDB,EuPathDB,UniDB"
                    queryRef="GeneVQ.TfbsNames"
                    prompt="Transcription Factor"
                    quote="true"
                    multiPick="false" >
      <help>The image displayed below indicates the binding site for the chosen transcription factor.</help>
    </flatVocabParam>

    <stringParam name="tfbs_distance" includeProjects="EuPathDB,PlasmoDB,UniDB"
                 prompt="Maximum distance from 5' gene end"
                 number="true">
      <help>Enter the maximum distance you want to allow the center of the peak to be from the 5' end of the gene.  Note that the larger the value entered here (3000 bp maximum) the greater the chance for aberrant results.</help>
      <suggest default="1000" />
    </stringParam>

    <enumParam name="tfbs_pvalue" includeProjects="EuPathDB,PlasmoDB,UniDB"
               prompt="p value &lt;="
               multiPick="false"
               displayType="checkBox"
               quote="false">
      <help>
        <![CDATA[
        The p value cutoff for this search. The P value is the probability that the binding site with that score would match at that position given the input DNA (inter-genic and telomeric regions).  For example, a P value of 1X10<sup>-4</sup> means that you would find a match that good every 10,000 basepairs on average on that strand.
          ]]>
      </help>
      <enumList>
        <enumValue>
          <display><![CDATA[1X10<sup>-5</sup>]]></display>
          <term>1E-5</term>
          <internal>1E-5</internal>
        </enumValue>
        <enumValue>
          <display><![CDATA[5X10<sup>-5</sup>]]></display>
          <term>5E-5</term>
          <internal>5E-5</internal>
        </enumValue>
        <enumValue default="true">
          <display><![CDATA[1X10<sup>-4</sup>]]></display>
          <term>1E-4</term>
          <internal>1E-4</internal>
        </enumValue>
        <enumValue>
          <display><![CDATA[5X10<sup>-4</sup>]]></display>
          <term>5E-4</term>
          <internal>5E-4</internal>
        </enumValue>
      </enumList>
    </enumParam>

    <enumParam name="tfbs_num_sites" includeProjects="PlasmoDB,UniDB"
               prompt="Minimum number of sites / gene"
               multiPick="false"
               quote="false">
      <help>
        Choose the minimum number of sites per gene that meet your other criteria.
      </help>
      <enumList>
        <enumValue default="true">
          <term>1</term>
          <internal>1</internal>
        </enumValue>
        <enumValue>
          <term>2</term>
          <internal>2</internal>
        </enumValue>
        <enumValue>
          <term>3</term>
          <internal>3</internal>
        </enumValue>
        <enumValue>
          <term>4</term>
          <internal>4</internal>
        </enumValue>
      </enumList>
    </enumParam>

    <enumParam name="tfbs_direction" includeProjects="PlasmoDB,UniDB"
               prompt="Binding Site location relative to 5' end of gene"
               multiPick="false"
               quote="true">
      <help>
        Choose whether the peak should be upstream or downstream of the 5' end of the gene.
      </help>
      <enumList>
        <enumValue>
          <term>Upstream</term>
          <internal>-</internal>
        </enumValue>
        <enumValue>
          <term>Downstream</term>
          <internal>+</internal>
        </enumValue>
        <enumValue default="true">
          <term>Either</term>
          <internal>Either</internal>
        </enumValue>
      </enumList>
    </enumParam>


    <enumParam name="tagType"
               prompt="Location of tag"
               quote="false"
               displayType="checkBox"
               multiPick="false">
      <noTranslation value="true" includeProjects="TriTrypDB,GiardiaDB,UniDB" />
      <help>Choose which images you would like to see between N terminal C terminal tags.</help>
      <enumList>
        <enumValue>
          <display> N-terminal</display>
          <term>N terminal tag - mNG (fluorescent tag) image</term>
          <internal>N terminal tag - mNG (fluorescent tag) image</internal>
        </enumValue>
        <enumValue default="true">
          <display>C-terminal</display>
          <term>C terminal tag - mNG (fluorescent tag) image</term>
          <internal>C terminal tag - mNG (fluorescent tag) image</internal>
        </enumValue>
      </enumList>
    </enumParam>




    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!-- ChIP chip params -->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

    <stringParam name="chip_distance" includeProjects="FungiDB,ToxoDB,EuPathDB,PlasmoDB,TriTrypDB,UniDB"
                 prompt="Maximum distance from 5' gene end"
                 number="true">
      <help>Enter the maximum distance you want to allow the center of the peak to be from the 5' end of the gene.  Note that the larger the value entered here (3000 bp maximum) the greater the chance for aberrant results.</help>
      <suggest default="1000" />
    </stringParam>

    <stringParam name="chip_score" includeProjects="FungiDB,ToxoDB,EuPathDB,PlasmoDB,TriTrypDB,UniDB"
                 prompt="Peak score >"
                 number="true">
      <help>The score for a peak is the average of the normalized log ratio values for all the probes covered in the peak (the log ratio value of the probe used in computing the average is normalized with respect to all the probes).</help>
      <suggest default="0" />
    </stringParam>




    <enumParam name="chip_reps" includeProjects="ToxoDB,UniDB"
               prompt="Number of peaks"
               multiPick="false"
               quote="false">
      <help>
        Choose the number of peaks for this antibody/treatment.  Note that the PLK (TypeII) strain was only done with one replicate.  Note that this is the total number of peaks per antibody/treatment pair.
      </help>
      <enumList>
        <enumValue default="true">
          <term>1</term>
          <internal>1</internal>
        </enumValue>
        <enumValue>
          <term>2</term>
          <internal>2</internal>
        </enumValue>
      </enumList>
    </enumParam>

    <enumParam name="chip_direction" includeProjects="FungiDB,ToxoDB,EuPathDB,PlasmoDB,TriTrypDB,UniDB"
               prompt="Peak location relative to 5' end of gene"
               multiPick="false"
               quote="true">
      <help>
        Choose whether the peak should be upstream or downstream of the 5' end of the gene.
      </help>
      <enumList>
        <enumValue>
          <term>Upstream</term>
          <internal>-</internal>
        </enumValue>
        <enumValue>
          <term>Downstream</term>
          <internal>+</internal>
        </enumValue>
        <enumValue default="true">
          <term>Either</term>
          <internal>Either</internal>
        </enumValue>
      </enumList>
    </enumParam>


    <flatVocabParam name="chip_strains" includeProjects="ToxoDB,UniDB"
                    queryRef="GeneVQ.ChIp_Assays"
                    prompt="Strain used in assay"
                    quote="true"
                    multiPick="false" >
      <help>Choose a strain from which the samples were prepared.</help>
    </flatVocabParam>

    <flatVocabParam name="chip_antibody_toxo" includeProjects="ToxoDB,UniDB"
                    queryRef="GeneVQ.ChIPAntibodyToxo"
                    prompt="Antibody/Treatment"
                    quote="true"
                    displayType="checkBox"
                    multiPick="false"
                    dependedParamRef="geneParams.chip_strains">
      <help>Choose an Antibody</help>
      <suggest selectMode="none" />
    </flatVocabParam>

    <flatVocabParam name="chip_replicates" includeProjects="ToxoDB,UniDB"
                    queryRef="GeneVQ.ChIPReplicates"
                    prompt="Present in both replicates"
                    quote="true"
                    displayType="checkBox"
                    multiPick="false"
                    dependedParamRef="geneParams.chip_strains">
      <help>Choose 'Yes' if you would like to fetch genes that have evidence from both replicates.</help>
      <suggest selectMode="none" />
    </flatVocabParam>

    <flatVocabParam name="chip_replicates_plasmo" includeProjects="PlasmoDB,UniDB"
                    queryRef="GeneVQ.PlasmoChIPReplicates"
                    prompt="Present in both replicates"
                    quote="true"
                    displayType="checkBox"
                    multiPick="false"
                    dependedParamRef="geneParams.chip_experiment">
      <help>Choose 'Yes' if you would like to fetch genes that have evidence from both replicates.</help>
      <suggest selectMode="none" />
    </flatVocabParam>

    <flatVocabParam name="chip_experiment" includeProjects="PlasmoDB,UniDB"
                    queryRef="GeneVQ.ChIp_Experiments"
                    prompt="ChIP chip Experiment"
                    quote="false"
                    multiPick="false" >
      <help>Choose a ChIP on chip assay/experiment</help>
    </flatVocabParam>

    <flatVocabParam name="chip_antibody_plasmo" includeProjects="PlasmoDB,UniDB"
                    queryRef="GeneVQ.ChIPAntibodyPlasmo"
                    prompt="Antibody used in the assay"
                    quote="true"
                    displayType="checkBox"
                    multiPick="false"
                    dependedParamRef="geneParams.chip_experiment">
      <help>Choose an Antibody</help>
      <suggest selectMode="none" />
    </flatVocabParam>

    <flatVocabParam name="chip_genotypes" includeProjects="PlasmoDB,UniDB"
                    queryRef="GeneVQ.ChIPGenotype"
                    prompt="Genotype used in the assay"
                    quote="true"
                    displayType="checkBox"
                    multiPick="false"
                    dependedParamRef="geneParams.chip_experiment">
      <help>Choose a Genotype</help>
      <suggest selectMode="none" />
    </flatVocabParam>


    <flatVocabParam name="metabolic_pathway_id" includeProjects="PlasmoDB,UniDB"
                    queryRef="GeneVQ.MetbPathwaysList"
                    prompt="Metabolic Pathways"
                    quote="true"
                    multiPick="false">
      <help>Choose a Pathway for which you wish to find associated genes</help>
      <suggest selectMode="none" />
    </flatVocabParam>

    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!-- temporary question for modified annotation -->
    <!--+++++++++++++++++++queryset+++++++++++++++++++++++++++++++++++++++++++-->

    <enumParam name="plasmo_new_product"
               prompt="Product Name Changed"
               multiPick="false"
               quote="false">
      <help>
        Choose whether to return genes with new gene product names since the last @PROJECT_ID@ release.
      </help>
      <enumList>
        <enumValue>
          <term>Yes</term>
          <internal> > 0</internal>
        </enumValue>
        <enumValue>
          <term>No</term>
          <internal> = 0</internal>
        </enumValue>
        <enumValue default="true">
          <term>Don't care</term>
          <internal> = -1</internal>
        </enumValue>
      </enumList>
    </enumParam>

    <enumParam name="plasmo_new_ec"
               prompt="EC Numbers Changed"
               multiPick="false"
               quote="false">
      <help>
        Choose whether to return genes with altered EC numbers since the last @PROJECT_ID@ release.
      </help>
      <enumList>
        <enumValue>
          <term>Yes</term>
          <internal> > 0</internal>
        </enumValue>
        <enumValue>
          <term>No</term>
          <internal> = 0</internal>
        </enumValue>
        <enumValue default="true">
          <term>Don't care</term>
          <internal> = -1</internal>
        </enumValue>
      </enumList>
    </enumParam>

    <enumParam name="plasmo_new_go"
               prompt="GO Functions Changed"
               multiPick="false"
               quote="false">
      <help>
        Choose whether to return genes with altered Gene Ontology (GO) assignments since the last @PROJECT_ID@ release.
      </help>
      <enumList>
        <enumValue>
          <term>Yes</term>
          <internal> > 0</internal>
        </enumValue>
        <enumValue>
          <term>No</term>
          <internal> = 0</internal>
        </enumValue>
        <enumValue default="true">
          <term>Don't care</term>
          <internal> = -1</internal>
        </enumValue>
      </enumList>
    </enumParam>

    <enumParam name="plasmo_new_cds"
               prompt="Coding Sequence Changed"
               multiPick="false"
               quote="false">
      <help>
        Choose whether to return genes with altered coding sequence since the last @PROJECT_ID@ release.
      </help>
      <enumList>
        <enumValue>
          <term>Yes</term>
          <internal> > 0</internal>
        </enumValue>
        <enumValue>
          <term>No</term>
          <internal> = 0</internal>
        </enumValue>
        <enumValue default="true">
          <term>Don't care</term>
          <internal> = -1</internal>
        </enumValue>
      </enumList>
    </enumParam>

    <!--Not needed for the querying the genes based on old  annotation

      <enumParam name="plasmo_snapshot_changed"
                 prompt="Updated since the July 15, 2008 re-annotation snapshot"
                 multiPick="false"
                 quote="false">
        <help>
           Choose whether to return genes that have been updated since the last re-annotation snapshot was provided in PlasmoDB. The actual annotation may not have changed if a gene has now been reviewd that had not been reviewed previously.
        </help>
        <enumList>
          <enumValue>
            <term>Yes</term>
            <internal>1</internal>
          </enumValue>
          <enumValue>
            <term>No</term>
            <internal>0</internal>
          </enumValue>
          <enumValue default="true">
            <term>Don't care</term>
            <internal>0,1</internal>
          </enumValue>
        </enumList>
      </enumParam>
-->
    <enumParam name="plasmo_annot_status"
               prompt="Status change from old (release 5.5) to new (release 6.0) annotation"
               multiPick="true"
               quote="true">
      <help>
        Choose which genes to return based on their change in status from old to new annotation.
      </help>
      <enumList>
        <enumValue default="true">
          <term>Changed</term>
          <internal>changed</internal>
        </enumValue>
        <enumValue>
          <term>New</term>
          <internal>new</internal>
        </enumValue>
        <!--all information pertaining to deleted genes(sequence,features,GO, EC etc.) has been phased out after the rel. 6 annotation became official.
    so this option is not carried forward.
          <enumValue>
            <term>Deleted</term>
            <internal>deleted</internal>
          </enumValue>
-->
        <enumValue>
          <term>Unchanged</term>
          <internal>unchanged</internal>
        </enumValue>

      </enumList>
    </enumParam>


    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!-- EC Number -->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

    <flatVocabParam name="ec_number_pattern"
                    queryRef="GeneVQ.EcNumberList"
                    prompt="EC Number or Term"
                    displayType="typeAhead">
      <help><![CDATA[Enzyme Commission numbers describe enzymes hierarchically by the class of reactions they catalyze.
            Begin typing an EC number or name to
            see a list of all possible EC categories that match what you have typed. Then choose an EC category from
            the list. Use '-' as a wildcard in place of numbers to denote partial EC Numbers. ]]></help>
      <suggest selectMode="none" />

    </flatVocabParam>

    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!-- EC Number Wildcard Parameter -->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

    <stringParam name="ec_wildcard"
                 prompt="EC Number wildcard search" number="false">
      <suggest default="N/A"/>
      <help>Asterisks can be used as wildcard characters in an EC Number (e.g. "1.*"). To find genes with any EC Number, you may use "*" or "any".</help>
    </stringParam>

      <flatVocabParam name="ec_source"
                     queryRef="GeneVQ.EcNumberSource"
                     prompt="Source of assignment"
                     multiPick="true"
                     quote="true">
        <help ><![CDATA[
	  @PROJECT_ID@ integrates EC numbers from several sources.  EC assignments
          from more than one source may be queried in a single search. Select any or all EC number sources.]]>
        </help>
	<suggest selectMode="all" />
      </flatVocabParam>

   <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
   <!-- 			ISM Type		       	     -->
   <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

   <flatVocabParam name="long_read_transcript_novelty"
                     queryRef="GeneVQ.TranscriptSource"
                     prompt="Transcript Novelty"
                     multiPick="true"
                     quote="true"
                     includeProjects="PlasmoDB,ToxoDB,UniDB">
        <help ><![CDATA[
	Novenlty of transcript as per Talon. Intergenic: Intergenic transcript that lack any overlaap with a known gene. NIC: Novel transcript in Collection,transcrips with known splice donors and acceptors but reveal new connecction. ISM: Incomplete Splice Match transcript, transcript that matches subsection of a know transcript model but has novel putative start and endpoint ; NNC: Novel transcript not in collection, Transcripts with at least one novel donor or aceptor (at least one novel exon boundary). Genomic transcripts are either partial transcripts with no overlaping splice junction or from DNA. Known transcripts matches existing model. Antisense transcripts overlap an existing gene but in oriented in the opposite direction
          ]]>
        </help>
        <suggest selectMode="all" />
      </flatVocabParam>

   <flatVocabParam name="long_read_datasets"
                     queryRef="GeneVQ.DatasetSource"
                     prompt="Long Read datasets"
                     multiPick="false"
                     quote="false"
                     visible="true"
                     includeProjects="PlasmoDB,ToxoDB,UniDB">
        <help ><![CDATA[
        Select long read dataset(s) you wish to query against.
	 ]]>
        </help>
   </flatVocabParam>

   <flatVocabParam name="incomplete_splice_type"
                     queryRef="GeneVQ.mismatch_type"
                     prompt="Incomplete mismatch type"
                     multiPick="true"
                     quote="true"
                     includeProjects="PlasmoDB,ToxoDB,UniDB">
        <help ><![CDATA[
        Select a filter based on type of mismatch.
         ]]>
        </help>
        <suggest selectMode="all" />
   </flatVocabParam>

   <flatVocabParam name="ismTypes"
                     queryRef="GeneVQ.ism_types"
                     prompt="Long Read Transcript Novelty"
                     displayType="treeBox"
                     multiPick="true"
                     suppressNode="true"
                     quote="true"
                     includeProjects="PlasmoDB,ToxoDB,UniDB"
                     dependedParamRef="geneParams.long_read_datasets">

         <suggest selectMode="none"/>
          <help>
               Select transcript novelty type(s) you wish to query against. Click the [+] to expand the options.
          </help>

	<visibleHelp><![CDATA[
            Transcript Novelty describes how the TALON prediction differs from known gene models

          <dl>
            <dt>Genomic:</dt>
            <dd>Prediction has no overlapping splice junctions compared to known models</dd>

            <dt>Incomplete Splice Match (ISM):</dt>
            <dd>Prediction matches a subsection of a known gene model but has a novel putative start or end point. Further categorised into mismatches at the 5' end (prefix), 3' end (suffix) or both</dd>

            <dt>Known:</dt>
            <dd>Prediction exactly matches a known model</dd>

            <dt>Novel In Collection (NIC):</dt>
            <dd>Prediction uses known splice donors or acceptors but reveals new connections (e.g., skipped exon isoforms)</dd>

            <dt>Novel Not In Collection (NNC):</dt>
            <dd>Prediction  has at least one novel splice donor or acceptor</dd>
        </dl>
        ]]>
	</visibleHelp>

        </flatVocabParam>



   <flatVocabParam name="ismTypes_span"
                     queryRef="GeneVQ.ism_types_span"
                     prompt="Long Read Transcript Novelty"
                     displayType="treeBox"
                     multiPick="true"
                     suppressNode="true"
                     quote="true"
                     includeProjects="PlasmoDB,ToxoDB,UniDB">

         <suggest selectMode="none"/>
          <help>
               Select the transcript novelty type(s) you wish to query against. Click the [+] to expand the options.
          </help>

        <visibleHelp><![CDATA[
            Transcript Novelty describes how the TALON prediction differs from known gene models:

            <dl>
              <dt>Genomic:</dt>
              <dd>Prediction has no overlapping splice junctions compared to known models</dd>

              <dt>Intergenic:</dt>
              <dd>Prediction lacks any overlap with any known model</dd>

              <dt>Incomplete Splice Match (ISM):</dt>
              <dd>Prediction matches a subsection of a known gene model but has a novel putative start or end point. Further categorised into mismatches at the 5' end (prefix), 3' end (suffix) or both</dd>

              <dt>Known:</dt>
              <dd>Prediction exactly matches a known model</dd>

              <dt>Novel In Collection (NIC):</dt>
              <dd>Prediction uses known splice donors or acceptors but reveals new connections (e.g., skipped exon isoforms)</dd>

              <dt>Novel Not In Collection (NNC):</dt>
              <dd>Prediction  has at least one novel splice donor or acceptor</dd>

              <dt>Antisense:</dt>
              <dd>Prediction overlaps a known model, but is oriented in the opposite direction</dd>
            </dl>
        ]]>
        </visibleHelp>

        </flatVocabParam>



    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!--  -->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

    <enumParam name="scope" quote="false"
               prompt="Count exons per" >
      <help>
        Choose whether to search against the total number of exons per gene or the number of exons in each specific transcript.
      </help>
      <enumList>
        <enumValue  excludeProjects="TriTrypDB">
          <term>Gene</term>
          <internal>gene_exon_count</internal>
        </enumValue>
        <enumValue default="true">
          <term>Transcript</term>
          <internal>exon_count</internal>
        </enumValue>
      </enumList>
    </enumParam>

    <enumParam name="gene_or_transcript" quote="false"
               prompt="Genes or Transcripts" displayType="checkBox">
      <help>
        Choose gene to return all transcripts for each gene or transcript to return only those transcripts that match transcript specific attributes in the filter below.
      </help>
      <enumList>
        <enumValue default="true">
          <term>Genes</term>
          <internal>gene_source_id</internal>
        </enumValue>
        <enumValue>
          <term>Transcripts</term>
          <internal>source_id</internal>
        </enumValue>
      </enumList>
    </enumParam>

    <stringParam name="num_exons_gte"
                 prompt="Exon Count >="
                 number="true">
      <help><![CDATA[Exon count = exons/gene:<br><br> Enter the lower limit of exon number range that you wish to query.
            Genes returned by the search will have <b>at least</b> this many exons.]]> </help>
      <suggest default="2"/>
    </stringParam>

    <stringParam name="num_exons_lte"
                 prompt="Exon Count &lt;="
                 number="true">
      <help><![CDATA[Exon count = exons/gene:<br><br> Enter the upper limit of exon number range that you wish to query.
            Genes returned by this search will have <b>no more than</b> this number of exons.]]></help>
      <suggest default="20"/>
    </stringParam>


    <stringParam name="min_number_est_aligned"
                 prompt="Number of ESTs aligned &gt;="
                 number="true">
      <help>Enter the minimum number of ESTs that must align from the libraries selected to return a gene.</help>
      <suggest default="1"/>
    </stringParam>

    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!--  -->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

    <numberRangeParam name="num_paralogs"
                      prompt="Paralog Count:"
                      integer="true"
                      min="0"
                      max="1000000">
      <help>Set the upper and lower limits of the paralog number range that you wish to query. Genes returned by the search will have a paralog count within this range.</help>
      <suggest default="{'min':'1','max':'50'}"/>
    </numberRangeParam>
    <!--
        <stringParam name="num_paralogs_gte"
                     prompt="Paralog Count >="
                     number="true">
            <help><![CDATA[Paralog count = paralogs/gene:<br><br> Enter the lower limit of paralog number range that you wish to query.
            Genes returned by the search will have <b>at least</b> this many paralogs.]]> </help>
            <suggest default="1"/>
        </stringParam>

        <stringParam name="num_paralogs_lte"
                     prompt="Paralog Count &lt;="
                     number="true">
            <help><![CDATA[Paralog count = paralogs/gene:<br><br> Enter the upper limit of paralog number range that you wish to query.
            Genes returned by this search will have <b>no more than</b> this number of paralogs.]]></help>
            <suggest default="1000"/>
        </stringParam>
-->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!--  -->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

    <stringParam name="pf_gene_ids"
                 prompt="Gene IDs"
                 number="false">
      <help>Enter a list if Gene IDs</help>
      <suggest default="PF11_0300"/>
    </stringParam>


    <stringParam name="pf_gene_id"
                 prompt="Gene ID"
                 number="false">
      <help>Enter a Gene ID</help>
      <suggest default="PF11_0300"/>
    </stringParam>

    <enumParam name="sequence_id"
               prompt="Chromosome"
               multiPick="false"
               includeProjects="PlasmoDB,UniDB">
      <enumList>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>Pf3D7_01_v3</term>
          <internal>Pf3D7_01_v3</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>Pf3D7_02_v3</term>
          <internal>Pf3D7_02_v3</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>Pf3D7_03_v3</term>
          <internal>Pf3D7_03_v3</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>Pf3D7_04_v3</term>
          <internal>Pf3D7_04_v3</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>Pf3D7_05_v3</term>
          <internal>Pf3D7_05_v3</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>Pf3D7_06_v3</term>
          <internal>Pf3D7_06_v3</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>Pf3D7_07_v3</term>
          <internal>Pf3D7_07_v3</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>Pf3D7_08_v3</term>
          <internal>Pf3D7_08_v3</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>Pf3D7_09_v3</term>
          <internal>Pf3D7_09_v3</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>Pf3D7_10_v3</term>
          <internal>Pf3D7_10_v3</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>Pf3D7_11_v3</term>
          <internal>Pf3D7_11_v3</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>Pf3D7_12_v3</term>
          <internal>Pf3D7_12_v3</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>Pf3D7_13_v3</term>
          <internal>Pf3D7_13_v3</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>Pf3D7_14_v3</term>
          <internal>Pf3D7_14_v3</internal>
        </enumValue>
      </enumList>
    </enumParam>


    <stringParam name="lod_score"
                 prompt="LOD score greater than or equal to"
                 number="true">
      <help><![CDATA[Enter a cut-off value for LOD score.<br> Here is a list of corresponding P values for a range of LOD scores.<br><br>
<table>
<tr><td>LOD score</td><td>P value</td></tr>
<tr><td>0.5</td><td>0.1292</td></tr>
<tr><td>1</td><td>0.0319</td></tr>
<tr><td>1.5</td><td>0.0086</td></tr>
<tr><td>2</td><td>0.0024</td></tr>
<tr><td>2.5</td><td>6.91E-04</td></tr>
<tr><td>3</td><td>2.02E-04</td></tr>
<tr><td>3.5</td><td>5.95E-05</td></tr>
<tr><td>4</td><td>1.77E-05</td></tr>
<tr><td>4.5</td><td>5.31E-06</td></tr>
<tr><td>5</td><td>1.60E-06</td></tr>
<tr><td>5.5</td><td>4.84E-07</td></tr>
<tr><td>6</td><td>1.47E-07</td></tr>
<tr><td>6.5</td><td>4.47E-08</td></tr>
<tr><td>7</td><td>1.37E-08</td></tr>
<tr><td>7.5</td><td>4.18E-09</td></tr>
<tr><td>8</td><td>1.28E-09</td></tr></table>]]> </help>
      <suggest default="1.5"/>
    </stringParam>


    <stringParam name="p_value"
                 prompt="P value less than or equal to"
                 number="true">
      <help>The p value cutoff for this search.</help>
      <suggest default="1E-10"/>
    </stringParam>

        <stringParam name="dcc_p_value"
                     prompt="P value less than or equal to"
                     number="true">
            <help>The p value cutoff for this search.</help>
            <suggest default="0.05"/>
        </stringParam>

    <stringParam name="adj_p_value"
                 prompt="adjusted P value less than or equal to"
                 number="true">
      <help>The adjusted p value cutoff for this search. The Benjamini-Hochberg adjusted p value for the gene indicates the accepted False discovery rate. for example if 10% false positives are acceptable, all genes with an adjusted p value below 10% = 0.1 are considered significant.
      </help>
      <suggest default="0.1"/>
    </stringParam>


    <stringParam name="confidence"
                 prompt="Confidence >= "
                 number="true">
      <help>PaGE reports 1 - False Discovery Rate (FDR), which is called the "confidence" for the predictions.  The FDR of a set of predictions is the expected percent of false predictions in the set of predictions. For example if the algorithm returns 100 genes with a false discovery rate of .3 (confidence=0.7) then we should expect 70 of them to be correct.
      </help>
      <suggest default="0.8"/>
    </stringParam>


    <stringParam name="e_value_confidence"
                 prompt="Confidence >= "
                 number="true">
      <help>Confidence.
      </help>
      <suggest default="3.0 E-15"/>
    </stringParam>


    <stringParam name="false_discovery_rate"
                 prompt="False Discovery Rate &lt;= "
                 number="true">
      <help>The FDR of a set of predictions is the expected percent of false predictions. For example, if the algorithm returns 100 genes with a false discovery rate of .3, then 70 of them are expected to be correct.
      </help>
      <suggest default="0.8"/>
    </stringParam>

    <stringParam name="fold_change_cov"
                 prompt="fold difference"
                 number="true">
      <help>Enter a non-negative number.  NOTE:  fold difference is reported in the summary as positive numbers for genes with greater coverage in the comparison than reference sample and negative numbers for genes with lesser coverage in the comparison than the reference sample</help>
      <suggest default="2"/>
    <regex>(0\.\d+)||[0-9]+(\.\d+)?</regex>
        </stringParam>


    <stringParam name="fold_change"
                 prompt="fold difference >="
                 number="true">
      <help>Enter a non-negative number.  NOTE:  fold difference is reported in the summary as positive numbers for up-regulated genes and negative numbers for down-regulated genes</help>
      <suggest default="2"/>
    <regex>(0\.\d+)||[0-9]+(\.\d+)?</regex>
        </stringParam>

    <stringParam name="fold_difference"
                 prompt="Fold difference >="
                 number="true">
      <help>Enter a non-negative number.  NOTE:  Fold difference is reported in the summary as positive numbers for up-regulated genes and negative numbers for down-regulated genes</help>
      <suggest default="2"/>
    <regex>(0\.\d+)||[0-9]+(\.\d+)?</regex>
        </stringParam>

    <flatVocabParam name="hard_floor"
                    prompt="Floor ="
                    multiPick="false"
                    quote="false"
                    queryRef="GeneVQ.hardFloor"
                    dependedParamRef="geneParams.profileset_generic"
                    visible="false">
      <help><![CDATA[Choose the minimum number of reads per gene for the floor. The number of reads that map to a gene is used to calculate a gene's TPM. In this search, a gene's change in expression value between two samples is represented as fold change (FC) such that FC = TPM(comparison) divided by TPM(reference). Misleading FC values can result when one of those TPM values is close to zero. To avoid misleading FC values, we raise very low TPM values to a default TPM floor which represents 10 mapped reads for the gene. The TPM value for the default floor is determined by two factors: (1) the amount of sequencing for the particular dataset, and (2) the transcript size of the gene. The floor can be adjusted with the pull-down menu. Choosing a floor value greater than default effectively increases the expression threshold and may reduce the number of genes returned by the search. If you choose multiple samples for either reference or comparison, we apply your chosen floor after calculating the average, min, max or median of the sample expression values. In some cases (e.g., scaled data), a default floor cannot be calculated and thus is set to 1 TPM.]]></help>
    </flatVocabParam>

    <flatVocabParam name="antisense_floor"
                    prompt="To calculate fold-changes, use a floor of: "
                    multiPick="false"
                    quote="false"
                    queryRef="GeneVQ.antisenseFloor"
                    dependedParamRef="geneParams.samples_comp_antisense"
                    visible="true">
      <help><![CDATA[Choose the minimum number of reads per gene for the floor. The number of reads that map to a gene is used to calculate a gene's TPM. In this search, a gene's change in expression value between two samples is represented as fold change (FC) such that FC = TPM(comparison) divided by TPM(reference). Misleading FC values can result when one of those TPM values is close to zero. To avoid misleading FC values, we raise very low TPM values to a default TPM floor which represents 10 mapped reads for the gene. The TPM value for the default floor is determined by two factors: (1) the amount of sequencing for the particular dataset, and (2) the average transcript size for the organism. The floor can be adjusted with the pull-down menu. Choosing a floor value greater than default effectively increases the expression threshold and may reduce the number of genes returned by the search. If you choose multiple samples for either reference or comparison, we apply your chosen floor after calculating the average, min, max or median of the sample expression values. In some cases (e.g., scaled data), a default floor cannot be calculated and thus is set to 1 TPM.]]></help>
    </flatVocabParam>

    <stringParam name="fraction_change_antisense"
                 prompt="Change in antisense fraction >= "
                 number="true">
      <help>The fraction of total transcripts that are antisense must change (up or down) by at least this amount. Enter a number between 0 and 1. Larger fractions will select for genes with a large fraction of antisense in one sample and small fraction of antisense in the other sample.</help>
      <suggest default="0.5"/>
    </stringParam>


    <flatVocabParam name="samples_ref_antisense"
                    queryRef="GeneVQ.AntisenseSamples"
                    prompt="between expression in any of the following Reference Samples:"
                    quote="false"
                    displayType="checkBox"
                    multiPick="true">
      <help>Choose one or more samples. Each of the chosen Comparison samples will be compared to each of the Reference samples. To identify genes that meet the fold-change criteria relative to any of the Reference samples, choose all Reference samples.</help>
      <suggest selectMode="all" />
    </flatVocabParam>

    <flatVocabParam name="samples_comp_antisense"
                    queryRef="GeneVQ.AntisenseSamples"
                    prompt="and expression in any of the following Comparison Samples:"
                    quote="false"
                    displayType="checkBox"
                    multiPick="true">
      <help>Choose one or more samples. Each of these chosen Comparison samples will be compared to each of the chosen Reference Samples. To identify genes that meet the fold-change criteria in only one sample, select that sample. To identify genes that meet the fold-change criteria in any sample, select all of the samples.</help>
      <suggest selectMode="all" />
    </flatVocabParam>

    <flatVocabParam name="sense_direction"
                    queryRef="GeneVQ.SenseDirection"
                    prompt="while the same gene's sense transcripts "
                    multiPick="false"
                    visible="true"
                    quote="false">
      <help>Select whether the number of sense transcripts should increase or decrease in the Comparison Sample relative to the Reference Sample.</help>
      <suggest default="decrease"/>
    </flatVocabParam>

    <flatVocabParam name="antisense_direction"
                    queryRef="GeneVQ.AntisenseDirection"
                    prompt="Find genes whose antisense transcripts "
                    multiPick="false"
                    visible="true"
                    quote="false">
      <help>Select whether the number of antisense transcripts should increase or decrease in the Comparison Sample relative to the Reference Sample.</help>
      <suggest default="increase"/>
    </flatVocabParam>

    <stringParam name="sense_fold_change"
                 prompt="with a fold change >="
                 number="true">
      <help>Enter a non-negative number.  The fold change is the fold increase/decrease (as selected above) when going from the Reference Sample to the Comparison sample.</help>
      <suggest default="2"/>
    <regex>(0\.\d+)||[0-9]+(\.\d+)?</regex>
        </stringParam>

    <stringParam name="antisense_fold_change"
                 prompt="with a fold change >="
                 number="true">
      <help>Enter a non-negative number. The fold change is the fold increase/decrease (as selected above) when going from the Reference Sample to the Comparison sample.</help>
      <suggest default="2"/>
    <regex>(0\.\d+)||[0-9]+(\.\d+)?</regex>
        </stringParam>

    <stringParam name="minimum_percentile_value"
                 prompt="Percentile threshold >="
                 number="true">
      <help>Enter a number for the minimum percentile value that  the selected samples must meet in order to be included in the fold difference calculation.  Note: this value is the minimum of the reference if down-regulated or the comparator if up-regulated.   </help>
      <suggest default="50"/>
    </stringParam>

    <stringParam name="correlation"
                 prompt="Correlation >="
                 number="true">
      <help>Enter a non-negative number.  NOTE:  Correlation is reported in the summary as positive numbers for positively correlated genes and negative numbers for negatively correlated genes</help>
      <suggest default="0.75"/>
    </stringParam>

    <flatVocabParam name="regulated_dir_coverage"
                    prompt="Direction"
                    multiPick="false"
                    queryRef="GeneVQ.regulatedDirection">
      <help>
        For ConditionA vs. ConditionB, select  'increase in coverage' for genes where ConditionA > ConditionB and select 'decrease in coverage' for genes where ConditionB > ConditionA.
      </help>
    </flatVocabParam>


    <flatVocabParam name="regulated_dir"
                    prompt="Direction"
                    multiPick="false"
                    quote="false"
                    queryRef="GeneVQ.regulatedDirection">
      <help><![CDATA[
            <ul>
<li>- Select 'up-regulated' to find genes that have higher expression
in the comparator as compared to the reference.</li><br>
<li>- Select 'down-regulated' to find genes that have lower expression
in the comparator as compared to the reference.</li><br>
<li>- Select 'up or down regulated' to find genes that have higher or
lower expression in the comparator as compared to the reference.</li>
</ul>
      ]]></help>
      <suggest default="up or down regulated"/>
    </flatVocabParam>

    <flatVocabParam name="regulated_dir_immune_response"
                    prompt="Direction"
                    multiPick="false"
                    quote="false"
                    queryRef="GeneVQ.regulatedDirectionImmune">

      <help><![CDATA[
            <ul>
<li>- Select 'increased immunogenicity' to find genes that have higher expression
in the comparator as compared to the reference.</li><br>
<li>- Select 'decreased immunogenicity' to find genes that have lower expression
in the comparator as compared to the reference.</li><br>
<li>- Select 'increased or decreased immunogenicity' to find genes that have higher or
lower expression in the comparator as compared to the reference.</li>
</ul>
      ]]></help>
      <suggest default="increased immunogenicity"/>
    </flatVocabParam>


    <enumParam name="regulated_dir_up_down_only"
               prompt="Direction"
               multiPick="false">

      <help>
        <![CDATA[
            Select up-regulated for genes where Reference < Comparison and select down-regulated for genes where Reference > Comparison. Note that when selecting up-regulated, the minimum value of samples selected in Reference will be used and reported and the maximum value of samples in Comparison.  The opposite is true if down-regulated is selected.
          ]]>
      </help>
      <enumList>
        <enumValue>
          <term>up-regulated</term>
          <internal>+</internal>
        </enumValue>
        <enumValue>
          <term>down-regulated</term>
          <internal>-</internal>
        </enumValue>
      </enumList>
    </enumParam>

    <enumParam name="group_operator"
               prompt="Operation when selecting multiple samples"
               multiPick="false">

      <help>
        <![CDATA[
Choose the operation to use if you select multiple samples.   Choosing minimum / maximum if doing up-regulated will use the minimum of the Reference and the maximum of the Comparison to calculate fold difference (opposite for down-regulated).  Choosing average will use the average of the samples selected in each group to calculate the fold difference.
          ]]>
      </help>
      <enumList>
        <enumValue>
          <term>minimum / maximum</term>
          <internal>minmax</internal>
        </enumValue>
        <enumValue>
          <term>average</term>
          <internal>average</internal>
        </enumValue>
      </enumList>
    </enumParam>


    <enumParam name="fold_change_operator"
               prompt="Operation Applied to Fold Difference"
               multiPick="false">

      <help>
        <![CDATA[Choose the operation (min/max/average) to be applied when genes have multiple fold difference values (due to comparison with different samples/time points). This parameter only makes a difference if more than one sample/time point is chosen.
          ]]>
      </help>
      <enumList>
        <enumValue>
          <term>minimum</term>
          <internal>minimum</internal>
        </enumValue>
        <enumValue>
          <term>maximum</term>
          <internal>maximum</internal>
        </enumValue>
        <enumValue>
          <term>average</term>
          <internal>average</internal>
        </enumValue>
      </enumList>
    </enumParam>


    <flatVocabParam name="min_max_avg_comp"
                    queryRef="GeneVQ.MinMaxAvgComp"
                    prompt="Operation Applied to Comparison Samples"
                    dependedParamRef="geneParams.regulated_dir">
      <help>
        <![CDATA[
Choose the operation (min/max/average) to be applied to the chosen sample(s).  This parameter only makes a difference if more than one sample/time point is chosen.
          ]]>
      </help>
    </flatVocabParam>



    <flatVocabParam name="min_max_avg_ref"
                    queryRef="GeneVQ.MinMaxAvgRef"
                    prompt="Operation Applied to Reference Samples"
                    dependedParamRef="geneParams.regulated_dir">
      <help>
        <![CDATA[
Choose the operation (min/max/average) to be applied to the chosen sample(s).  This parameter only makes a difference if more than one sample/time point is chosen.
          ]]>
      </help>
    </flatVocabParam>

    <flatVocabParam name="operation_no_dependency_comp"
                    queryRef="GeneVQ.MinMaxAvgMed"
                    prompt="Operation Applied to Comparison Samples"
                    visible="false">
      <help>
        <![CDATA[
Choose the operation (min/max/average/med) to be applied to the chosen sample(s).  This parameter only makes a difference if more than one sample/time point is chosen. Average is selected by default
          ]]>
      </help>
      <suggest default="average"/>
    </flatVocabParam>


    <flatVocabParam name="operation_no_dependency_ref"
                    queryRef="GeneVQ.MinMaxAvgMed"
                    prompt="Operation Applied to Reference Samples"
                    visible="false">
      <help>
        <![CDATA[
Choose the operation (min/max/average/med) to be applied to the chosen sample(s).  This parameter only makes a difference if more than one sample/time point is chosen. Average is selected by default
          ]]>
      </help>
      <suggest default="average"/>
    </flatVocabParam>

    <enumParam name="apply_scaling"
               prompt="Apply RNA / nuclei number scaling"
               multiPick="false"
               quote="false">

      <help>
        <![CDATA[
Choose whether to apply the scaling factor for the amount of RNA isolated and number of nuclei described below.
          ]]>
      </help>
      <enumList>
        <enumValue>
          <term>No</term>
          <internal>1</internal>
        </enumValue>
        <enumValue>
          <term>Yes</term>
          <internal>sc.scaling</internal>
        </enumValue>
      </enumList>
    </enumParam>

    <enumParam name="global_min_max"
               prompt="Global min / max in selected time points"
               quote="true"
               multiPick="false">

      <help>
        <![CDATA[
Is the minimum and/or maximum expression value across the entire experiment contained in the chosen samples?
          ]]>
      </help>
      <enumList>
        <enumValue default="true">
          <term>Don't care</term>
          <internal>dont_care</internal>
        </enumValue>
        <enumValue>
          <term>Minimum</term>
          <internal>min</internal>
        </enumValue>
        <enumValue>
          <term>Maximum</term>
          <internal>max</internal>
        </enumValue>
        <enumValue>
          <term>Both minimum and maximum</term>
          <internal>both</internal>
        </enumValue>
      </enumList>
    </enumParam>

    <enumParam name="correlation_dir"
               prompt="Direction"
               multiPick="false">

      <help>
        There are two types or directions of correlation (two patterns that correlations can follow).
      </help>
      <enumList>
        <enumValue>
          <term>positive</term>
          <internal>+</internal>
        </enumValue>
        <enumValue>
          <term>negative</term>
          <internal>-</internal>
        </enumValue>
      </enumList>
    </enumParam>


    <enumParam name="expressionPercentileSamples"
               prompt="Sample Group"
               multiPick="true"
               quote="true"
               displayType="checkBox"
               includeProjects="GiardiaDB,UniDB">

      <help>
        The percentile was calculated on the mean of each sample group over all the spots on the array.
      </help>
      <enumList>
        <enumValue>
          <display><![CDATA[Control<sup>1</sup>]]></display>
          <term>Stress Response percentiles by temperature or varying DTT concentrations-red values|Control</term>
          <internal>Stress Response percentiles by temperature or varying DTT concentrations-red values|Control</internal>
        </enumValue>
        <enumValue>
          <display><![CDATA[30min 7.1mM DTT<sup>1</sup>]]></display>
          <term>Stress Response percentiles by temperature or varying DTT concentrations-red values|7.1mM DTT</term>
          <internal>Stress Response percentiles by temperature or varying DTT concentrations-red values|7.1mM DTT</internal>
        </enumValue>
        <enumValue>
          <display><![CDATA[30min 14.2mM DTT<sup>1</sup>]]></display>
          <term>Stress Response percentiles by temperature or varying DTT concentrations-red values|14.2mM DTT</term>
          <internal>Stress Response percentiles by temperature or varying DTT concentrations-red values|14.2mM DTT</internal>
        </enumValue>
        <enumValue>
          <display><![CDATA[30min 21.3mM DTT<sup>1</sup>]]></display>
          <term>Stress Response percentiles by temperature or varying DTT concentrations-red values|21.3mM DTT</term>
          <internal>Stress Response percentiles by temperature or varying DTT concentrations-red values|21.3mM DTT</internal>
        </enumValue>
        <enumValue>
          <display><![CDATA[30min 40C<sup>1</sup>]]></display>
          <term>Stress Response percentiles by temperature or varying DTT concentrations-red values|40 C</term>
          <internal>Stress Response percentiles by temperature or varying DTT concentrations-red values|40 C</internal>
        </enumValue>

        <enumValue>
          <display><![CDATA[Control<sup>2</sup>]]></display>
          <term>Stress Response percentiles by varying DTT incubation time-red values|Control</term>
          <internal>Stress Response percentiles by varying DTT incubation time-red values|Control</internal>
        </enumValue>
        <enumValue>
          <display><![CDATA[30min 14.2mM DTT<sup>2</sup>]]></display>
          <term>Stress Response percentiles by varying DTT incubation time-red values|30min 14.2mM DTT</term>
          <internal>Stress Response percentiles by varying DTT incubation time-red values|30min 14.2mM DTT</internal>
        </enumValue>
        <enumValue>
          <display><![CDATA[60min 14.2mM DTT<sup>2</sup>]]></display>
          <term>Stress Response percentiles by varying DTT incubation time-red values|60min 14.2mM DTT</term>
          <internal>Stress Response percentiles by varying DTT incubation time-red values|60min 14.2mM DTT</internal>
        </enumValue>
        <enumValue>
          <display><![CDATA[120min 14.2mM DTT<sup>2</sup>]]></display>
          <term>Stress Response percentiles by varying DTT incubation time-red values|120min 14.2mM DTT</term>
          <internal>Stress Response percentiles by varying DTT incubation time-red values|120min 14.2mM DTT</internal>
        </enumValue>
      </enumList>
    </enumParam>


    <enumParam name="expressionPercentileSamplesTwo"
               prompt="Sample Group"
               multiPick="true"
               quote="true"
               displayType="checkBox"
               includeProjects="GiardiaDB,UniDB">

      <help>
        The percentile was calculated on the mean of each sample group over all the spots on the array.
      </help>
      <enumList>
        <enumValue>
          <display><![CDATA[Control]]></display>
          <term>Hehl encystation expression percentile-red|Control</term>
          <internal>Hehl encystation expression percentile-red|Control</internal>
        </enumValue>
        <enumValue>
          <display><![CDATA[45 minute]]></display>
          <term>Hehl encystation expression percentile-red|45 minute</term>
          <internal>Hehl encystation expression percentile-red|45 minute</internal>
        </enumValue>
        <enumValue>
          <display><![CDATA[3 hour]]></display>
          <term>Hehl encystation expression percentile-red|3 hour</term>
          <internal>Hehl encystation expression percentile-red|3 hour</internal>
        </enumValue>
        <enumValue default="true">
          <display><![CDATA[7 hour]]></display>
          <term>Hehl encystation expression percentile-red|7 hour</term>
          <internal>Hehl encystation expression percentile-red|7 hour</internal>
        </enumValue>
        <enumValue>
          <display><![CDATA[7 hour lipid starvation]]></display>
          <term>Hehl encystation expression percentile-red|7 hour LS</term>
          <internal>Hehl encystation expression percentile-red|7 hour LS</internal>
        </enumValue>
      </enumList>
    </enumParam>



    <stringParam name="percentile"
                 prompt="Percentile >="
                 number="true">
      <help>
        Expression percentile reflects the expression level of one gene compared to other genes from the same array for one time point.  Genes are returned if ANY time point in the series has a percentile above the chosen value.
      </help>
      <suggest default="90"/>
    </stringParam>

    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!-- Transmembrane parameters -->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

    <stringParam name="min_tm"
                 prompt="Minimum Number of Transmembrane Domains"
                 number="true">
      <help><![CDATA[ Enter the lower limit of the TM range that you wish to query.
            The protein products of genes returned by this search are predicted to have <b>at least</b> this number of transmembrane domains.]]></help>
      <suggest default="1"/>
    </stringParam>

    <stringParam name="max_tm"
                 prompt="Maximum Number of Transmembrane Domains"
                 number="true">
      <help><![CDATA[Enter the upper limit of the TM range that you wish to query.
            The protein products of genes returned by this search are predicted to have <b>no greater than</b> this number of transmembrane domains.]]></help>
      <suggest default="99"/>
    </stringParam>

    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!--  -->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

    <enumParam name="isSyntenic"
               prompt="Syntenic Orthologs Only?"
               multiPick="false"
               quote="true">

      <help>Only Return Orthologs which also are syntenic</help>
      <enumList>
        <enumValue>
          <term>yes</term>
          <internal>yes</internal>
        </enumValue>
        <enumValue default="true">
          <term>no</term>
          <internal>no</internal>
        </enumValue>
      </enumList>
    </enumParam>


    <stringParam name="extDbName"
                 prompt="External Database Name" number="false">
      <help>The name of an external database as found in GUS</help>
    </stringParam>

    <stringParam name="extDbRlsVer"
                 prompt="External Database Release Version" number="false">
      <help>The version of an external database release as found in GUS</help>
    </stringParam>


    <!--  -->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!--
    <enumParam name="whole_words" excludeProjects="CryptoDB,TriTrypDB,ToxoDB,GiardiaDB,PlasmoDB"
                     prompt="Match only whole words?"
                     multiPick="false">
      <noTranslation value="false"  />
      <help>
             Select whether to reject text matches that start or end in the middle of a word
      </help>
      <enumList>
        <enumValue>
          <term>yes</term>
          <internal>true</internal>
        </enumValue>
        <enumValue default="true">
          <term>no</term>
          <internal>false</internal>

        </enumValue>
      </enumList>
    </enumParam>

    <enumParam name="whole_words" includeProjects="CryptoDB,TriTrypDB,ToxoDB,GiardiaDB,PlasmoDB,UniDB" visible="false"
                     prompt="Match only whole words?"
                     multiPick="false">
      <noTranslation value="false"  />
      <help>
             Select whether to reject text matches that start or end in the middle of a word
      </help>
      <enumList>
        <enumValue>
          <term>yes</term>
          <internal>true</internal>
        </enumValue>
        <enumValue default="true">
          <term>no</term>
          <internal>false</internal>

        </enumValue>
      </enumList>
    </enumParam>
-->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!--  Gene Type Parameters-->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

    <flatVocabParam name="geneType"
                    queryRef="GeneVQ.GeneTypes"
                    prompt="Gene type"
                    multiPick="true"
                    quote="true">
      <suggest default="protein coding"/>
      <help excludeProjects="EuPathDB,UniDB,TrichDB">
        <![CDATA[ Select one or more gene types. Genes returned by this search will have gene
products of your selected type (or types).<br><br>]]>
      </help>
      <help includeProjects="TrichDB">
        <![CDATA[
Select one or more gene types. Genes returned by this search will have gene
products of your selected type (or types).<br><br>

The gene type called 'Repeat region' refers
to the most common 59 repeat families identified in the assembly. They constitute
~39 Mb of the genome and can be classified as (1) virus-like; (2) transposon-like;
(3) retrotransposon-like; and (4) unclassified (no similarity to known proteins;
peptide motifs; or nucleotide sequences).   Most are present in hundreds of copies
(average ~660) and each family is extraordinarily homogenous; with a ~2.5% average
polymorphism. ]]>

      </help>

      <help includeProjects="UniDB">
        <![CDATA[Select one or more gene types. Genes returned by this search will have gene
products of your selected type (or types).<br><br>

<table><tr><th>Type</th><th>Valid for: </th></tr>
<tr><td nowrap>snRNA encoding</td><td>Amoeba. Giardia, Microsporidia, Plasmo, TriTryp</td></tr>
<tr><td nowrap>tRNA encoding</td><td>all</td></tr>
<tr><td nowrap>ncRNA</td><td>Amoeba. Microsporidia, TriTryp</td></tr>
<tr><td nowrap>rRNA encoding</td><td>all</td></tr>
<tr><td nowrap>snoRNA encoding</td><td nowrap>Crypto, Giardia, TriTryp</td></tr>
<tr><td nowrap>misc RNA</td><td nowrap>Crypto, Plasmo</td></tr>
<tr><td nowrap>SRP RNA encoding</td><td>Giardia</td></tr>
<tr><td nowrap>RNase P RNA</td><td>Giardia</td></tr>
<tr><td nowrap>RNase MRP RNA</td><td>Giardia</td></tr>
<tr><td nowrap>repeat region</td><td>Trich</td></tr>
<tr><td nowrap>scRNA encoding</td><td>TriTryp</td></tr>
</table>

          ]]>
      </help>


    </flatVocabParam>

    <enumParam name="includePseudogenes"
               prompt="Include Pseudogenes"
               multiPick="false"
               quote="false">

      <help><![CDATA[
             Choose whether to include pseudogenes in your query results.<br></br>
             Pseudogenes are dysfunctional genes that no longer encode protein or are no longer
             expressed, usually due to the accumulation of mutations.]]>
      </help>
      <enumList>
        <enumValue>
          <term>No</term>
          <internal>0</internal>
        </enumValue>
        <enumValue>
          <term>Yes</term>
          <internal>0,1</internal>
        </enumValue>
        <enumValue>
          <term>Pseudogenes Only</term>
          <internal>1</internal>
        </enumValue>
      </enumList>
    </enumParam>

    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!-- plasmodb 4.4 dataset -->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

    <stringParam name="plasmodb_4-4_dataset"
                 visible="false"
                 prompt="PlasmoDB 4.4 dataset"
                 number="true">
      <help>PlasmoDB 4.4 dataset</help>
    </stringParam>

    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!-- Go Term Parameter -->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

    <flatVocabParam name="go_typeahead"
                    queryRef="GeneVQ.GoTermList"
                    prompt="GO Term or GO ID"
                    multiPick="true"
                    displayType="typeAhead"
                    dependedParamRef="geneParams.go_term_slim">
      <suggest selectMode="none"/>
      <help><![CDATA[

            Use this parameter to indicate the GO Term (e.g. "catalytic activity") or GO ID (e.g. "GO:0003824") that you wish to query for. Genes returned by this search
            are annotated with the GO Term or ID you indicate here.</br></br>

            Begin typing a GO Term or ID to see a list of all possible categories that match what you have typed. Then choose
            a Term/ID from the list. You can choose more than onee using CTRL- or CMD-click when choosing the domains. Or paste
            a list of domain IDs separated by a comma, new line, white space or semicolon. Any unkown IDs will be marked as not found.<br><br>
            The numbers to the right of the term reflect the GO hierarchy level.  Your results will include genes annotated with any child term of the term chosen.
            ]]>
      </help>
      <!--
            <help>Enter a GO ID (e.g. "GO:0003824") or GO Term (e.g. "catalytic activity").  Asterisks can be used as wildcard characters in a GO Term (e.g. "*kinase*")</help>
            -->
    </flatVocabParam>

    <flatVocabParam name="go_typeahead_cl"
                    queryRef="GeneVQ.GoTermListCL"
                    prompt="GO Term or GO ID"
                    multiPick="true"
                    displayType="typeAhead">
      <suggest selectMode="none"/>
      <help><![CDATA[

            Use this parameter to indicate the GO Term (e.g. "catalytic activity") or GO ID (e.g. "GO:0003824") that you wish to query for. Genes returned by this search
            are annotated with the GO Term or ID you indicate here.</br></br>

            Begin typing a GO Term or ID to see a list of all possible categories that match what you have typed. Then choose
            a Term/ID from the list. You can choose more than onee using CTRL- or CMD-click when choosing the domains. Or paste
            a list of domain IDs separated by a comma, new line, white space or semicolon. Any unkown IDs will be marked as not found]]>
      </help>
      <!--
            <help>Enter a GO ID (e.g. "GO:0003824") or GO Term (e.g. "catalytic activity").  Asterisks can be used as wildcard characters in a GO Term (e.g. "*kinase*")</help>
            -->
    </flatVocabParam>



    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!-- Go Wildcard Parameter -->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

        <stringParam name="go_term"
                     prompt="GO Term wildcard search" number="false" length="1000"
                     sanityDefault="catalytic activity">
            <suggest default="N/A"/>
            <help><![CDATA[
                  Use this parameter to include a wildcard in your GO Term. Use an asterisk wildcard for ambiguous portions of the GO term, eg, *ase, kin*, *kinase*.  To find genes with any GO association, use "*".

            ]]>
      </help>
    </stringParam>

    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!-- other Go search Parameter -->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
    <enumParam name="go_term_evidence"
               prompt="Evidence"
               quote="true"
               displayType="checkBox"
               multiPick="true">

      <help>Choose the evidence of the GO annotation.</help>
      <enumList>
        <enumValue default="true">
          <term>Curated</term>
          <internal>Curated</internal>
        </enumValue>
        <enumValue default="true">
          <term>Computed</term>
          <internal>Computed</internal>
        </enumValue>
      </enumList>
    </enumParam>


    <enumParam name="go_term_slim"
               prompt="Limit to GO Slim terms"
               quote="true"
               displayType="checkBox"
               multiPick="false">

      <help>limit the search to GO Slim generic terms only.</help>
      <enumList>
        <enumValue>
          <term>Yes</term>
          <internal>Yes</internal>
        </enumValue>
        <enumValue default="true">
          <term>No</term>
          <internal>No</internal>
        </enumValue>
      </enumList>
    </enumParam>
    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!--  -->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

    <stringParam name="pfam_term"
                 prompt="Pfam Family ID or Description" number="false">
      <help>Enter a Pfam accession number (e.g. \"PF00478\") or definition (\"NPR nonapeptide repeat\") .  Asterisks can be used as wildcard characters in a Pfam definition (e.g. \"Ribosomal*\"</help>
      <suggest default="IMP dehydrogenase / GMP reductase domain"
      />
    </stringParam>

    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!-- Protein protein interaction -->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

    <enumParam name="bait_or_prey"
               prompt="Specified protein is bait or prey"
               multiPick="false">

      <help>
        Indicate whether the protein product of the Gene ID should be the bait (fused to the binding domain)
        or prey (fused to the activation domain) in the yeast two-hybrid experiment.
      </help>
      <enumList>
        <enumValue>
          <term>bait</term>
          <internal>bait</internal>
        </enumValue>
        <enumValue>
          <term>prey</term>
          <internal>prey</internal>
        </enumValue>
      </enumList>
    </enumParam>


    <stringParam name="min_glycosome_score"
                 prompt="Log2(H/L)"
                 number="true">
      <help></help>
      <suggest default="1.0"/>
    </stringParam>

    <enumParam name="glycosome_confidence"
               prompt="Confidence"
               multiPick="false" quote="false">

      <help>
      </help>
      <enumList>
        <enumValue>
          <term>[any]</term>
          <internal>0,1,2</internal>
        </enumValue>
        <enumValue default="true">
          <term>High</term>
          <internal>2</internal>
        </enumValue>
        <enumValue default="true">
          <term>Possible</term>
          <internal>1</internal>
        </enumValue>
        <enumValue>
          <term>Unlikely</term>
          <internal>0</internal>
        </enumValue>
      </enumList>
    </enumParam>


    <stringParam name="min_observed"
                 prompt="Restrict by the minimum number of times this interaction was found"
                 number="true">
      <help>Indicate the minimum number of times a given interaction was identified in all
        yeast two-hybrid screens before a gene is considered an interacting partner of the Gene ID. </help>
      <suggest default="1"/>
    </stringParam>

    <stringParam name="min_searches"
                 prompt="Restrict by the minimum number of Y2H screens that found this interaction"
                 number="true">
      <help>Indicate the minimum number of Y2H screens that identified this interaction before a gene is considered
        an interacting partner of the Gene ID. </help>
      <suggest default="1"/>
    </stringParam>

    <!-- Does not appear to belong to this query
        <stringParam name="max_results"
                     prompt="Maximum number of results">
            <help>Upper limit on the number of results returned by the query</help>
            <suggest default="5"/>
        </stringParam>
-->

    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!-- BLAST -->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

    <!-- currently using the param defined in sharedParams.xml  Jan 28, 2008 -->
    <enumParam name="BlastDatabaseType"
               prompt="Target Data Type"
               multiPick="false">

      <help>
        The type of the target database (eg CDS, Transcripts, Proteins)
      </help>
      <enumList>
        <enumValue>
          <term>Proteins</term>
          <internal>Proteins</internal>
        </enumValue>
        <enumValue>
          <term>Transcripts</term>
          <internal>Transcripts</internal>
        </enumValue>
        <!--        <enumValue>
          <term>Translated Transcripts</term>
          <internal>Transcripts Translated</internal>
        </enumValue> -->
      </enumList>
    </enumParam>


    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!-- Params for iedb peptide matches -->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

    <!-- peptide and protein mismatch -->



    <enumParam name="peptide_mismatch"
               prompt="Include Non Exact Peptide Matches?"
               multiPick="false" quote="false">

      <help>
      Choose whether to allow a 1 amino acid mismatch in the peptide to protein alignment.  To restrict the search to exact peptide matches, select "No"
      </help>
      <enumList>
        <enumValue>
          <term>Yes</term>
          <internal>1</internal>
        </enumValue>
        <enumValue>
          <term>No</term>
          <internal>0</internal>
        </enumValue>
      </enumList>
      </enumParam>

    <enumParam name="taxon_match"
               prompt="Include Matches from other Species?"
               multiPick="false" quote="false">

      <help>
      Choose whether to return genes where the species for the protein containing the IEDB epitope is not the same as for the target protein. To restrict the search to epitopes from the target species or taxa, select "No"
      </help>
      <enumList>
        <enumValue>
          <term>Yes</term>
          <internal>1</internal>
        </enumValue>
        <enumValue>
          <term>No</term>
          <internal>0</internal>
        </enumValue>
      </enumList>
   </enumParam>

   <enumParam name="protein_match"
               prompt="Include Non Exact Full Protein Matches?"
               multiPick="false" quote="false">

      <help>
      Choose whether to return genes where the protein containing the IEDB epitope is not an exact match for the target protein.   Mismatches may be outside of the epitope regions. To restrict the search to exact protein matches, select "No"
      </help>
      <enumList>
        <enumValue>
          <term>Yes</term>
          <internal>1</internal>
        </enumValue>
        <enumValue>
          <term>No</term>
          <internal>0</internal>
        </enumValue>
      </enumList>
  </enumParam>
    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!--  -->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

    <stringParam name="dn_ds_ratio_upper"
                 prompt="Non-synonymous / synonymous SNP ratio &lt;= "
                 number="true">
      <help>Upper Bound on the ratio of non-synonymous to synonymous coding snps.  NOTE:  Leaving this parameter value empty means you don't care what the upper bound is.</help>
      <suggest allowEmpty="true" emptyValue="-1"/>
    </stringParam>

    <stringParam name="dn_ds_ratio_lower"
                 prompt="Non-synonymous / synonymous SNP ratio >= "
                 number="true">
      <help>Lower Bound on the ratio of non-synonymous to synonymous coding snps</help>
      <suggest default="0"/>
    </stringParam>


    <stringParam name="min_num_coding_snps"
                 prompt="Number of coding SNPs >= "
                 number="true">
      <help>Lower Bound on the number of coding snps</help>
      <suggest default="1"/>
    </stringParam>

    <stringParam name="occurrences_upper"
                 prompt="Number of SNPs of above class &lt;= "
                 number="true">
      <help>Upper Bound on the number of SNPs of the selected class.  NOTE:  Leaving this parameter value empty means you don't care what the upper bound is.</help>
      <suggest allowEmpty="true" emptyValue="-1"/>
    </stringParam>

    <stringParam name="occurrences_lower"
                 prompt="Number of SNPs of above class >= "
                 number="true">
      <help>Lower Bound on the number of SNPs of the selected class</help>
      <suggest default="0"/>
    </stringParam>

    <stringParam name="tajimaD_lower"
                 prompt="Tajimas D value "
                 number="true">
      <help>Lower Bound on Tajima's D value</help>
      <suggest default="-2"/>
    </stringParam>

    <stringParam name="tajimaD_upper"
                 prompt="Tajimas D value "
                 number="true">
      <help>Upper Bound on Tajima s D value</help>
      <suggest default="2"/>
    </stringParam>


    <stringParam name="snp_density_lower"
                 prompt="SNPs per KB (CDS) >= "
                 number="true">
      <help>Find genes containing a density of coding snps greater than this parameter. Density is expressed in number of snps / KB of coding sequence</help>
      <suggest default="0"/>
    </stringParam>

    <stringParam name="snp_density_upper"
                 prompt="SNPs per KB (CDS) &lt;= "
                 number="true">
      <help>Find genes containing a density of coding snps less than this parameter. Density is expressed in number of snps / KB of coding sequence.  NOTE:  Leaving this parameter value empty means you don't care what the upper bound is.</help>
      <suggest allowEmpty="true" emptyValue="-1"/>
    </stringParam>



    <enumParam name="include_reichenowi"
               prompt="Include P. reichenowi"
               multiPick="false">

      <help>
        Click yes to include P. reichenowi snps in this query.  P.r snps were generated by alignment of P. reichenowi sequence with the P falciparum 3D7 reference sequence.  Note, if you want to only query reichenowi, you must click 'None' in the P. falciparum strains select list.
      </help>
      <enumList>
        <enumValue>
          <term>No</term>
          <internal>foobar</internal>
        </enumValue>
        <enumValue>
          <term>Yes</term>
          <internal>Preich</internal>
        </enumValue>
      </enumList>
    </enumParam>

    <enumParam name="snp_stat"
               prompt="SNP Class"
               multiPick="false"
               quote="false">


      <help>
        Choose the class of SNP you want to query on ... choose minumum and maximum numbers below
      </help>
      <enumList>
        <enumValue>
          <term>All SNPs</term>
          <internal>total</internal>
        </enumValue>
        <enumValue>
          <term>Coding</term>
          <internal>non_synonymous + synonymous</internal>
        </enumValue>
        <enumValue>
          <term>Non-Coding</term>
          <internal>non_coding</internal>
        </enumValue>
        <enumValue>
          <term>Non-Synonymous</term>
          <internal>non_synonymous</internal>
        </enumValue>
        <enumValue>
          <term>Nonsense</term>
          <internal>stop</internal>
        </enumValue>
        <enumValue>
          <term>Synonymous</term>
          <internal>synonymous</internal>
        </enumValue>
      </enumList>
    </enumParam>

    <enumParam name="snp_class"
               prompt="SNP Class"
               multiPick="false"
               quote="false">


      <help>
        Choose the class of SNP you want to query on ... choose minumum and maximum numbers below
      </help>
      <enumList>
        <enumValue>
          <term>All SNPs</term>
          <internal>all</internal>
        </enumValue>
        <enumValue>
          <term>Coding</term>
          <internal>coding</internal>
        </enumValue>
        <enumValue>
          <term>Non-Coding</term>
          <internal>noncoding</internal>
        </enumValue>
        <enumValue>
          <term>Non-Synonymous</term>
          <internal>nonsynonymous</internal>
        </enumValue>
        <enumValue>
          <term>Nonsense</term>
          <internal>nonsense</internal>
        </enumValue>
        <enumValue>
          <term>Synonymous</term>
          <internal>synonymous</internal>
        </enumValue>
      </enumList>
    </enumParam>

    <enumParam name="snp_order"
               prompt="Sort by"
               multiPick="false">

      <help>
        Results will be sorted on this column in descending order
      </help>
      <enumList>
        <enumValue>
          <term>All SNPs</term>
          <internal>total</internal>
        </enumValue>
        <enumValue>
          <term>Non-Coding SNPs</term>
          <internal>non_coding</internal>
        </enumValue>
        <enumValue>
          <term>Non-Synonymous SNPs</term>
          <internal>non_synonymous</internal>
        </enumValue>
        <enumValue>
          <term>Non-synonymous / Synonymous ratio</term>
          <internal>dn_ds_ratio</internal>
        </enumValue>
        <enumValue>
          <term>Nonsense SNPs</term>
          <internal>stop</internal>
        </enumValue>
        <enumValue>
          <term>SNP density in CDS</term>
          <internal>cds_snp_density</internal>
        </enumValue>
        <enumValue>
          <term>Synonymous SNPs</term>
          <internal>synonymous</internal>
        </enumValue>
      </enumList>
    </enumParam>

    <enumParam name="sort_order"
               prompt="Sort direction"
               multiPick="false">

      <help>
        Results will be sorted ascending or descending order
      </help>
      <enumList>
        <enumValue>
          <term>Descending</term>
          <internal>DESC</internal>
        </enumValue>
        <enumValue>
          <term>Ascending</term>
          <internal>ASC</internal>
        </enumValue>
      </enumList>
    </enumParam>

    <enumParam name="profileSetFalc"
               prompt="Microarray time course(s) to query"
               multiPick="false"
               includeProjects="PlasmoDB,ToxoDB,UniDB">
      <help>
        Choose experiment(s) to query.  Note that all of the time courses will only return genes that match the search criteria in all experiments.
      </help>
      <enumList>
        <enumValue>
          <term>Dev. Series 3D7 (glass slide - DeRisi)</term>
          <internal>DeRisi 3D7 Smoothed</internal>
        </enumValue>
        <enumValue>
          <term>Dev. Series Dd2 (glass slide - DeRisi)</term>
          <internal>DeRisi Dd2 Smoothed</internal>
        </enumValue>
        <enumValue>
          <term>Dev. Series HB3 (glass slide - DeRisi)</term>
          <internal>DeRisi HB3 Smoothed</internal>
        </enumValue>
        <enumValue default="true">
          <term>Any of the time courses</term>
          <internal>DeRisi % Smoothed</internal>
        </enumValue>
        <enumValue>
          <term>All of the time courses</term>
          <internal>3</internal>
        </enumValue>
      </enumList>
    </enumParam>




    <!-- where is this param used?  -->
    <!--
    <enumParam name="require_replicates"
                     prompt="Require Both Replicates"
                     multiPick="false"
                     quote="false"
                     includeProjects="TriTrypDB,UniDB">
      <help>
             Require that both replicates match the search parameters
      </help>
      <enumList>
        <enumValue default="true">
          <term>No</term>
          <internal>1</internal>
        </enumValue>
        <enumValue>
          <term>Yes</term>
          <internal>2</internal>
        </enumValue>
      </enumList>
    </enumParam>
-->

    <enumParam name="minOrMax"
               prompt="Query based on"
               multiPick="false">

      <help>
        Find genes where the expression level is at its highest or lowest point in the time series.
      </help>
      <enumList>
        <enumValue default="true">
          <term>Timing of maximal expression</term>
          <internal>max</internal>
        </enumValue>
        <enumValue>
          <term>Timing of minimal expression</term>
          <internal>min</internal>
        </enumValue>
      </enumList>
    </enumParam>

    <enumParam name="exprHourRNASeq"
               prompt="Timing"
               multiPick="true"
               quote="false"
               includeProjects="PlasmoDB,UniDB">

      <help>
        Time point where expression level was minimal or maximal
      </help>
      <enumList>
        <enumValue default="true">
          <term>0 hours</term>
          <internal>0</internal>
        </enumValue>
        <enumValue>
          <term>8 hours</term>
          <internal>8</internal>
        </enumValue>
        <enumValue>
          <term>16 hours</term>
          <internal>16</internal>
        </enumValue>
        <enumValue>
          <term>24 hours</term>
          <internal>24</internal>
        </enumValue>
        <enumValue>
          <term>32 hours</term>
          <internal>32</internal>
        </enumValue>
        <enumValue>
          <term>40 hours</term>
          <internal>40</internal>
        </enumValue>
        <enumValue>
          <term>48 hours</term>
          <internal>48</internal>
        </enumValue>
      </enumList>
    </enumParam>

    <enumParam name="exprHourCellCycle"
               prompt="Timing"
               multiPick="true"
               quote="false"
               includeProjects="ToxoDB,UniDB">

      <help>
        Time point where expression level was minimal or maximal
      </help>
      <enumList>
        <enumValue default="true">
          <term>0 hours</term>
          <internal>0</internal>
        </enumValue>
        <enumValue>
          <term>1 hours</term>
          <internal>1</internal>
        </enumValue>
        <enumValue>
          <term>2 hours</term>
          <internal>2</internal>
        </enumValue>
        <enumValue>
          <term>3 hours</term>
          <internal>3</internal>
        </enumValue>
        <enumValue>
          <term>4 hours</term>
          <internal>4</internal>
        </enumValue>
        <enumValue>
          <term>5 hours</term>
          <internal>5</internal>
        </enumValue>
        <enumValue>
          <term>6 hours</term>
          <internal>6</internal>
        </enumValue>
        <enumValue>
          <term>7 hours</term>
          <internal>7</internal>
        </enumValue>
        <enumValue>
          <term>8 hours</term>
          <internal>8</internal>
        </enumValue>
        <enumValue>
          <term>9 hours</term>
          <internal>9</internal>
        </enumValue>
        <enumValue>
          <term>10 hours</term>
          <internal>10</internal>
        </enumValue>
        <enumValue>
          <term>11 hours</term>
          <internal>11</internal>
        </enumValue>
        <enumValue>
          <term>12 hours</term>
          <internal>12</internal>
        </enumValue>
      </enumList>
    </enumParam>


    <enumParam name="exprHourVivax"
               prompt="Timing"
               multiPick="true"
               quote="false"
               includeProjects="PlasmoDB,UniDB">

      <help>
        Time point where expression level was minimal or maximal
      </help>
      <enumList>
        <enumValue default="true">
          <term>9 hours</term>
          <internal>1</internal>
        </enumValue>
        <enumValue>
          <term>13 hours</term>
          <internal>2</internal>
        </enumValue>
        <enumValue>
          <term>17 hours</term>
          <internal>3</internal>
        </enumValue>
        <enumValue>
          <term>20 hours</term>
          <internal>4</internal>
        </enumValue>
        <enumValue>
          <term>23 hours</term>
          <internal>5</internal>
        </enumValue>
        <enumValue>
          <term>29 hours</term>
          <internal>6</internal>
        </enumValue>
        <enumValue>
          <term>35 hours</term>
          <internal>7</internal>
        </enumValue>
        <enumValue>
          <term>40 hours</term>
          <internal>8</internal>
        </enumValue>
        <enumValue>
          <term>43 hours</term>
          <internal>9</internal>
        </enumValue>
      </enumList>
    </enumParam>


    <!--
        <flatVocabParam name="ts_fc_one_matt" includeProjects="ToxoDB,UniDB"
                     queryRef="GeneVQ.TimeSeriesFoldChangeMatt"
                     prompt="Comparison Samples"
                     quote="false"
                     displayType="checkBox"
                     multiPick="true">
            <help>Choose one or more time point.  NOTE: if more than one is chosen the fold difference will be calculated using the average of all samples within the group</help>
            <suggest default="0 days"/>
        </flatVocabParam>

        <flatVocabParam name="ts_fc_two_matt" includeProjects="ToxoDB,UniDB"
                     queryRef="GeneVQ.TimeSeriesFoldChangeMatt"
                     prompt="Reference Samples"
                     quote="false"
                     displayType="checkBox"
                     multiPick="true">
            <help>Choose one or more time point.  NOTE: if more than one is chosen the fold difference will be calculated using the average of all samples within the group</help>
            <suggest default="2 days"/>
        </flatVocabParam>
-->


    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!-- Expression Percentiles Params ToxoDB -->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

    <enumParam name="maxExprHourFalc"
               prompt="Timing"
               multiPick="false"
               quote="false"
               includeProjects="PlasmoDB,UniDB">

      <help>
        Time point where expression level was minimal or maximal
      </help>
      <enumList>
        <enumValue>
          <term>1 hour</term>
          <internal>1</internal>
        </enumValue>
        <enumValue>
          <term>2 hours</term>
          <internal>2</internal>
        </enumValue>
        <enumValue>
          <term>3 hours</term>
          <internal>3</internal>
        </enumValue>
        <enumValue>
          <term>4 hours</term>
          <internal>4</internal>
        </enumValue>
        <enumValue>
          <term>5 hours</term>
          <internal>5</internal>
        </enumValue>
        <enumValue>
          <term>6 hours</term>
          <internal>6</internal>
        </enumValue>
        <enumValue>
          <term>7 hours</term>
          <internal>7</internal>
        </enumValue>
        <enumValue>
          <term>8 hours</term>
          <internal>8</internal>
        </enumValue>
        <enumValue>
          <term>9 hours</term>
          <internal>9</internal>
        </enumValue>
        <enumValue>
          <term>10 hours</term>
          <internal>10</internal>
        </enumValue>
        <enumValue>
          <term>11 hours</term>
          <internal>11</internal>
        </enumValue>
        <enumValue>
          <term>12 hours</term>
          <internal>12</internal>
        </enumValue>
        <enumValue>
          <term>13 hours</term>
          <internal>13</internal>
        </enumValue>
        <enumValue>
          <term>14 hours</term>
          <internal>14</internal>
        </enumValue>
        <enumValue>
          <term>15 hours</term>
          <internal>15</internal>
        </enumValue>
        <enumValue>
          <term>16 hours</term>
          <internal>16</internal>
        </enumValue>
        <enumValue>
          <term>17 hours</term>
          <internal>17</internal>
        </enumValue>
        <enumValue>
          <term>18 hours</term>
          <internal>18</internal>
        </enumValue>
        <enumValue>
          <term>19 hours</term>
          <internal>19</internal>
        </enumValue>
        <enumValue>
          <term>20 hours</term>
          <internal>20</internal>
        </enumValue>
        <enumValue>
          <term>21 hours</term>
          <internal>21</internal>
        </enumValue>
        <enumValue>
          <term>22 hours</term>
          <internal>22</internal>
        </enumValue>
        <enumValue>
          <term>23 hours</term>
          <internal>23</internal>
        </enumValue>
        <enumValue>
          <term>24 hours</term>
          <internal>24</internal>
        </enumValue>
        <enumValue>
          <term>25 hours</term>
          <internal>25</internal>
        </enumValue>
        <enumValue>
          <term>26 hours</term>
          <internal>26</internal>
        </enumValue>
        <enumValue>
          <term>27 hours</term>
          <internal>27</internal>
        </enumValue>
        <enumValue>
          <term>28 hours</term>
          <internal>28</internal>
        </enumValue>
        <enumValue>
          <term>29 hours</term>
          <internal>29</internal>
        </enumValue>
        <enumValue>
          <term>30 hours</term>
          <internal>30</internal>
        </enumValue>
        <enumValue>
          <term>31 hours</term>
          <internal>31</internal>
        </enumValue>
        <enumValue>
          <term>32 hours</term>
          <internal>32</internal>
        </enumValue>
        <enumValue>
          <term>33 hours</term>
          <internal>33</internal>
        </enumValue>
        <enumValue>
          <term>34 hours</term>
          <internal>34</internal>
        </enumValue>
        <enumValue>
          <term>35 hours</term>
          <internal>35</internal>
        </enumValue>
        <enumValue>
          <term>36 hours</term>
          <internal>36</internal>
        </enumValue>
        <enumValue>
          <term>37 hours</term>
          <internal>37</internal>
        </enumValue>
        <enumValue>
          <term>38 hours</term>
          <internal>38</internal>
        </enumValue>
        <enumValue>
          <term>39 hours</term>
          <internal>39</internal>
        </enumValue>
        <enumValue>
          <term>40 hours</term>
          <internal>40</internal>
        </enumValue>
        <enumValue>
          <term>41 hours</term>
          <internal>41</internal>
        </enumValue>
        <enumValue>
          <term>42 hours</term>
          <internal>42</internal>
        </enumValue>
        <enumValue>
          <term>43 hours</term>
          <internal>43</internal>
        </enumValue>
        <enumValue>
          <term>44 hours</term>
          <internal>44</internal>
        </enumValue>
        <enumValue>
          <term>45 hours</term>
          <internal>45</internal>
        </enumValue>
        <enumValue>
          <term>46 hours</term>
          <internal>46</internal>
        </enumValue>
        <enumValue>
          <term>47 hours</term>
          <internal>47</internal>
        </enumValue>
        <enumValue>
          <term>48 hours</term>
          <internal>48</internal>
        </enumValue>
      </enumList>
    </enumParam>



    <enumParam name="maxPlusMinusHours2"
               prompt="Expression time +/- "
               multiPick="false"
               quote="false">

      <help>
        Increase the window for examining the maximum expression time by choosing the number of hours to go in each direction (plus / minus)
      </help>
      <enumList>
        <enumValue>
          <term>1 hour</term>
          <internal>1</internal>
        </enumValue>
        <enumValue>
          <term>2 hours</term>
          <internal>2</internal>
        </enumValue>
        <enumValue>
          <term>3 hours</term>
          <internal>3</internal>
        </enumValue>
        <enumValue>
          <term>4 hours</term>
          <internal>4</internal>
        </enumValue>
        <enumValue>
          <term>5 hours</term>
          <internal>5</internal>
        </enumValue>
        <enumValue>
          <term>6 hours</term>
          <internal>6</internal>
        </enumValue>
        <enumValue>
          <term>7 hours</term>
          <internal>7</internal>
        </enumValue>
        <enumValue>
          <term>8 hours</term>
          <internal>8</internal>
        </enumValue>
        <enumValue>
          <term>9 hours</term>
          <internal>9</internal>
        </enumValue>
        <enumValue>
          <term>10 hours</term>
          <internal>10</internal>
        </enumValue>
        <enumValue>
          <term>11 hours</term>
          <internal>11</internal>
        </enumValue>
        <enumValue default="true">
          <term>12 hours</term>
          <internal>12</internal>
        </enumValue>
        <enumValue>
          <term>13 hours</term>
          <internal>13</internal>
        </enumValue>
        <enumValue>
          <term>14 hours</term>
          <internal>14</internal>
        </enumValue>
        <enumValue>
          <term>15 hours</term>
          <internal>15</internal>
        </enumValue>
        <enumValue>
          <term>16 hours</term>
          <internal>16</internal>
        </enumValue>
        <enumValue>
          <term>17 hours</term>
          <internal>17</internal>
        </enumValue>
        <enumValue>
          <term>18 hours</term>
          <internal>18</internal>
        </enumValue>
        <enumValue>
          <term>19 hours</term>
          <internal>19</internal>
        </enumValue>
        <enumValue>
          <term>20 hours</term>
          <internal>20</internal>
        </enumValue>
        <enumValue>
          <term>21 hours</term>
          <internal>21</internal>
        </enumValue>
        <enumValue>
          <term>22 hours</term>
          <internal>22</internal>
        </enumValue>
        <enumValue>
          <term>23 hours</term>
          <internal>23</internal>
        </enumValue>
        <enumValue>
          <term>24 hours</term>
          <internal>24</internal>
        </enumValue>
      </enumList>
    </enumParam>

    <enumParam name="maxPlusMinusHours"
               prompt="Expression time +/- "
               multiPick="false"
               quote="false">

      <help>
        Increase the window for examining the maximum expression time by choosing the number of hours to go in each direction (plus / minus)
      </help>
      <enumList>
        <enumValue>
          <term>1 hour</term>
          <internal>1</internal>
        </enumValue>
        <enumValue>
          <term>2 hours</term>
          <internal>2</internal>
        </enumValue>
        <enumValue>
          <term>3 hours</term>
          <internal>3</internal>
        </enumValue>
        <enumValue>
          <term>4 hours</term>
          <internal>4</internal>
        </enumValue>
        <enumValue>
          <term>5 hours</term>
          <internal>5</internal>
        </enumValue>
        <enumValue>
          <term>6 hours</term>
          <internal>6</internal>
        </enumValue>
        <enumValue>
          <term>7 hours</term>
          <internal>7</internal>
        </enumValue>
        <enumValue>
          <term>8 hours</term>
          <internal>8</internal>
        </enumValue>
        <enumValue>
          <term>9 hours</term>
          <internal>9</internal>
        </enumValue>
        <enumValue>
          <term>10 hours</term>
          <internal>10</internal>
        </enumValue>
        <enumValue>
          <term>11 hours</term>
          <internal>11</internal>
        </enumValue>
        <enumValue default="true">
          <term>12 hours</term>
          <internal>12</internal>
        </enumValue>
        <enumValue>
          <term>13 hours</term>
          <internal>13</internal>
        </enumValue>
        <enumValue>
          <term>14 hours</term>
          <internal>14</internal>
        </enumValue>
        <enumValue>
          <term>15 hours</term>
          <internal>15</internal>
        </enumValue>
        <enumValue>
          <term>16 hours</term>
          <internal>16</internal>
        </enumValue>
        <enumValue>
          <term>17 hours</term>
          <internal>17</internal>
        </enumValue>
        <enumValue>
          <term>18 hours</term>
          <internal>18</internal>
        </enumValue>
        <enumValue>
          <term>19 hours</term>
          <internal>19</internal>
        </enumValue>
        <enumValue>
          <term>20 hours</term>
          <internal>20</internal>
        </enumValue>
        <enumValue>
          <term>21 hours</term>
          <internal>21</internal>
        </enumValue>
        <enumValue>
          <term>22 hours</term>
          <internal>22</internal>
        </enumValue>
        <enumValue>
          <term>23 hours</term>
          <internal>23</internal>
        </enumValue>
        <enumValue>
          <term>24 hours</term>
          <internal>24</internal>
        </enumValue>
      </enumList>
    </enumParam>

    <enumParam name="minExprHour"
               prompt="Timing of minimum expression"
               multiPick="false"
               quote="false"
               includeProjects="PlasmoDB,TriTrypDB,UniDB">

      <help>
        Time point where expression level was minimal
      </help>
      <enumList>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>1 hour</term>
          <internal>1</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>2 hours</term>
          <internal>2</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>3 hours</term>
          <internal>3</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>4 hours</term>
          <internal>4</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>5 hours</term>
          <internal>5</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>6 hours</term>
          <internal>6</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>7 hours</term>
          <internal>7</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>8 hours</term>
          <internal>8</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>9 hours</term>
          <internal>9</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>10 hours</term>
          <internal>10</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>11 hours</term>
          <internal>11</internal>
        </enumValue>
        <enumValue default="true" includeProjects="PlasmoDB,UniDB">
          <term>12 hours</term>
          <internal>12</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>13 hours</term>
          <internal>13</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>14 hours</term>
          <internal>14</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>15 hours</term>
          <internal>15</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>16 hours</term>
          <internal>16</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>17 hours</term>
          <internal>17</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>18 hours</term>
          <internal>18</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>19 hours</term>
          <internal>19</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>20 hours</term>
          <internal>20</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>21 hours</term>
          <internal>21</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>22 hours</term>
          <internal>22</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>23 hours</term>
          <internal>23</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>24 hours</term>
          <internal>24</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>25 hours</term>
          <internal>25</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>26 hours</term>
          <internal>26</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>27 hours</term>
          <internal>27</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>28 hours</term>
          <internal>28</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>29 hours</term>
          <internal>29</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>30 hours</term>
          <internal>30</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>31 hours</term>
          <internal>31</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>32 hours</term>
          <internal>32</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>33 hours</term>
          <internal>33</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>34 hours</term>
          <internal>34</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>35 hours</term>
          <internal>35</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>36 hours</term>
          <internal>36</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>37 hours</term>
          <internal>37</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>38 hours</term>
          <internal>38</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>39 hours</term>
          <internal>39</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>40 hours</term>
          <internal>40</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>41 hours</term>
          <internal>41</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>42 hours</term>
          <internal>42</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>43 hours</term>
          <internal>43</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>44 hours</term>
          <internal>44</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>45 hours</term>
          <internal>45</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>46 hours</term>
          <internal>46</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>47 hours</term>
          <internal>47</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB">
          <term>48 hours</term>
          <internal>48</internal>
        </enumValue>
        <enumValue includeProjects="TriTrypDB,UniDB">
          <term>2.5 hours</term>
          <internal>2</internal>
        </enumValue>
        <enumValue includeProjects="TriTrypDB,UniDB">
          <term>5.0 hours</term>
          <internal>5</internal>
        </enumValue>
        <enumValue includeProjects="TriTrypDB,UniDB">
          <term>7.5 hours</term>
          <internal>7</internal>
        </enumValue>
        <enumValue includeProjects="TriTrypDB,UniDB">
          <term>10 hours</term>
          <internal>10</internal>
        </enumValue>
        <enumValue includeProjects="TriTrypDB,UniDB">
          <term>15 hours</term>
          <internal>15</internal>
        </enumValue>
        <enumValue includeProjects="TriTrypDB,UniDB">
          <term>24 hours</term>
          <internal>24</internal>
        </enumValue>
        <enumValue includeProjects="TriTrypDB,UniDB">
          <term>144 hours</term>
          <internal>144</internal>
        </enumValue>
      </enumList>
    </enumParam>

    <enumParam name="minPlusMinusHours"
               prompt="Minimum expression time +/- "
               multiPick="false"
               quote="false">

      <help>
        Increase the window for examining the minimum expression time by choosing the number of hours to go in each direction (plus / minus)
      </help>
      <enumList>
        <enumValue>
          <term>1 hour</term>
          <internal>1</internal>
        </enumValue>
        <enumValue>
          <term>2 hours</term>
          <internal>2</internal>
        </enumValue>
        <enumValue>
          <term>3 hours</term>
          <internal>3</internal>
        </enumValue>
        <enumValue>
          <term>4 hours</term>
          <internal>4</internal>
        </enumValue>
        <enumValue>
          <term>5 hours</term>
          <internal>5</internal>
        </enumValue>
        <enumValue>
          <term>6 hours</term>
          <internal>6</internal>
        </enumValue>
        <enumValue>
          <term>7 hours</term>
          <internal>7</internal>
        </enumValue>
        <enumValue>
          <term>8 hours</term>
          <internal>8</internal>
        </enumValue>
        <enumValue>
          <term>9 hours</term>
          <internal>9</internal>
        </enumValue>
        <enumValue>
          <term>10 hours</term>
          <internal>10</internal>
        </enumValue>
        <enumValue>
          <term>11 hours</term>
          <internal>11</internal>
        </enumValue>
        <enumValue default="true">
          <term>12 hours</term>
          <internal>12</internal>
        </enumValue>
        <enumValue>
          <term>13 hours</term>
          <internal>13</internal>
        </enumValue>
        <enumValue>
          <term>14 hours</term>
          <internal>14</internal>
        </enumValue>
        <enumValue>
          <term>15 hours</term>
          <internal>15</internal>
        </enumValue>
        <enumValue>
          <term>16 hours</term>
          <internal>16</internal>
        </enumValue>
        <enumValue>
          <term>17 hours</term>
          <internal>17</internal>
        </enumValue>
        <enumValue>
          <term>18 hours</term>
          <internal>18</internal>
        </enumValue>
        <enumValue>
          <term>19 hours</term>
          <internal>19</internal>
        </enumValue>
        <enumValue>
          <term>20 hours</term>
          <internal>20</internal>
        </enumValue>
        <enumValue>
          <term>21 hours</term>
          <internal>21</internal>
        </enumValue>
        <enumValue>
          <term>22 hours</term>
          <internal>22</internal>
        </enumValue>
        <enumValue>
          <term>23 hours</term>
          <internal>23</internal>
        </enumValue>
        <enumValue>
          <term>24 hours</term>
          <internal>24</internal>
        </enumValue>
      </enumList>
    </enumParam>

    <enumParam name="inductionFold"
               prompt="Max/Min Expression Ratio >= "
               multiPick="false"
               quote="false">

      <help>
        Expression induction ratio reflects the change between the highest and lowest expression level for each gene over the time course.
      </help>
      <enumList>
        <enumValue>
          <term>-- None --</term>
          <internal>0</internal>
        </enumValue>
        <enumValue>
          <term>2 fold induction</term>
          <internal>2</internal>
        </enumValue>
        <enumValue default="true">
          <term>4 fold induction</term>
          <internal>4</internal>
        </enumValue>
        <enumValue>
          <term>8 fold induction</term>
          <internal>8</internal>
        </enumValue>
        <enumValue>
          <term>16 fold induction</term>
          <internal>16</internal>
        </enumValue>
        <enumValue>
          <term>32 fold induction</term>
          <internal>32</internal>
        </enumValue>
      </enumList>
    </enumParam>

    <enumParam name="expressionPct"
               prompt="Maximum Expression percentile >= "
               multiPick="false"
               quote="false">

      <help>
        Expression percentile reflects the expression level of one gene compared to other genes from the same array for one time point.  Genes are returned if ANY time point in the series has a percentile above the chosen value.
      </help>
      <enumList>
        <enumValue>
          <term>-- None --</term>
          <internal>0</internal>
        </enumValue>
        <enumValue>
          <term>10th percentile</term>
          <internal>10</internal>
        </enumValue>
        <enumValue>
          <term>20th percentile</term>
          <internal>20</internal>
        </enumValue>
        <enumValue>
          <term>30th percentile</term>
          <internal>30</internal>
        </enumValue>
        <enumValue>
          <term>40th percentile</term>
          <internal>40</internal>
        </enumValue>
        <enumValue>
          <term>50th percentile</term>
          <internal>50</internal>
        </enumValue>
        <enumValue>
          <term>60th percentile</term>
          <internal>60</internal>
        </enumValue>
        <enumValue default="true">
          <term>70th percentile</term>
          <internal>70</internal>
        </enumValue>
        <enumValue>
          <term>80th percentile</term>
          <internal>80</internal>
        </enumValue>
        <enumValue>
          <term>90th percentile</term>
          <internal>90</internal>
        </enumValue>
      </enumList>
    </enumParam>


    <stringParam name="start_location"
                 prompt="Start Location"
                 number="true">
      <help>Lower bound on nucleotide range to search for gene</help>
      <suggest default="1"/>
    </stringParam>

    <stringParam name="end_location"
                 prompt="End Location"
                 number="true">
      <help>Upper bound on nucleotide range to search for gene.  Use a number larger than the sequence length to search to the end of the sequence.</help>
      <suggest default="10000000000"/>
    </stringParam>

    <stringParam name="percentile_threshold"
                 prompt="Minimum intensity percentile"
                 number="true">
      <help>Lower bound on intensity percentile.</help>
      <suggest default="50"/>
    </stringParam>

    <stringParam name="min_expression_percentile"
                 prompt="Minimum expression percentile"
                 number="true">
      <help>Lower bound on expression percentile.</help>
      <suggest default="50"/>
    </stringParam>

    <stringParam name="max_expression_percentile"
                 prompt="Maximum expression percentile"
                 number="true">
      <help>Upper bound on expression percentile.</help>
      <suggest default="100"/>
    </stringParam>

    <stringParam name="r_min_expression_percentile"
                 prompt="Rings min percentile"
                 number="true">
      <help>Lower bound on expression percentile.</help>
      <suggest default="0"/>
    </stringParam>

    <stringParam name="r_max_expression_percentile"
                 prompt="Rings max percentile"
                 number="true">
      <help>Upper bound on expression percentile.</help>
      <suggest default="100"/>
    </stringParam>

    <stringParam name="yt_min_expression_percentile"
                 prompt="Early trophs min percentile"
                 number="true">
      <help>Lower bound on expression percentile.</help>
      <suggest default="0"/>
    </stringParam>

    <stringParam name="yt_max_expression_percentile"
                 prompt="Early trophs max percentile"
                 number="true">
      <help>Upper bound on expression percentile.</help>
      <suggest default="100"/>
    </stringParam>

    <stringParam name="ys_min_expression_percentile"
                 prompt="Early schizont min percentile"
                 number="true">
      <help>Lower bound on expression percentile.</help>
      <suggest default="0"/>
    </stringParam>

    <stringParam name="ys_max_expression_percentile"
                 prompt="Early schizont max percentile"
                 number="true">
      <help>Upper bound on expression percentile.</help>
      <suggest default="100"/>
    </stringParam>

    <stringParam name="ms_min_expression_percentile"
                 prompt="Late schizont min percentile"
                 number="true">
      <help>Lower bound on expression percentile.</help>
      <suggest default="0"/>
    </stringParam>

    <stringParam name="ms_max_expression_percentile"
                 prompt="Late schizont max percentile"
                 number="true">
      <help>Upper bound on expression percentile.</help>
      <suggest default="100"/>
    </stringParam>


    <stringParam name="percentage_sim_haploblck"
                 prompt="Percentage of similarly associated regions >="
                 number="true">
      <help>The percentage of regions associated to this gene that must also be associated to returned genes.</help>
      <suggest default="25"/>
    </stringParam>


    <enumParam name="localization"
               prompt="Localization"
               multiPick="false">

      <help> <![CDATA[
             Select the target localization that you wish to query.<br></br>
             Genes returned by the search are predicted to be
             targeted to the apicoplast based on amino acid characteristics of their
             protein products or targeted to the red blood cell memebrane based on the
             presence of Pexel or HT motifs.
                       ]]></help>
      <enumList>
        <enumValue>
          <term>Apicoplast</term>
          <internal>apicoplast</internal>
        </enumValue>
        <enumValue>
          <term>RBC membrane (Pexel motif)</term>
          <internal>pexel</internal>
        </enumValue>
        <enumValue>
          <term>RBC membrane (HT motif)</term>
          <internal>ht</internal>
        </enumValue>
      </enumList>
    </enumParam>

    <stringParam name="ortholog_pattern"
                 prompt="Ortholog pattern" number="false">
      <help>This will be generated by clicking the species tree nodes.</help>
      <suggest default=""/>
    </stringParam>


    <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!--  If 'ARCH' term becomes obsolete, UPDATE  WdkQueryPlugin.java line 458-->
    <!--  (it is a param only used by the View, but it has to be sent by ApiFedPlugin.java) -->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!-- adding allowEmpty and emptyValue to simplify the REST URL :  -->
    <!--   make them not-required but still provide a valid value (otherwise stepFactory complains) -->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->


    <flatVocabParam name="phyletic_indent_map"
                    queryRef="GeneVQ.PhyleticIndentMap"
                    visible="false"
                    quote="false"
                    multiPick="true">
      <help>Results will be sorted ascending or descending order</help>
      <suggest selectMode="none"  allowEmpty="true" emptyValue="ARCH"/>
    </flatVocabParam>

    <flatVocabParam name="phyletic_term_map"
                    queryRef="GeneVQ.PhyleticTermMap"
                    visible="false"
                    quote="false"
                    multiPick="true">
      <help>Results will be sorted ascending or descending order</help>
      <suggest selectMode="none"  allowEmpty="true" emptyValue="rnor"/>
    </flatVocabParam>

    <enumParam name="phyletic_indent_map2"
               visible="false"
               quote="false">
      <help>
        Results will be sorted ascending or descending order
      </help>
      <enumList>
        <enumValue>
          <term>Archaea</term>
          <internal>0</internal>
        </enumValue>
        <enumValue>
          <term>halo</term>
          <internal>1</internal>
        </enumValue>
        <enumValue>
          <term>mjan</term>
          <internal>1</internal>
        </enumValue>
        <enumValue>
          <term>nequ</term>
          <internal>1</internal>
        </enumValue>
        <enumValue>
          <term>ssol</term>
          <internal>1</internal>
        </enumValue>
        <enumValue>
          <term>Bacteria</term>
          <internal>0</internal>
        </enumValue>
        <enumValue>
          <term>aaeo</term>
          <internal>1</internal>
        </enumValue>
        <enumValue>
          <term>bant</term>
          <internal>1</internal>
        </enumValue>
        <enumValue>
          <term>cper</term>
          <internal>1</internal>
        </enumValue>
        <enumValue>
          <term>cpne</term>
          <internal>1</internal>
        </enumValue>
        <enumValue>
          <term>ctep</term>
          <internal>1</internal>
        </enumValue>
        <enumValue>
          <term>deth</term>
          <internal>1</internal>
        </enumValue>
        <enumValue>
          <term>drad</term>
          <internal>1</internal>
        </enumValue>
        <enumValue>
          <term>lmon</term>
          <internal>1</internal>
        </enumValue>
        <enumValue>
          <term>mtub</term>
          <internal>1</internal>
        </enumValue>
        <enumValue>
          <term>rbal</term>
          <internal>1</internal>
        </enumValue>
        <enumValue>
          <term>saur</term>
          <internal>1</internal>
        </enumValue>
        <enumValue>
          <term>spne</term>
          <internal>1</internal>
        </enumValue>
        <enumValue>
          <term>syne</term>
          <internal>1</internal>
        </enumValue>
        <enumValue>
          <term>tmar</term>
          <internal>1</internal>
        </enumValue>
        <enumValue>
          <term>tpal</term>
          <internal>1</internal>
        </enumValue>
        <enumValue>
          <term>Proteobacteria</term>
          <internal>1</internal>
        </enumValue>
        <enumValue>
          <term>atum</term>
          <internal>2</internal>
        </enumValue>
        <enumValue>
          <term>bsui</term>
          <internal>2</internal>
        </enumValue>
        <enumValue>
          <term>bmal</term>
          <internal>2</internal>
        </enumValue>
        <enumValue>
          <term>cbur</term>
          <internal>2</internal>
        </enumValue>
        <enumValue>
          <term>cjej</term>
          <internal>2</internal>
        </enumValue>
        <enumValue>
          <term>ecol</term>
          <internal>2</internal>
        </enumValue>
        <enumValue>
          <term>ftul</term>
          <internal>2</internal>
        </enumValue>
        <enumValue>
          <term>gsul</term>
          <internal>2</internal>
        </enumValue>
        <enumValue>
          <term>rsol</term>
          <internal>2</internal>
        </enumValue>
        <enumValue>
          <term>rtyp</term>
          <internal>2</internal>
        </enumValue>
        <enumValue>
          <term>sfle</term>
          <internal>2</internal>
        </enumValue>
        <enumValue>
          <term>sent</term>
          <internal>2</internal>
        </enumValue>
        <enumValue>
          <term>vcho</term>
          <internal>2</internal>
        </enumValue>
        <enumValue>
          <term>wsuc</term>
          <internal>2</internal>
        </enumValue>
        <enumValue>
          <term>ypes</term>
          <internal>2</internal>
        </enumValue>
        <enumValue>
          <term>Eukaryota</term>
          <internal>0</internal>
        </enumValue>
        <enumValue>
          <term>ddis</term>
          <internal>1</internal>
        </enumValue>
        <enumValue>
          <term>edis</term>
          <internal>1</internal>
        </enumValue>
        <enumValue>
          <term>ehis</term>
          <internal>1</internal>
        </enumValue>
        <enumValue>
          <term>einv</term>
          <internal>1</internal>
        </enumValue>
        <enumValue>
          <term>Diplomonads</term>
          <internal>1</internal>
        </enumValue>
        <enumValue>
          <term>glam</term>
          <internal>2</internal>
        </enumValue>
        <enumValue>
          <term>glab</term>
          <internal>2</internal>
        </enumValue>
        <enumValue>
          <term>glae</term>
          <internal>2</internal>
        </enumValue>
        <enumValue>
          <term>Alveolates</term>
          <internal>1</internal>
        </enumValue>
        <enumValue>
          <term>Ciliates</term>
          <internal>2</internal>
        </enumValue>
        <enumValue>
          <term>tthe</term>
          <internal>3</internal>
        </enumValue>
        <enumValue>
          <term>Apicomplexa</term>
          <internal>2</internal>
        </enumValue>
        <enumValue>
          <term>Coccidia</term>
          <internal>3</internal>
        </enumValue>
        <enumValue>
          <term>chom</term>
          <internal>4</internal>
        </enumValue>
        <enumValue>
          <term>cpar</term>
          <internal>4</internal>
        </enumValue>
        <enumValue>
          <term>tgon</term>
          <internal>4</internal>
        </enumValue>
        <enumValue>
          <term>ncan</term>
          <internal>4</internal>
        </enumValue>
        <enumValue>
          <term>Haemosporida</term>
          <internal>3</internal>
        </enumValue>
        <enumValue>
          <term>pber</term>
          <internal>4</internal>
        </enumValue>
        <enumValue>
          <term>pcha</term>
          <internal>4</internal>
        </enumValue>
        <enumValue>
          <term>pfal</term>
          <internal>4</internal>
        </enumValue>
        <enumValue>
          <term>pviv</term>
          <internal>4</internal>
        </enumValue>
        <enumValue>
          <term>pyoe</term>
          <internal>4</internal>
        </enumValue>
        <enumValue>
          <term>pkno</term>
          <internal>4</internal>
        </enumValue>
        <enumValue>
          <term>Piroplasmida</term>
          <internal>3</internal>
        </enumValue>
        <enumValue>
          <term>tpar</term>
          <internal>4</internal>
        </enumValue>
        <enumValue>
          <term>tann</term>
          <internal>4</internal>
        </enumValue>
        <enumValue>
          <term>Kinetoplastida</term>
          <internal>1</internal>
        </enumValue>
        <enumValue>
          <term>lbra</term>
          <internal>2</internal>
        </enumValue>
        <enumValue>
          <term>lmex</term>
          <internal>2</internal>
        </enumValue>
        <enumValue>
          <term>linf</term>
          <internal>2</internal>
        </enumValue>
        <enumValue>
          <term>lmaj</term>
          <internal>2</internal>
        </enumValue>
        <enumValue>
          <term>tbru</term>
          <internal>2</internal>
        </enumValue>
        <enumValue>
          <term>tbrg</term>
          <internal>2</internal>
        </enumValue>
        <enumValue>
          <term>tcon</term>
          <internal>2</internal>
        </enumValue>
        <enumValue>
          <term>tcru</term>
          <internal>2</internal>
        </enumValue>
        <enumValue>
          <term>tviv</term>
          <internal>2</internal>
        </enumValue>
        <enumValue>
          <term>Plants/Algae</term>
          <internal>1</internal>
        </enumValue>
        <enumValue>
          <term>atha</term>
          <internal>2</internal>
        </enumValue>
        <enumValue>
          <term>crei</term>
          <internal>2</internal>
        </enumValue>
        <enumValue>
          <term>cmer</term>
          <internal>2</internal>
        </enumValue>
        <enumValue>
          <term>gthe</term>
          <internal>2</internal>
        </enumValue>
        <enumValue>
          <term>osat</term>
          <internal>2</internal>
        </enumValue>
        <enumValue>
          <term>otau</term>
          <internal>2</internal>
        </enumValue>
        <enumValue>
          <term>tpse</term>
          <internal>2</internal>
        </enumValue>
        <enumValue>
          <term>Fungi</term>
          <internal>1</internal>
        </enumValue>
        <enumValue>
          <term>egos</term>
          <internal>2</internal>
        </enumValue>
        <enumValue>
          <term>aory</term>
          <internal>2</internal>
        </enumValue>
        <enumValue>
          <term>cgla</term>
          <internal>2</internal>
        </enumValue>
        <enumValue>
          <term>cneo</term>
          <internal>2</internal>
        </enumValue>
        <enumValue>
          <term>dhan</term>
          <internal>2</internal>
        </enumValue>
        <enumValue>
          <term>ecun</term>
          <internal>2</internal>
        </enumValue>
        <enumValue includeProjects="MicrosporidiaDB,UniDB">
          <term>eint</term>
          <internal>2</internal>
        </enumValue>
        <enumValue>
          <term>klac</term>
          <internal>2</internal>
        </enumValue>
        <enumValue>
          <term>ncra</term>
          <internal>2</internal>
        </enumValue>
        <enumValue>
          <term>pchr</term>
          <internal>2</internal>
        </enumValue>
        <enumValue>
          <term>scer</term>
          <internal>2</internal>
        </enumValue>
        <enumValue>
          <term>spom</term>
          <internal>2</internal>
        </enumValue>
        <enumValue>
          <term>ylip</term>
          <internal>2</internal>
        </enumValue>
        <enumValue>
          <term>Animals</term>
          <internal>1</internal>
        </enumValue>
        <enumValue>
          <term>Platyhelminthes</term>
          <internal>2</internal>
        </enumValue>
        <enumValue>
          <term>sman</term>
          <internal>3</internal>
        </enumValue>
        <enumValue>
          <term>Nematodes</term>
          <internal>2</internal>
        </enumValue>
        <enumValue>
          <term>bmaa</term>
          <internal>3</internal>
        </enumValue>
        <enumValue>
          <term>cele</term>
          <internal>3</internal>
        </enumValue>
        <enumValue>
          <term>cbri</term>
          <internal>3</internal>
        </enumValue>
        <enumValue>
          <term>Arthropoda</term>
          <internal>2</internal>
        </enumValue>
        <enumValue>
          <term>aaeg</term>
          <internal>3</internal>
        </enumValue>
        <enumValue>
          <term>agam</term>
          <internal>3</internal>
        </enumValue>
        <enumValue>
          <term>amel</term>
          <internal>3</internal>
        </enumValue>
        <enumValue>
          <term>dmel</term>
          <internal>3</internal>
        </enumValue>
        <enumValue>
          <term>Vertebrates</term>
          <internal>2</internal>
        </enumValue>
        <enumValue>
          <term>Bony Fish</term>
          <internal>3</internal>
        </enumValue>
        <enumValue>
          <term>cint</term>
          <internal>4</internal>
        </enumValue>
        <enumValue>
          <term>drer</term>
          <internal>4</internal>
        </enumValue>
        <enumValue>
          <term>trub</term>
          <internal>4</internal>
        </enumValue>
        <enumValue>
          <term>tnig</term>
          <internal>4</internal>
        </enumValue>
        <enumValue>
          <term>Tetrapoda</term>
          <internal>3</internal>
        </enumValue>
        <enumValue>
          <term>Birds</term>
          <internal>4</internal>
        </enumValue>
        <enumValue>
          <term>ggal</term>
          <internal>5</internal>
        </enumValue>
        <enumValue>
          <term>Mammals</term>
          <internal>4</internal>
        </enumValue>
        <enumValue>
          <term>hsap</term>
          <internal>5</internal>
        </enumValue>
        <enumValue>
          <term>mmus</term>
          <internal>5</internal>
        </enumValue>
        <enumValue>
          <term>rnor</term>
          <internal>5</internal>
        </enumValue>
      </enumList>
    </enumParam>


    <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!--  If the 4 letter code 'rnor' becomes obsolete, UPDATE  WdkQueryPlugin.java line 460-->
    <!--  (it is a param only used by the View, but it has to be sent by ApiFedPlugin.java) -->
    <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

    <enumParam name="phyletic_term_map2"
               visible="false">
      <help>
        Results will be sorted ascending or descending order
      </help>
      <enumList>
        <enumValue>
          <term>aaeg</term>
          <internal>Aedes aegypti</internal>
        </enumValue>
        <enumValue>
          <term>atum</term>
          <internal>Agrobacterium tumefaciens C58 Uwash</internal>
        </enumValue>
        <enumValue>
          <term>agam</term>
          <internal>Anopheles gambiae PEST</internal>
        </enumValue>
        <enumValue>
          <term>amel</term>
          <internal>Apis mellifera</internal>
        </enumValue>
        <enumValue>
          <term>aaeo</term>
          <internal>Aquifex aeolicus VF5</internal>
        </enumValue>
        <enumValue>
          <term>atha</term>
          <internal>Arabidopsis thaliana</internal>
        </enumValue>
        <enumValue>
          <term>egos</term>
          <internal>Eremothecium gossypii</internal>
        </enumValue>
        <enumValue>
          <term>aory</term>
          <internal>Aspergillus oryzae</internal>
        </enumValue>
        <enumValue>
          <term>bant</term>
          <internal>Bacillus anthracis Ames</internal>
        </enumValue>
        <enumValue>
          <term>bsui</term>
          <internal>Brucella suis 1330</internal>
        </enumValue>
        <enumValue>
          <term>bmaa</term>
          <internal>Brugia malayi</internal>
        </enumValue>
        <enumValue>
          <term>bmal</term>
          <internal>Burkholderia mallei ATCC 23344</internal>
        </enumValue>
        <enumValue>
          <term>cbri</term>
          <internal>Caenorhabditis briggsae</internal>
        </enumValue>
        <enumValue>
          <term>cele</term>
          <internal>Caenorhabditis elegans</internal>
        </enumValue>
        <enumValue>
          <term>cjej</term>
          <internal>Campylobacter jejuni subsp. jejuni NCTC 11168</internal>
        </enumValue>
        <enumValue>
          <term>cgla</term>
          <internal>Candida glabrate CBS138</internal>
        </enumValue>
        <enumValue>
          <term>crei</term>
          <internal>Chlamydomonas reinhardtii</internal>
        </enumValue>
        <enumValue>
          <term>cpne</term>
          <internal>Chlamydophila pneumoniae CWL029</internal>
        </enumValue>
        <enumValue>
          <term>ctep</term>
          <internal>Chlorobium tepidum TLS</internal>
        </enumValue>
        <enumValue>
          <term>cint</term>
          <internal>Ciona intestinalis</internal>
        </enumValue>
        <enumValue>
          <term>cper</term>
          <internal>Clostridium perfringens str. 13</internal>
        </enumValue>
        <enumValue>
          <term>cbur</term>
          <internal>Coxiella burnetii RSA 493</internal>
        </enumValue>
        <enumValue>
          <term>cneo</term>
          <internal>Cryptococcus neoformans</internal>
        </enumValue>
        <enumValue>
          <term>chom</term>
          <internal>Cryptosporidium hominis TU502 (Type 1)</internal>
        </enumValue>
        <enumValue>
          <term>cpar</term>
          <internal>Cryptosporidium parvum Iowa (Type2)</internal>
        </enumValue>
        <enumValue>
          <term>cmer</term>
          <internal>Cyanodioschyzon merolae 10D</internal>
        </enumValue>
        <enumValue>
          <term>drer</term>
          <internal>Danio rerio</internal>
        </enumValue>
        <enumValue>
          <term>dhan</term>
          <internal>Debaryomyces hansenii CBS767</internal>
        </enumValue>
        <enumValue>
          <term>deth</term>
          <internal>Dehalococcoides ethenogenes 195</internal>
        </enumValue>
        <enumValue>
          <term>drad</term>
          <internal>Deinococcus radiodurans R1</internal>
        </enumValue>
        <enumValue>
          <term>ddis</term>
          <internal>Dictyostelium discoideum</internal>
        </enumValue>
        <enumValue>
          <term>dmel</term>
          <internal>Drosophila melanogaster</internal>
        </enumValue>
        <enumValue>
          <term>ecun</term>
          <internal>Encephalitozoon cuniculi</internal>
        </enumValue>
        <enumValue includeProjects="MicrosporidiaDB,UniDB">
          <term>eint</term>
          <internal>Encephalitozoon intestinalis</internal>
        </enumValue>
        <enumValue>
          <term>edis</term>
          <internal>Entamoeba dispar SAW760</internal>
        </enumValue>
        <enumValue>
          <term>ehis</term>
          <internal>Entamoeba histolytica</internal>
        </enumValue>
        <enumValue>
          <term>einv</term>
          <internal>Entamoeba invadens IP1</internal>
        </enumValue>
        <enumValue>
          <term>ecol</term>
          <internal>Escherichia coli K12</internal>
        </enumValue>
        <enumValue>
          <term>ftul</term>
          <internal>Francisella tularensis subsp. tularensis SCHU S4</internal>
        </enumValue>
        <enumValue>
          <term>trub</term>
          <internal>Takifugu rubripes</internal>
        </enumValue>
        <enumValue>
          <term>ggal</term>
          <internal>Gallus gallus</internal>
        </enumValue>
        <enumValue>
          <term>gsul</term>
          <internal>Geobacter sulfurreducens PCA</internal>
        </enumValue>
        <enumValue>
          <term>glam</term>
          <internal>Giardia lamblia Assemblage A isolate WB</internal>
        </enumValue>
        <enumValue>
          <term>glab</term>
          <internal>Giardia lamblia Assemblage B isolate GS</internal>
        </enumValue>
        <enumValue>
          <term>glae</term>
          <internal>Giardia lamblia Assemblage E isolate P15</internal>
        </enumValue>
        <enumValue>
          <term>gthe</term>
          <internal>Guillardia theta</internal>
        </enumValue>
        <enumValue>
          <term>halo</term>
          <internal>Halobacterium sp. NRC-1</internal>
        </enumValue>
        <enumValue>
          <term>hsap</term>
          <internal>Homo sapiens</internal>
        </enumValue>
        <enumValue>
          <term>klac</term>
          <internal>Kluyveromyces lactis CLIB210</internal>
        </enumValue>
        <enumValue>
          <term>lbra</term>
          <internal>Leishmania braziliensis</internal>
        </enumValue>
        <enumValue>
          <term>linf</term>
          <internal>Leishmania infantum</internal>
        </enumValue>
        <enumValue>
          <term>lmaj</term>
          <internal>Leishmania major</internal>
        </enumValue>
        <enumValue>
          <term>lmex</term>
          <internal>Leishmania mexicana</internal>
        </enumValue>
        <enumValue>
          <term>lmon</term>
          <internal>Listeria monocytogenes EGD-e</internal>
        </enumValue>
        <enumValue>
          <term>mjan</term>
          <internal>Methanococcus jannaschii DSSM 2661</internal>
        </enumValue>
        <enumValue>
          <term>mmus</term>
          <internal>Mus musculus</internal>
        </enumValue>
        <enumValue>
          <term>mtub</term>
          <internal>Mycobacterium tuberculosis H37Rv</internal>
        </enumValue>
        <enumValue>
          <term>nequ</term>
          <internal>Nanoarchaeum equitans Kin4-M</internal>
        </enumValue>
        <enumValue>
          <term>ncra</term>
          <internal>Neurospora crassa OR74A</internal>
        </enumValue>
        <enumValue>
          <term>osat</term>
          <internal>Oryza sativa</internal>
        </enumValue>
        <enumValue>
          <term>otau</term>
          <internal>Ostreococcus tauri</internal>
        </enumValue>
        <enumValue>
          <term>pchr</term>
          <internal>Phanerochaete chrysosporium</internal>
        </enumValue>
        <enumValue>
          <term>pber</term>
          <internal>Plasmodium berghei</internal>
        </enumValue>
        <enumValue>
          <term>pcha</term>
          <internal>Plasmodium chabaudi</internal>
        </enumValue>
        <enumValue>
          <term>pfal</term>
          <internal>Plasmodium falciparum 3D7</internal>
        </enumValue>
        <enumValue>
          <term>pkno</term>
          <internal>Plasmodium knowlesi</internal>
        </enumValue>
        <enumValue>
          <term>pviv</term>
          <internal>Plasmodium vivax</internal>
        </enumValue>
        <enumValue>
          <term>pyoe</term>
          <internal>Plasmodium yoelii 17X</internal>
        </enumValue>
        <enumValue>
          <term>rsol</term>
          <internal>Ralstonia solanacearum GMI1000</internal>
        </enumValue>
        <enumValue>
          <term>rnor</term>
          <internal>Rattus norvegicus</internal>
        </enumValue>
        <enumValue>
          <term>rbal</term>
          <internal>Rhodopirellula baltica SH_1</internal>
        </enumValue>
        <enumValue>
          <term>rtyp</term>
          <internal>Rickettsia typhi str. Wilmington</internal>
        </enumValue>
        <enumValue>
          <term>scer</term>
          <internal>Saccharomyces cerevisiae S288C</internal>
        </enumValue>
        <enumValue>
          <term>sent</term>
          <internal>Salmonella enterica subsp. enterica serovar Typhi str. CT18</internal>
        </enumValue>
        <enumValue>
          <term>sman</term>
          <internal>Schistosoma mansoni</internal>
        </enumValue>
        <enumValue>
          <term>spom</term>
          <internal>Schizosaccharomyces pombe</internal>
        </enumValue>
        <enumValue>
          <term>sfle</term>
          <internal>Shigella flexneri 2a str. 301</internal>
        </enumValue>
        <enumValue>
          <term>saur</term>
          <internal>Staphylococcus aureus subsp. aureus Mu50</internal>
        </enumValue>
        <enumValue>
          <term>spne</term>
          <internal>Streptococcus pneumoniae TIGR4</internal>
        </enumValue>
        <enumValue>
          <term>ssol</term>
          <internal>Sulfolobus solfataricus P2</internal>
        </enumValue>
        <enumValue>
          <term>syne</term>
          <internal>Synechococcus sp. WH8102</internal>
        </enumValue>
        <enumValue>
          <term>tthe</term>
          <internal>Tetrahymena thermophila</internal>
        </enumValue>
        <enumValue>
          <term>tnig</term>
          <internal>Tetraodon nigroviridis</internal>
        </enumValue>
        <enumValue>
          <term>tpse</term>
          <internal>Thalassiosira pseudonana</internal>
        </enumValue>
        <enumValue>
          <term>tann</term>
          <internal>Theileria annulata</internal>
        </enumValue>
        <enumValue>
          <term>tpar</term>
          <internal>Theileria parva</internal>
        </enumValue>
        <enumValue>
          <term>tmar</term>
          <internal>Thermotoga maritima MSB8</internal>
        </enumValue>
        <enumValue>
          <term>tgon</term>
          <internal>Toxoplasma gondii</internal>
        </enumValue>
        <enumValue>
          <term>ncan</term>
          <internal>Neospora caninum</internal>
        </enumValue>
        <enumValue>
          <term>tpal</term>
          <internal>Treponema pallidum subsp. pallidum str. Nichols</internal>
        </enumValue>
        <enumValue>
          <term>tbru</term>
          <internal>Trypanosoma brucei</internal>
        </enumValue>
        <enumValue>
          <term>tcon</term>
          <internal>Trypanosoma congolense</internal>
        </enumValue>
        <enumValue>
          <term>tcru</term>
          <internal>Trypanosoma cruzi</internal>
        </enumValue>
        <enumValue>
          <term>tbrg</term>
          <internal>Trypanosoma brucei gambiense</internal>
        </enumValue>
        <enumValue>
          <term>tviv</term>
          <internal>Trypanosoma vivax</internal>
        </enumValue>
        <enumValue>
          <term>vcho</term>
          <internal>Vibrio cholerae O1 biovar eltor str. N16961</internal>
        </enumValue>
        <enumValue>
          <term>wsuc</term>
          <internal>Wolinella succinogenes DSM 1740</internal>
        </enumValue>
        <enumValue>
          <term>ylip</term>
          <internal>Yarrowia lipolytica CLIB99</internal>
        </enumValue>
        <enumValue>
          <term>ypes</term>
          <internal>Yersinia pestis CO92</internal>
        </enumValue>
      </enumList>
    </enumParam>

    <flatVocabParam name="metabolic_pathway" includeProjects="PlasmoDB,ToxoDB,UniDB"
                    queryRef="GeneVQ.MetabolicPathways"
                    prompt="Metabolic Pathway"
                    multiPick="false"
                    dependedParamRef="organismParams.org_with_Hagai_pathways">
      <help>
        Results will be sorted ascending or descending order
      </help>
    </flatVocabParam>


    <stringParam name="phenotype_score_gt"
                 prompt="Phenotype Score >="
                 number="true">
      <help><![CDATA[ A gene's contribution to fitness: clones with guide RNAs for genes that contribute to fitness will grow slowly in the loss of function screen and have a negative phenotype score.  log2(gRNA infected / gRNA library)]]> </help>
      <suggest default="-6.89"/>
    </stringParam>

    <stringParam name="phenotype_score_lt"
                 prompt="Phenotype Score &lt;="
                 number="true">
      <help><![CDATA[A gene's contribution to fitness: clones with guide RNAs for genes that contribute to fitness will grow slowly in the loss of function screen and have a negative phenotype score.  log2(gRNA infected / gRNA library)]]></help>
      <suggest default="2.96"/>
    </stringParam>


    <filterParam name="phenoImageProtocolAppNodes" includeProjects="FungiDB,UniDB"
                 metadataQueryRef="GeneVQ.MetadataQuery_ncraOR74A_phenotype_GeneImage_NAFeaturePhenotypeImage_RSRC"
                 backgroundQueryRef="GeneVQ.MetadataQuery_ncraOR74A_phenotype_GeneImage_NAFeaturePhenotypeImage_RSRC"
                 ontologyQueryRef="GeneVQ.OntologyQuery_ncraOR74A_phenotype_GeneImage_NAFeaturePhenotypeImage_RSRC"
                 prompt="Images"
                 trimMetadataTerms="false">
      <help>
        Filter based on phenotype data
      </help>
    </filterParam>


    <filterParam name="phiBasedPhenotypeProtocolAppNodes" includeProjects="FungiDB,UniDB"
                 metadataQueryRef="GeneVQ.MetadataQuery_PHI-base_curated_phenotype_NAFeaturePhenotypeGeneric_RSRC"
                 backgroundQueryRef="GeneVQ.MetadataQuery_PHI-base_curated_phenotype_NAFeaturePhenotypeGeneric_RSRC"
                 ontologyQueryRef="GeneVQ.OntologyQuery_PHI-base_curated_phenotype_NAFeaturePhenotypeGeneric_RSRC"
                 prompt="Genes"
                 trimMetadataTerms="false">
      <help>
        Filter based on phenotype data
      </help>
    </filterParam>


    <filterParam name="phenoMutNAFeatureIds" includeProjects="FungiDB,UniDB"
                 metadataQueryRef="GeneVQ.MetadataQuery_ncraOR74A_phenotype_knockout_mutants_RSRC"
                 backgroundQueryRef="GeneVQ.MetadataQuery_ncraOR74A_phenotype_knockout_mutants_RSRC"
                 ontologyQueryRef="GeneVQ.OntologyQuery_ncraOR74A_phenotype_knockout_mutants_RSRC"
                 prompt="Genes"
                 trimMetadataTerms="false">
      <help>
        Filter based on phenotype data
      </help>
    </filterParam>




    <filterParam name="phenoBushnellGrowthRatesNAFeatureIds" includeProjects="PlasmoDB,UniDB"
                 metadataQueryRef="GeneVQ.MetadataQuery_pberANKA_phenotype_Bushnell_functional_profiling_RSRC"
                 backgroundQueryRef="GeneVQ.MetadataQuery_pberANKA_phenotype_Bushnell_functional_profiling_RSRC"
                 ontologyQueryRef="GeneVQ.OntologyQuery_pberANKA_phenotype_Bushnell_functional_profiling_RSRC"
                 prompt="Genes"
                 trimMetadataTerms="false">
      <help>
        Filter based on phenotype data
      </help>
    </filterParam>




    <filterParam name="phenotypeScoreFileterParam"
                 metadataQueryRef="GeneVQ.MetadataQuery_PhenotypeScore"
                 backgroundQueryRef="GeneVQ.MetadataQuery_PhenotypeScore"
                 ontologyQueryRef="GeneVQ.OntologyQuery_PhenotypeScore"
                 prompt="Genes"
                 dependedParamRef="geneParams.phenotypeScoreDataset"
                 trimMetadataTerms="false">
      <help>
        Filter based on phenotype data
      </help>
    </filterParam>




    <flatVocabParam name="phenotypeQualifier" includeProjects="TriTrypDB,FungiDB,UniDB"
                    queryRef="GeneVQ.phenotypeQualifier"
                    prompt="Phenotype Qualifier"
                    multiPick="false"
                    quote="false"
                    dependedParamRef="organismParams.organismwithPhenotype">

      <help>
        Choose a phenotype qualifier to see all available phenotypes for choosen organism with this qualifier.
      </help>
    </flatVocabParam>

    <flatVocabParam name="phenotype" includeProjects="TriTrypDB,FungiDB,UniDB"
                    queryRef="GeneVQ.phenotype"
                    prompt="Phenotype"
                    multiPick="false"
                    quote="false"
                    dependedParamRef="organismParams.organismwithPhenotype,geneParams.phenotypeQualifier">


      <help>
        Choose one or more phenotypes. Genes returned by this search were interrupted (e.g. by RNAi) and the
        resulting modified parasite exhibited this phenotype.
      </help>
    </flatVocabParam>



    <flatVocabParam name="reagent_type" includeProjects="PlasmoDB,CryptoDB,ToxoDB,UniDB"
                    queryRef="GeneVQ.Reagents"
                    prompt="Reagent Type"
                    multiPick="false">
      <help>
        Choose a reagent type
      </help>
    </flatVocabParam>


    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!--  -->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

    <stringParam name="min_isoelectric_point"
                 prompt="Min Isoelectric Point"
                 number="true">
      <help>   <![CDATA[ Enter the lower limit for the isoelectric point range that you wish to query.
             Genes returned by this search will have protein products with isoelectric points of
             <b>at least</b> this value.]]></help>
      <suggest default="6"/>
    </stringParam>

    <stringParam name="max_isoelectric_point"
                 prompt="Max Isoelectric Point"
                 number="true">
      <help>      <![CDATA[ Enter the upper limit for the isoelectric point range that you wish to query.
             Genes returned by this search will have protein products with isoelectric points of <b>no greater than</b>
             this value.]]></help>
      <suggest default="10"/>
    </stringParam>

    <stringParam name="min_molecular_weight"
                 prompt="Min Molecular Weight (Daltons)"
                 number="true">
      <help>  <![CDATA[ Enter the lower limit for the molecular weight range (Daltons) that you wish to query.
             Genes returned by this search will have protein products weighing <b>at least</b> this molecular weight.]]></help>
      <suggest default="10000"/>
    </stringParam>

    <stringParam name="max_molecular_weight"
                 prompt="Max Molecular Weight (Daltons)"
                 number="true">
      <help><![CDATA[Enter the upper limit for the molecular weight range (Daltons) that you wish to query.
            Genes returned by this search will have protein products weighing <b>no more than</b> this molecular weight.]]></help>
      <suggest default="50000"/>
    </stringParam>

    <stringParam name="profile_pattern"
                 visible="false" length="4000"
                 prompt="Profile Pattern" number="false">
      <help>Example: 'hsap=1T'</help>
      <suggest default="hsap=1T"/>
    </stringParam>

    <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!-- adding allowEmpty to simplify the REST URL :  -->
    <!--   make them not-required  -->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
    <stringParam name="included_species"
                 prompt="Included Species" number="false">
      <help>List of included species (for documentation only)</help>
      <suggest allowEmpty="true"/>
    </stringParam>

    <stringParam name="excluded_species"
                 prompt="Excluded Species" number="false">
      <help>List of excluded species (for documentation only)</help>
      <suggest allowEmpty="true"/>
    </stringParam>

    <stringParam name="min_exportpred_score"
                 prompt="Minimum ExportPred Score"
                 number="true">
      <help><![CDATA[Enter a mininum ExportPred score that must be assigned to a gene
            before it is returne dby this search.<br><br>
            A score threshold of 4.3 corresponds to a 5% FDR, meaning that we expect 5% of the resulting set
            of ExportPred predictions above this threshold to be false positives.

                  ]]></help>
      <suggest default="10"/>
    </stringParam>

    <enumParam name="asexual_blood_stages_value"
               prompt="Asexual blood stages">

      <help>
        Select "do not care", "not observed" or "observed" from the drop down menu, to search for peptides in this stage of the P. berghei life cycle.
      </help>
      <enumList>
        <enumValue>
          <term>do not care</term>
          <internal>any</internal>
        </enumValue>
        <enumValue>
          <term>not observed</term>
          <internal>0</internal>
        </enumValue>
        <enumValue>
          <term>observed</term>
          <internal>1</internal>
        </enumValue>
      </enumList>
    </enumParam>

    <enumParam name="gametocytes_value"
               prompt="Gametocytes">

      <help>
        Select "do not care", "not observed" or "observed" from the drop down menu, to search for peptides in this stage of the P. berghei life cycle.
      </help>
      <enumList>
        <enumValue>
          <term>do not care</term>
          <internal>any</internal>
        </enumValue>
        <enumValue>
          <term>not observed</term>
          <internal>0</internal>
        </enumValue>
        <enumValue>
          <term>observed</term>
          <internal>1</internal>
        </enumValue>
      </enumList>
    </enumParam>

    <enumParam name="ookinetes_value"
               prompt="Ookinetes">

      <help>
        Select "do not care", "not observed" or "observed" from the drop down menu, to search for peptides in this stage of the P. berghei life cycle.
      </help>
      <enumList>
        <enumValue>
          <term>do not care</term>
          <internal>any</internal>
        </enumValue>
        <enumValue>
          <term>not observed</term>
          <internal>0</internal>
        </enumValue>
        <enumValue>
          <term>observed</term>
          <internal>1</internal>
        </enumValue>
      </enumList>
    </enumParam>

    <enumParam name="oocysts_value"
               prompt="Oocysts">

      <help>
        Select "do not care", "not observed" or "observed" from the drop down menu, to search for peptides in this stage of the P. berghei life cycle.
      </help>
      <enumList>
        <enumValue>
          <term>do not care</term>
          <internal>any</internal>
        </enumValue>
        <enumValue>
          <term>not observed</term>
          <internal>0</internal>
        </enumValue>
        <enumValue>
          <term>observed</term>
          <internal>1</internal>
        </enumValue>
      </enumList>
    </enumParam>

    <enumParam name="sporozoites_value"
               prompt="Sporozoites">

      <help>
        Select "do not care", "not observed" or "observed" from the drop down menu, to search for peptides in this stage of the P. berghei life cycle.
      </help>
      <enumList>
        <enumValue>
          <term>do not care</term>
          <internal>any</internal>
        </enumValue>
        <enumValue>
          <term>not observed</term>
          <internal>0</internal>
        </enumValue>
        <enumValue>
          <term>observed</term>
          <internal>1</internal>
        </enumValue>
      </enumList>
    </enumParam>


    <enumParam name="liberal_conservative"
               prompt="For haplotype block boundaries, use :">

      <help>
        Select if Liberal or Conservative co-ordinates for haplotype blocks are to be used. A Conservative estimate of a haplotype block starts at the first microsatellite to map within the region and ends at the last microsatellite to map in the region. A Liberal estimate of a haplotype block starts at the end of the last microsatellite that was mapped in the previous haplotype block region and ends at the beginning of the first microsatellite mapped in the next haplotype block region. Both estimates are provided because of the lack of accurate co-ordinates of where exactly the cross-over event happened.
      </help>
      <enumList>
        <enumValue>
          <term>Liberal Locations</term>
          <internal>liberal</internal>
        </enumValue>
        <enumValue>
          <term>Conservative Locations</term>
          <internal>conservative</internal>
        </enumValue>
      </enumList>
    </enumParam>

    <flatVocabParam name="ms_assay"
                    queryRef="GeneVQ.MassAssay"
                    prompt="Experiments and Samples"
                    displayType="treeBox"
                    suppressNode="false"
                    multiPick="true">

      <help><![CDATA[
             Choose the Proteomics Experiment(s) and/or Sample(s) that you wish to query.  Click the + to expand a section.<br><br>

             Experiments are listed under the organism (reference genome) that peptides are aligned to. Experiment names are followed by the strain
             of the model organism and the first author's name in parentheses. Click the + next to the Experiment name for
             a list of samples analyzed in that experiment. Individual samples can be queried.]]>

      </help>
      <suggest selectMode="none"/>

      <propertyList name="organismProperties">
        <value>pruneNodesWithSingleExtendingChild</value>
        <value>showOnlyPreferredOrganisms</value>
      </propertyList>
    </flatVocabParam>

    <flatVocabParam name="ptm_assay" includeProjects="PlasmoDB,ToxoDB,TriTrypDB,FungiDB,HostDB,UniDB,PiroplasmaDB"
                    queryRef="GeneVQ.PTMAssay"
                    prompt="Experiments and Samples"
                    displayType="treeBox"
                    suppressNode="false"
                    quote="true"
                    dependedParamRef="geneParams.ptm_type"
                    multiPick="true">
      <help><![CDATA[
                Choose the experiment(s) and/or sample(s) that you wish to query for post-translational modifications.  Click the + to expand a section. <br><br>

                Experiments are listed by the organism (reference genome) that peptides are aligned to.]]>
      </help>

      <propertyList name="organismProperties">
        <value>pruneNodesWithSingleExtendingChild</value>
        <value>showOnlyPreferredOrganisms</value>
      </propertyList>
    </flatVocabParam>

    <flatVocabParam name="ptm_type" includeProjects="PlasmoDB,ToxoDB,TriTrypDB,FungiDB,HostDB,UniDB,PiroplasmaDB"
                    queryRef="GeneVQ.PTMType"
                    prompt="Type of Post-Translational Modification"
                    multiPick="false">
      <suggest selectMode="first" />
      <help><![CDATA[
                Choose the type(s) of post-translational modifications that you are interested in searching for.
        ]]></help>
    </flatVocabParam>

    <enumParam name="ptm_operator"
               prompt="Number of modifications is">
      <help><![CDATA[Search for genes where the number of post-translational modifications is greater than or equal to, equal to, or less than or equal to the entered number]]></help>
      <enumList>
        <enumValue default="true">
          <term>Greater than or equal to</term>
          <internal>&gt;=</internal>
        </enumValue>
        <enumValue>
          <term>Equal to</term>
          <internal>=</internal>
        </enumValue>
        <enumValue>
          <term> Less than or equal to</term>
          <internal>&lt;=</internal>
        </enumValue>
      </enumList>
    </enumParam>


    <stringParam name="ptm_count"
                 prompt="Number of Modifications"
                 number="true">
      <help><![CDATA[Restrict your search by the number of post-translational modifications per gene]]></help>
      <suggest default="1"/>
    </stringParam>

    <stringParam name="genbank_accession"
                 prompt="GenBank Accession Number"
                 number="false">
      <help>Enter a GenBank Accession number</help>
      <suggest default="1575532"/>
    </stringParam>

    <stringParam name="distanceFromTelomere"
                 prompt="Maximum Distance from Telomere"
                 number="true">
      <help><![CDATA[Define the size of the genomic region you wish to query by entering the 'Maximum Distance from Telomere'.<br><br>
            For each chromsome you have chosen, the search will query for genes that overlap two genomic regions.  Each genomic region has size equal to your
            distance but one begins at the start of the chromosome and one begins at the end of the chromosome.]]></help>
      <suggest default="30000"/>
    </stringParam>

    <!--
        <stringParam name="percentLowComplexity"
                      number="true"
                      prompt="Percent of Low Complexity in Protein">
            <help>Enter an lower bound on the percent of low complexity.</help>
            <suggest default="30"/>
        </stringParam>
-->

    <stringParam name="max_centromere_distance"
                 prompt="Maximum Distance from Centromere"
                 number="true">
      <help><![CDATA[Define the query region by entering a distance (in nucleotides) from the centromere. <br><br>
            The search queries two regions.  Each region is the size of your Max Distance but is located on the opposite side of the centromere.</br></br>
            Genes between the centromere and the Maximum Distance from Centromere will be returned by the search.]]></help>
      <suggest default="10000"/>
    </stringParam>

    <enumParam name="start_from"
               prompt="Start Location"
               multiPick="false">

      <help>
        Select whether to measure the start point from the beginning or end of the sequence
      </help>
      <enumList>
        <enumValue>
          <term>beginning</term>
          <internal>beginning</internal>
        </enumValue>
        <enumValue>
          <term>end</term>
          <internal>end</internal>
        </enumValue>
      </enumList>
    </enumParam>

    <enumParam name="end_from"
               prompt="From"
               multiPick="false">

      <help>
        Select whether to measure the end point from the beginning or end of the sequence
      </help>
      <enumList>
        <enumValue>
          <term>end</term>
          <internal>end</internal>
        </enumValue>
        <enumValue>
          <term>beginning</term>
          <internal>beginning</internal>
        </enumValue>
      </enumList>
    </enumParam>

    <enumParam name="protein_dataset"
               prompt="Protein Dataset"
               multiPick="true">

      <help>
        Select whether to measure the end point from the beginning or end of the sequence
      </help>
      <enumList>
        <enumValue>
          <term>GenBank</term>
          <internal>'NRDB_gb_dbXRefBySeqIdentity'</internal>
        </enumValue>
        <enumValue>
          <term>RefSeq</term>
          <internal>'NRDB_ref_dbXRefBySeqIdentity'</internal>
        </enumValue>
        <enumValue>
          <term>Swiss-Prot</term>
          <internal>'NRDB_sp_dbXRefBySeqIdentity'</internal>
        </enumValue>
      </enumList>
    </enumParam>

    <stringParam name="pvalue_cutoff"
                 prompt="BLAST P-value less than 10 to the"
                 number="true">
      <help>Only consider BLAST similarities with a P-value less than ten to the given power.</help>
      <suggest default="-20"/>
    </stringParam>

    <flatVocabParam name="clades"
                    queryRef="GeneVQ.Clades"
                    prompt="With similarity to PDB Proteins from"
                    multiPick="true">

      <help>
        Select one or more clades.
      </help>
      <suggest default="Eukaryota"/>
    </flatVocabParam>

    <stringParam name="accession"
                 prompt="Accession number"
                 number="false">
      <help>Enter a GenBank, RefSeq, or SwissProt accession number</help>
      <suggest default="CAD50836.1"/>
    </stringParam>

    <stringParam name="min_coil"
                 prompt="Minimum percent coil"
                 number="true">
      <help>       <![CDATA[ Enter the lower limit (percentage) for the range of coil content that you wish to query.
             Genes returned by this search will have protein products with secondary structure content
             <b>at least</b> this percentage coil.]]></help>
      <suggest default="0"/>
    </stringParam>

    <stringParam name="max_coil"
                 prompt="Maximum percent coil"
                 number="true">
      <help> <![CDATA[ Enter the upper limit (percentage) for the range of coil content that you wish to query.
             Genes returned by this search will have protein products with secondary structure content
             <b>no greater than</b> this percentage coil.]]></help>
      <suggest default="100"/>
    </stringParam>


    <stringParam name="min_strand"
                 prompt="Minimum percent strand"
                 number="true">
      <help><![CDATA[ Enter the lower limit (percentage) for the range of strand content that you wish to query.
             Genes returned by this search will have protein products with secondary structure content of
             <b>at least</b> this percentage strand.]]></help>
      <suggest default="0"/>
    </stringParam>

    <stringParam name="max_strand"
                 prompt="Maximum percent strand"
                 number="true">
      <help><![CDATA[ Enter the upper limit (percentage) for the range of strand content that you wish to query.
             Genes returned by this search will have protein products with secondary structure content
             <b>no greater than</b> this percentage strand.]]></help>
      <suggest default="100"/>
    </stringParam>

    <stringParam name="min_helix"
                 prompt="Minimum percent helix"
                 number="true">
      <help><![CDATA[ Enter the lower limit (percentage) for the range of helix content that you wish to query.
             Genes returned by this search will have protein products with secondary structure content of
             <b>at least</b> this percentage helix.]]></help>
      <suggest default="0"/>
    </stringParam>

    <stringParam name="max_helix"
                 prompt="Maximum percent helix"
                 number="true">
      <help><![CDATA[ Enter the upper limit (percentage) for the range of helix content that you wish to query.
             Genes returned by this search will have protein products with secondary structure content
             <b>no greater than</b> this percentage helix.]]></help>
      <suggest default="100"/>
    </stringParam>

    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!-- Expression profile similarity  -->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

    <stringParam name="ProfileGeneId"
                 prompt="Gene Id"
                 number="false">
      <help>Gene Id for which genes with a similar expression profile are to be fetched.</help>
      <suggest default="PF3D7_1133400" includeProjects="PlasmoDB,UniDB"/>
      <suggest default="TGME49_253730" includeProjects="ToxoDB"/>
      <suggest default="cgd3_510" includeProjects="CryptoDB"/>
      <suggest default="[e.g. CNAG_07878,NCU00010,YPR102C]" includeProjects="FungiDB"/>
      <suggest default="ENSMUSG00000021403.2" includeProjects="HostDB"/>
      <noTranslation value="true"  />
    </stringParam>

    <enumParam name="ProfileDistanceMethod"
               prompt="Distance Method"
               multiPick="false">

      <noTranslation value="false"  />
      <help>
        The method used to calculate the similarity distance
      </help>
      <enumList>
        <enumValue>
          <term>Euclidean Distance</term>
          <internal>euclidean_distance</internal>
        </enumValue>
        <enumValue>
          <term>Pearson Correlation</term>
          <internal>pearson_correlation</internal>
        </enumValue>
      </enumList>
    </enumParam>

    <stringParam name="ProfileNumToReturn"
                 prompt="# of Matches"
                 number="true">
      <help>The number of genes in the result</help>
      <suggest default="50"/>
    </stringParam>

    <stringParam name="ProfileMissingPtsPercent"
                 prompt="% of missing data points "
                 number="true">
      <help>Percentage of missing data points permissible</help>
      <suggest default="10"/>
    </stringParam>

    <enumParam name="ProfileSearchGoal"
               prompt="Search Goal"
               multiPick="false">

      <noTranslation value="false"  />
      <help>
        Type of correlation the search should look for
      </help>
      <enumList>
        <enumValue>
          <term>Positive Correlation</term>
          <internal>similar</internal>
        </enumValue>
        <enumValue>
          <term>Negative Correlation</term>
          <internal>dissimilar</internal>
        </enumValue>
      </enumList>
    </enumParam>

    <flatVocabParam name="profile_profile_set" includeProjects="MicrosporidiaDB,PlasmoDB,ToxoDB,CryptoDB,FungiDB,HostDB,UniDB"
                    queryRef="GeneVQ.ProfileProfileSet"
                    prompt="Experiment"
                    quote="false"
                    multiPick="false" >
      <help>Choose an Experiment. An Experiment consists of a set of samples that is defined by the data provider or the analytical method. The samples within an Experiment can be compared to each other. Datasets will have multiple Experiments if the samples are generated using different biological, experimental or analytical methods: sense vs. antisense, scaled vs. non-scaled, wild-type vs. mutant.</help>
      <suggest selectMode="none" />
    </flatVocabParam>


    <flatVocabParam name="profile_time_shift" includeProjects="MicrosporidiaDB,PlasmoDB,ToxoDB,CryptoDB,FungiDB,HostDB,UniDB"
                    queryRef="GeneVQ.ProfileTimeShift"
                    prompt="Time Shift"
                    multiPick="false"
                    quote="false">
      <help>The minimum time by which the similarity of expression profile of a gene can be shifted in time when compared to the input gene's profile (Hence, selecting 0 would return profiles that closely match the profile of the input gene Id).  </help>
      <suggest default="0 hours"/>
    </flatVocabParam>


    <stringParam name="ProfileScaleFactor" number="true" visible="false"
                 includeProjects="MicrosporidiaDB,PlasmoDB,ToxoDB,CryptoDB,FungiDB,HostDB,UniDB">
      <suggest default="1"/>
    </stringParam>

    <stringParam name="ProfileMinPoints" number="true" visible="false"
                 includeProjects="MicrosporidiaDB,PlasmoDB,ToxoDB,CryptoDB,FungiDB,HostDB,UniDB">
      <suggest default="10"/>
    </stringParam>



    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!-- text fields -->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

    <!-- Don't use vocab query until the WDK lets us control which picks are selected by default
    <flatVocabParam name="text_fields" 
                    queryRef="GeneVQ.TextFields"
                    prompt="Fields"
                    multiPick="true" >
         <help>Choose which text fields to search.</help>
    </flatVocabParam>
    -->

    <enumParam name="text_fields"
               prompt="Fields"
               multiPick="true">

      <noTranslation value="false"  />
      <help>
        Choose which text fields to search.
      </help>
      <enumList>
        <enumValue default="true" >
          <term>Alias</term>
          <internal>Alias</internal>
        </enumValue>
        <enumValue includeProjects="GiardiaDB,TriTrypDB,UniDB" default="true">
          <term>Cellular localization</term>
          <internal>CellularLocalization</internal>
        </enumValue>
        <enumValue includeProjects="FungiDB,UniDB"  default="true">
          <term>Community annotation</term>
          <internal>CommunityAnnotation</internal>
        </enumValue>
        <enumValue  default="true">
          <term>EC descriptions</term>
          <internal>EcNumbers</internal>
        </enumValue>
        <enumValue default="true">
          <term>Gene ID</term>
          <internal>GeneId</internal>
        </enumValue>
        <enumValue  default="true">
          <term>Gene notes</term>
          <internal>Notes</internal>
        </enumValue>
        <!--
        <enumValue includeProjects="PlasmoDB"  default="true">
          <term>Genes of previous release</term>
          <internal>PreviousReleaseGenes</internal>
        </enumValue>
-->
        <enumValue default="true">
          <term>Gene product</term>
          <internal>Product</internal>
        </enumValue>
        <enumValue default="true">
          <term>Gene name</term>
          <internal>GeneName</internal>
        </enumValue>
        <enumValue  default="true">
          <term>GO terms and definitions</term>
          <internal>GOTerms</internal>
        </enumValue>
        <enumValue excludeProjects="CryptoDB,GiardiaDB,TrichDB,TriTrypDB"  default="true">
          <term>Metabolic pathway names and descriptions</term>
          <internal>MetabolicPathways</internal>
        </enumValue>
        <enumValue includeProjects="FungiDB,TriTrypDB,UniDB"  default="true">
          <term>Phenotype</term>
          <internal>Phenotype</internal>
        </enumValue>
        <enumValue  default="true">
          <term>Protein domain names and descriptions</term>
          <internal>InterPro</internal>
        </enumValue>
        <enumValue  default="true">
          <term>PubMed</term>
          <internal>PubMed</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB"  default="true">
          <term>Rodent Malaria Phenotype</term>
          <internal>RodMalPhenotype</internal>
        </enumValue>
        <enumValue>
          <term>Similar proteins (BLAST hits v. NRDB/PDB)</term>
          <internal>Blastp</internal>
        </enumValue>
        <enumValue  default="true">
          <term>User comments</term>
          <internal>UserComments</internal>
        </enumValue>
      </enumList>
    </enumParam>

    <stringParam name="max_pvalue"
                 prompt="Max p-value exponent (BLAST Hits v. NRDB)"
                 number="true">
      <help>Only applicable to the 'Similar proteins' field.  Use this to filter away BLAST hits that are below a threshold of significance, so you only search the descriptions of significantly similar proteins.</help>
      <suggest default="-30"/>
      <regex>-\d+\.*\d*</regex>
    </stringParam>

    <stringParam name="e_value"
                 prompt="E value &lt;="
                 number="true">
      <help>Enter the maximum E value allowed to report domain matches.</help>
      <suggest default="0.05"/>
    </stringParam>

    <flatVocabParam name="domain_database"
                    queryRef="GeneVQ.DomainDatabase"
                    prompt="Domain Database"
                    quote="true"
                    multiPick="false">
      <help>
        Choose one of the constituent databases of InterPro.
      </help>
      <suggest default="Pfam"/>
    </flatVocabParam>

    <flatVocabParam name="domain_typeahead"
                    queryRef="GeneVQ.DomainAccession"
                    prompt="Specific Domain(s)"
                    multiPick="true"
                    displayType="typeAhead"
                    dependedParamRef="geneParams.domain_database">
      <suggest selectMode="none" />
      <help><![CDATA[Use this parameter to indicate the domain you wish to query for. Genes returned by this
            search have protein products that are predicted to contain the domain(s) you indicate here.<br><br>

            Begin typing a domain name, accession or description, to
            see a list of all possible domains that match what you have typed. Then choose a domain name from
            the list. You can choose multiple domains using CTRL- or CMD-click when choosing the domains. <br><br>

            Or paste
            a list of domain IDs separated by a comma, new line, white space or semicolon.  ]]></help>
    </flatVocabParam>
    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!-- Domain Wildcard Parameter -->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

    <stringParam name="domain_accession"
                 prompt="Free Text (use '*' for wildcard)" number="false" length="150">
      <suggest default=""/>
      <help><![CDATA[Use this parameter to indicate the domain you wish to query for. Genes returned by this
            search have protein products that are predicted to contain the domain(s) you indicate here. <br><br>
            Type the text term you wish to find, including an asterisk wildcard
            for ambiguous portions of your text term.  (*ase, kin*, *kinase*)  The search will query for all domains whose
            names, accessions or descriptions contain your text.
               ]]></help>
    </stringParam>

    <!--
      <flatVocabParam name="day_and_strain" includeProjects="PlasmoDB"
                     queryRef="GeneVQ.DayAndStrain"
                     prompt="Day of Gametocytogenesis and Strain"
                     multiPick="true">
        <help>
             Choose one or more strain/day combination
        </help>
      </flatVocabParam>

-->


    <enumParam name="sample"
               prompt="Expression of :"
               multiPick="false">

      <help> Select a sample.</help>
      <enumList>
        <enumValue>
          <term>RH (Type I)</term>
          <internal>RH(Type I)</internal>
        </enumValue>
        <enumValue>
          <term>GT1 (Type I)</term>
          <internal>GT1(Type I)</internal>
        </enumValue>
        <enumValue>
          <term>ME49 (Type II)</term>
          <internal>ME49(Type II)</internal>
        </enumValue>

        <enumValue>
          <term>Prugniaud (Type II)</term>
          <internal>Prugniaud(Type II)</internal>
        </enumValue>
        <enumValue>
          <term>VEG (Type III)</term>
          <internal>VEG(Type III)</internal>
        </enumValue>
        <enumValue>
          <term>CTG(Type III)</term>
          <internal>CTG(Type III)</internal>
        </enumValue>
      </enumList>
    </enumParam>


    <!--===========================================================================-->
    <!-- params for subType filters  -->
    <!--===========================================================================-->

    <!-- TODO UniDB Problem -->
    <enumParam name="subType"
               prompt="Include deprecated (demoted) genes"
               quote="false"
               multiPick="false"
               includeProjects="GiardiaDB,UniDB">
      <help>Genes with little or no evidence that overlapped (or were subsumed by) larger genes for which there was evidence such as protein similarities, expression evidence from EST alignments, or proteomics data were marked as deprecated.  These genes will likely be removed in a subsequent release of GiardiaDB (and in GenBank) unless additional evidence is provided indicating they should be moved into the real gene category.  Please add a user comment to those deprecated genes for which you have experimental evidence indicating that they are real. </help>
      <enumList>
        <enumValue default="true">
          <term>No</term>
          <internal>0</internal>
        </enumValue>
        <enumValue>
          <display>Yes</display>
          <term>skip</term>
          <internal>0,1</internal>
        </enumValue>
        <enumValue>
          <term>Deprecated Only</term>
          <internal>1</internal>
        </enumValue>
      </enumList>
    </enumParam>

<!--
    <enumParam name="subType"
               prompt="Include redundant genes"
               quote="false"
               multiPick="false"
               includeProjects="ToxoDB">
      <enumList>
        <enumValue default="true">
          <term>No</term>
          <internal>0</internal>
        </enumValue>
        <enumValue>
          <display>Yes</display>
          <term>skip</term>
          <internal>1</internal>
        </enumValue>
      </enumList>
    </enumParam>
-->
    <enumParam name="subType"
               prompt="Gene Instances Returned"
               quote="false"
               multiPick="false"
               includeProjects="ToxoDB">
      <enumList>
        <enumValue default="true">
          <term>Nonredundant representative (ME49 > GT1 > VEG)</term>
          <internal>508771,507601,432359</internal>
        </enumValue>
        <enumValue>
          <term>  Nonredundant ME49 only</term>
          <internal>508771</internal>
        </enumValue>
        <enumValue>
          <term>  Nonredundant GT1 only</term>
          <internal>507601</internal>
        </enumValue>
        <enumValue>
          <term>  Nonredundant VEG only</term>
          <internal>432359</internal>
        </enumValue>
        <enumValue>
          <display>Redundant instances (returns all instances)</display>
          <term>skip</term>
          <internal>1</internal>
        </enumValue>
      </enumList>
    </enumParam>



    <enumParam name="any_or_all_pathway"
               prompt="Pathways must contain: "
               multiPick="false"
               quote="false">

      <help>Return pathways associated with ANY of the record entered or return only pathways associated to ALL the records</help>
      <enumList>
        <enumValue default="true">
          <term>any</term>
          <internal>any</internal>
          <display>any of the specified genes</display>
        </enumValue>
        <enumValue>
          <term>all</term>
          <internal>all</internal>
          <display>all of the specified genes</display>
        </enumValue>
      </enumList>
    </enumParam>



    <enumParam name="any_or_all_DynSeg"
               prompt="Segments associated to Any OR All genes"
               multiPick="false"
               quote="false">

      <help>Return segments associated with ANY of the genes or only segements associated to ALL the genes</help>
      <enumList>
        <enumValue default="true">
          <term>any</term>
          <internal>any</internal>
        </enumValue>
        <enumValue>
          <term>all</term>
          <internal>all</internal>
        </enumValue>
      </enumList>
    </enumParam>



    <enumParam name="any_or_all_hpgrp"
               prompt="Matches Any or All associated regions"
               multiPick="false"
               quote="false">

      <help>Do Any OR All of the regions associated with this gene, should be associated with other genes ? (within the LOD cut off)</help>
      <enumList>
        <enumValue default="true">
          <term>any</term>
          <internal>any</internal>
        </enumValue>
        <enumValue>
          <term>all</term>
          <internal>all</internal>
        </enumValue>
      </enumList>
    </enumParam>


    <enumParam name="any_or_all"
               prompt="Matches Any or All Selected Samples?"
               multiPick="false"
               quote="true">

      <help>Does the percentile range match any or all of the chosen samples?</help>
      <enumList>
        <enumValue default="true">
          <term>any</term>
          <internal>any</internal>
        </enumValue>
        <enumValue>
          <term>all</term>
          <internal>all</internal>
        </enumValue>
      </enumList>
    </enumParam>


    <enumParam name="any_or_all_fc"
               prompt="Apply to Any or All Selected Samples?"
               multiPick="false"
               quote="false">

      <help>Does the fold difference and p value criteria/filter apply to any or all of the chosen samples?</help>
      <enumList>
        <enumValue default="true">
          <term>any</term>
          <internal>any</internal>
        </enumValue>
        <enumValue>
          <term>all</term>
          <internal>all</internal>
        </enumValue>
      </enumList>
    </enumParam>



    <flatVocabParam name="samples_fc_ref_generic_coverage"
                    queryRef="GeneVQ.GenericCoverageSamples"
                    prompt="Reference Sample(s)"
                    quote="false"
                    displayType="checkBox"
                    multiPick="true"
                    dependedParamRef="geneParams.profileset_generic_coverage">
      <help>Choose one or more sample.  NOTE: if more than one is chosen the fold difference in coverage will be calculated using the specified operation applied to the samples within the group</help>
      <suggest selectMode="none" />
    </flatVocabParam>

    <flatVocabParam name="samples_fc_comp_generic_coverage"
                    queryRef="GeneVQ.GenericCoverageSamples"
                    prompt="Comparison Sample(s)"
                    quote="false"
                    displayType="checkBox"
                    multiPick="true"
                    dependedParamRef="geneParams.profileset_generic_coverage">
      <help>Choose one or more sample.  NOTE: if more than one is chosen the fold difference in coverage will be calculated using the specified operation applied to the samples within the group</help>
      <suggest selectMode="none" />
    </flatVocabParam>




    <flatVocabParam name="samples_fc_direct_generic_page"
                    queryRef="GeneVQ.GenericDirectPageSamples"
                    prompt="Comparisons"
                    quote="false"
                    displayType="checkBox"
                    multiPick="false"
                    dependedParamRef="geneParams.profileset_generic">
      <help>Choose a comparison.  The sample shown is compared to Control Sample unless otherwise specified.</help>
      <suggest selectMode="none" />
    </flatVocabParam>





    <flatVocabParam name="samples_fc_ref_generic"
                    queryRef="GeneVQ.GenericSamples"
                    prompt="Reference Samples"
                    quote="false"
                    displayType="checkBox"
                    multiPick="true"
                    dependedParamRef="geneParams.profileset_generic">
      <help>Choose one or more sample.  NOTE: if more than one is chosen the fold difference will be calculated using the specified operation applied to the samples within the group</help>
      <suggest selectMode="none" />
    </flatVocabParam>

    <flatVocabParam name="samples_fc_comp_generic"
                    queryRef="GeneVQ.GenericSamples"
                    prompt="Comparison Samples"
                    quote="false"
                    displayType="checkBox"
                    multiPick="true"
                    dependedParamRef="geneParams.profileset_generic">
      <help>Choose one or more sample.  NOTE: if more than one is chosen the fold difference will be calculated using the specified operation applied to the samples within the group</help>
      <suggest selectMode="none" />
    </flatVocabParam>

    <flatVocabParam name="samples_direct_comp_generic"
                    queryRef="GeneVQ.GenericDirectSamples"
                    prompt="Samples"
                    quote="false"
                    displayType="checkBox"
                    multiPick="false"
                    dependedParamRef="geneParams.profileset_generic">
      <help>Choose one or more samples.</help>
      <suggest selectMode="all" />
    </flatVocabParam>

    <flatVocabParam name="samples_direct_comp_fdr_generic"
                    queryRef="GeneVQ.GenericSamples"
                    prompt="Samples"
                    quote="false"
                    multiPick="false"
                    dependedParamRef="geneParams.profileset_generic">
      <help>Choose one or more samples.</help>
      <suggest selectMode="none" />
    </flatVocabParam>


    <flatVocabParam name="samples_percentile_generic"
                    queryRef="GeneVQ.GenericPercentileSamples"
                    prompt="Samples"
                    quote="false"
                    displayType="checkBox"
                    multiPick="true"
                    dependedParamRef="geneParams.profileset_generic,geneParams.channel">
      <help>Choose one or more sample.  Use the any/all param to indicate whether any samples should match the percentile cutoff or all samples.</help>
      <suggest selectMode="none" />
    </flatVocabParam>


    <flatVocabParam name="samples_de_ref_generic_deseq"
                    queryRef="GeneVQ.GenericDESeqSamples"
                    prompt="Reference Sample"
                    quote="true"
                    displayType="checkBox"
                    multiPick="false"
                    dependedParamRef="geneParams.profileset_generic">
      <help>Choose reference sample for differential expression analysis. note only those samples with 2 or more replicates can be compared</help>
      <suggest selectMode="none" />
    </flatVocabParam>


    <flatVocabParam name="samples_de_comp_generic_deseq"
                    queryRef="GeneVQ.GenericDESeqSamples"
                    prompt="Comparator Sample"
                    quote="true"
                    displayType="checkBox"
                    multiPick="false"
                    dependedParamRef="geneParams.profileset_generic">
      <help>Choose comparator sample for differential expression analysis. note only those samples with 2 or more replicates can be compared</help>
      <suggest selectMode="none" />
    </flatVocabParam>


    <flatVocabParam name="samples_direct_generic_confidence"
                    queryRef="GeneVQ.GenericSamplesConfidence"
                    prompt="Comparison"
                    quote="false"
                    displayType="checkBox"
                    multiPick="true"
                    dependedParamRef="geneParams.profileset_generic">
      <help>Choose one or more sample.  NOTE: if more than one is chosen the fold difference will be calculated using the specified operation applied to the samples within the group</help>
      <suggest selectMode="all" />
    </flatVocabParam>

    <filterParam name="ref_samples_filter_metadata_all" includeProjects="PlasmoDB,UniDB"
                 metadataQueryRef="GeneVQ.SamplesMetadataMultiWiz"
                 backgroundQueryRef="GeneVQ.SamplesMetadataMultiWiz"
                 ontologyQueryRef="GeneVQ.OntologyMetadataSpec_ICEMR_Wiz"
                 prompt="Reference Samples"
                 trimMetadataTerms="false">
      <help>
        Select reference samples.
      </help>
    </filterParam>

    <filterParam name="ref_samples_filter_metadata_all_wiz" includeProjects="PlasmoDB,UniDB"
                 metadataQueryRef="GeneVQ.SamplesMetadataMultiWiz"
                 backgroundQueryRef="GeneVQ.SamplesMetadataMultiWiz"
                 ontologyQueryRef="GeneVQ.OntologyMetadataSpec_ICEMR_Wiz"
                 prompt="Reference Samples"
                 trimMetadataTerms="false">
      <help>
        Select reference samples.
      </help>
    </filterParam>

    <filterParam name="comp_samples_filter_metadata_all_wiz" includeProjects="PlasmoDB,UniDB"
                 metadataQueryRef="GeneVQ.SamplesMetadataMultiWiz"
                 backgroundQueryRef="GeneVQ.SamplesMetadataMultiWiz"
                 ontologyQueryRef="GeneVQ.OntologyMetadataSpec_ICEMR_Wiz"
                 prompt="Comparison Samples"
                 trimMetadataTerms="false">
      <help>
        Select comparison samples.
      </help>
    </filterParam>

    <filterParam name="comp_samples_filter_metadata_all" includeProjects="PlasmoDB,UniDB"
                 metadataQueryRef="GeneVQ.SamplesMetadataMultiWiz"
                 backgroundQueryRef="GeneVQ.SamplesMetadataMultiWiz"
                 ontologyQueryRef="GeneVQ.OntologyMetadataSpec_ICEMR_Wiz"
                 prompt="Comparison Samples"
                 trimMetadataTerms="false">
      <help>
        Select comparison samples.
      </help>
    </filterParam>


    <filterParam name="ref_samples_filter_metadata_loffler" includeProjects="PlasmoDB,UniDB"
                 metadataQueryRef="GeneVQ.SamplesMetadataLoffler"
                 backgroundQueryRef="GeneVQ.SamplesMetadataLoffler"
                 ontologyQueryRef="GeneVQ.OntologyMetadataSpec_Loffler"
                 prompt="Reference Samples"
                 trimMetadataTerms="false">
      <help>
        Select reference samples.
      </help>
    </filterParam>

    <filterParam name="comp_samples_filter_metadata_loffler" includeProjects="PlasmoDB,UniDB"
                 metadataQueryRef="GeneVQ.SamplesMetadataLoffler"
                 backgroundQueryRef="GeneVQ.SamplesMetadataLoffler"
                 ontologyQueryRef="GeneVQ.OntologyMetadataSpec_Loffler"
                 prompt="Comparison Samples"
                 trimMetadataTerms="false">
      <help>
        Select comparison samples.
      </help>
    </filterParam>

    <filterParam name="ref_samples_filter_metadata_loffler_wiz" includeProjects="PlasmoDB,UniDB"
                 metadataQueryRef="GeneVQ.SamplesMetadataLoffler"
                 backgroundQueryRef="GeneVQ.SamplesMetadataLoffler"
                 ontologyQueryRef="GeneVQ.OntologyMetadataSpec_Loffler"
                 prompt="Reference Samples"
                 trimMetadataTerms="false">
      <help>
        Select reference samples.
      </help>
    </filterParam>

    <filterParam name="comp_samples_filter_metadata_loffler_wiz" includeProjects="PlasmoDB,UniDB"
                 metadataQueryRef="GeneVQ.SamplesMetadataLoffler"
                 backgroundQueryRef="GeneVQ.SamplesMetadataLoffler"
                 ontologyQueryRef="GeneVQ.OntologyMetadataSpec_Loffler"
                 prompt="Comparison Samples"
                 trimMetadataTerms="false">
      <help>
        Select comparison samples.
      </help>
    </filterParam>


    <flatVocabParam name="metacycle_study_generic"
                    queryRef="GeneVQ.GenericMetacycleStudy"
                    prompt="Study/Experiment"
                    quote="false"
                    multiPick="false" >
      <help>Choose the Study/Experiment that you are interested in</help>
    </flatVocabParam>


       <flatVocabParam name="profileset_generic"
                     queryRef="GeneVQ.GenericProfiles"
                     prompt="Experiment"
                     quote="false"
                     displayType="checkBox"
                     multiPick="false">
            <help>Choose an Experiment. An Experiment consists of a set of samples that is defined by the data provider or the analytical method. The samples within an Experiment can be compared to each other. Datasets will have multiple Experiments if the samples are generated using different biological, experimental or analytical methods: sense vs. antisense, scaled vs. non-scaled, wild-type vs. mutant.</help>
        </flatVocabParam>

    <flatVocabParam name="profileset_generic_coverage"
                    queryRef="GeneVQ.GenericProfiles"
                    prompt="Experiment"
                    quote="false"
                    displayType="checkBox"
                    multiPick="false">
      <help>Choose an Experiment. An Experiment consists of a set of samples that is defined by the data provider or the analytical method. The samples within an Experiment can be compared to each other. Datasets will have multiple Experiments if the samples are generated using different biological, experimental or analytical methods: sense vs. antisense, scaled vs. non-scaled, wild-type vs. mutant.</help>
    </flatVocabParam>

    <flatVocabParam name="dataset_url"
                    queryRef="GeneVQ.DatasetUrl"
                    visible="false"
                    prompt="Dataset Url"
                    quote="false"
                    multiPick="false">
      <help>Internal param that provides the url for a dataset.</help>
    </flatVocabParam>


    <!-- params for Splice Site Q -->

    <flatVocabParam name="splice_site_generic" includeProjects="TriTrypDB,UniDB"
                    queryRef="GeneVQ.SpliceSiteExperiment"
                    prompt="Experiment"
                    quote="false"
                    multiPick="false" >
      <help>Choose the experiment</help>
      <suggest selectMode="none" />
    </flatVocabParam>

    <flatVocabParam name="splice_site_sample_one" includeProjects="TriTrypDB,UniDB"
                    queryRef="GeneVQ.SpliceSiteSample"
                    prompt="Reference Sample"
                    quote="false"
                    multiPick="false"
                    dependedParamRef="geneParams.splice_site_generic">
      <help>Choose a sample</help>
      <suggest selectMode="none" />
    </flatVocabParam>
    <flatVocabParam name="splice_site_sample_two" includeProjects="TriTrypDB,UniDB"
                    queryRef="GeneVQ.SpliceSiteSample"
                    prompt="Comparison Sample"
                    quote="false"
                    multiPick="false"
                    dependedParamRef="geneParams.splice_site_generic">
      <help>Choose a sample</help>
      <suggest selectMode="none" />
    </flatVocabParam>


    <stringParam name="percent_diff"
                 prompt="Predominant splice site percent minimum"
                 number="true">
      <help>Choose the minimum percentile of all the splice sites for this gene that the predominant splice site must meet in order to consider it for inclusion in this query.
      </help>
      <suggest default="60"/>
    </stringParam>

    <stringParam name="min_norm_count"
                 prompt="Minimum number of reads"
                 number="true">
      <help>Choose the minimum number of ((normalized) reads of the splice sites for this gene in order to consider it for inclusion in this query. 	    </help>
      <suggest default="10"/>
    </stringParam>

    <flatVocabParam name="nonnuclear_sequence" includeProjects="AmoebaDB,PlasmoDB,ToxoDB,FungiDB,HostDB,PiroplasmaDB,VectorBase,UniDB"
                    queryRef="GeneVQ.NonNuclearSequence"
                    prompt="Nonnuclear Genomic Sequence"
                    multiPick="true"
                    dependedParamRef="organismParams.org_with_nonnuclear_genes">
      <help includeProjects="PlasmoDB">Nonnuclear genomic sequence of various Plasmodium organisms includes the sequence of the mitochondrial and apicoplast genomes.</help>
      <help includeProjects="ToxoDB">Nonnuclear genomic sequence for T. gondii includes the sequence of the apicoplast genome. </help>
      <help includeProjects="UniDB">Nonnuclear genomic sequence of various Plasmodium organisms includes the sequence of the mitochondrial and apicoplast genomes. Nonnuclear genomic sequence for T. gondii includes the sequence of the apicoplast genome. </help>
    </flatVocabParam>

    <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!--Genes by CNV params                                                        -->
    <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

    <stringParam name="copyNumber" includeProjects="AmoebaDB,CryptoDB,PlasmoDB,ToxoDB,TriTrypDB,FungiDB,UniDB"
                 prompt="Copy Number"
                 number="true">
      <help><![CDATA[Enter a value for copy number.]]></help>
      <suggest default="2"/>
    </stringParam>

    <enumParam name="CNV_type" includeProjects="AmoebaDB,CryptoDB,PlasmoDB,ToxoDB,TriTrypDB,FungiDB,UniDB"
               prompt="Copy Number Metric">
      <help><![CDATA[Haploid number is the number of copies of a gene on a single chromosome.  Gene dose is the total number of copies of this gene, taking into account the ploidy of the chromosome it is encoded on.  For example, a single-copy gene on a diploid chromosome has a haploid number of 1 and a gene dose of 2]]></help>
      <enumList>
        <enumValue default="true">
          <term>Haploid number</term>
          <internal>haploid_number </internal>
        </enumValue>
        <enumValue >
          <term>Gene dose</term>
          <internal>gene_dose</internal>
        </enumValue>
      </enumList>
    </enumParam>

    <enumParam name="medianOrIndividual" includeProjects="AmoebaDB,CryptoDB,PlasmoDB,ToxoDB,TriTrypDB,FungiDB,UniDB"
               prompt="Median Or By Strain/Sample?"
               multiPick="false">
      <help><![CDATA[Choose to find genes where the median copy number across all the selected isolates meets the criteria (Median) or to find genes where any one of the selected isolates meets the criteria (By Strain/Sample)"]]></help>

      <enumList>
        <enumValue default="true">
          <term>Median of Selected Strains/Samples</term>
          <internal>median</internal>
        </enumValue>
        <enumValue default="true">
          <term>By Strain/Sample (at least one selected strain/sample meets criteria)</term>
          <internal>sample</internal>
        </enumValue>
      </enumList>
    </enumParam>

    <enumParam name="operator" includeProjects="AmoebaDB,CryptoDB,PlasmoDB,ToxoDB,TriTrypDB,FungiDB,UniDB"
               prompt="Operator">
      <help><![CDATA[Choose whether you want to search for genes where the copy number is greater than or equal to, equal to, or less than or equal to the chosen value]]></help>
      <enumList>
        <enumValue default="true">
          <term>Greater than or equal to</term>
          <internal>&gt;=</internal>
        </enumValue>
        <enumValue>
          <term>Equal to</term>
          <internal>=</internal>
        </enumValue>
        <enumValue>
          <term>Less than or equal to</term>
          <internal>&lt;=</internal>
        </enumValue>
      </enumList>
    </enumParam>

    <enumParam name="comparisonOperator" includeProjects="AmoebaDB,CryptoDB,PlasmoDB,ToxoDB,TriTrypDB,FungiDB,UniDB"
               prompt="What comparison do you want to make?">
      <help><![CDATA[Choose whether you want to search for genes where the copy number in the resequenced strain is greater than, less than, or equal to the reference]]></help>
      <enumList>
        <enumValue default="true">
          <term>Copy number in resequenced strain is greater than reference</term>
          <internal>&gt;</internal>
        </enumValue>
        <enumValue>
          <term>Copy number in resequenced strain is equal to reference</term>
          <internal>=</internal>
        </enumValue>
        <enumValue>
          <term>Copy number in resequenced strain is less than reference</term>
          <internal>&lt;</internal>
        </enumValue>
      </enumList>
    </enumParam>

    <enumParam name="genesWithTranscripts"
               prompt="Genes with:" multiPick="false" displayType="checkBox">

      <help>
        Choose genes in a previous result based on whether they do or don't have at least one transcript missing from that result
      </help>
      <enumList>
        <enumValue default="true">
          <display>missing transcripts in the result</display>
          <term>genes_missing_transcripts</term>
          <internal>genes_missing_transcripts</internal>
        </enumValue>
        <enumValue>
          <display>all transcripts included in the result</display>
          <term>genes_not_missing_transcripts</term>
          <internal>genes_not_missing_transcripts</internal>
        </enumValue>
      </enumList>
    </enumParam>

    <flatVocabParam name="missingOrFoundTranscripts"
                    prompt="Transcripts that were:"
                    multiPick="false"
                    queryRef="GeneVQ.missingOrFoundTranscripts"
                    dependedParamRef="geneParams.genesWithTranscripts">


      <help>
        Choose transcripts of the genes in a previous result based on whether the transcripts were missing or found in that result
      </help>
    </flatVocabParam>


    <flatVocabParam name="coexp_source" includeProjects="FungiDB,UniDB"
		    queryRef="GeneVQ.CoexpSource" visible="false">
   </flatVocabParam>

    <enumParam name="coexp_correlation"
               prompt="Correlation" multiPick="false">
      <help>Type of correlation the search should look for</help>
      <enumList>
        <enumValue default="true">
          <term>Positive Correlation</term>
          <internal>&gt;=</internal>
        </enumValue>
        <enumValue>
          <term>Negative Correlation</term>
          <internal>&lt;=</internal>
        </enumValue>
      </enumList>
    </enumParam>

    <stringParam name="coexp_value" includeProjects="FungiDB,UniDB"
                 prompt="Spearman coefficient (greater or equal to)"
                 number="true">
      <help><![CDATA[Enter a value for Spearman coefficient between 1 and -1.]]></help>
      <suggest default="0.75"/>
    </stringParam>


    <!-- Dataset was removed from Bld49 and loaded for bld-49 - redmine #41023 -->
    <enumParam name="coexp_network_distance"
               prompt="Highest reciprocal rank (HRR) network distance" multiPick="false">
      <help>Type of correlation the search should look for</help>
      <enumList>
        <enumValue default="true">
          <term>High : &lt;= 10 </term>
          <internal>&lt;=10</internal>
        </enumValue>
        <enumValue>
          <term>Medium : &lt;= 20</term>
          <internal>&lt;=20</internal>
        </enumValue>
        <enumValue>
          <term>Low : &lt;= 30</term>
          <internal>&lt;=30</internal>
        </enumValue>
      </enumList>
    </enumParam>

  </paramSet>


  <paramSet name="genePhenotypeParams">

    <enumParam name="text_fields"
               prompt="Fields"
               includeProjects="PlasmoDB,FungiDB,UniDB,TriTrypDB"
               multiPick="true">

      <noTranslation value="false"  />
      <help>
        Choose which text fields to search.
      </help>
      <enumList>
        <enumValue includeProjects="TriTrypDB,FungiDB,UniDB" default="true">
          <display>Phenotype</display>
          <term>Phenotype</term>
          <internal>Phenotype</internal>
        </enumValue>
        <enumValue includeProjects="PlasmoDB,UniDB"  default="true">
          <display>Rodent Malaria Phenotype</display>
          <term>RodMalPhenotype</term>
          <internal>RodMalPhenotype</internal>
        </enumValue>
      </enumList>
    </enumParam>

  </paramSet>

  <paramSet name="userDatasetParams">
    <flatVocabParam name="rna_seq_dataset"
                    queryRef="GeneVQ.RnaSeqUserDataset"
                    prompt="Your RNA-Seq Dataset"
                    multiPick="false" >
      <help>An RNA-Seq dataset that you have imported into your workspace, and that is installed in @PROJECT_ID@ </help>
    </flatVocabParam>

    <flatVocabParam name="profileset_generic"
                    queryRef="GeneVQ.rna_seq_profileset"
                    prompt="Experiment"
                    quote="false"
                    multiPick="false"
                    dependedParamRef="userDatasetParams.rna_seq_dataset">
      <help>Choose an Experiment. An Experiment consists of a set of samples that is defined by the data provider or the analytical method. The samples within an Experiment can be compared to each other. Datasets will have multiple Experiments if the samples are generated using different biological, experimental or analytical methods: sense vs. antisense, scaled vs. non-scaled, wild-type vs. mutant.</help>
    </flatVocabParam>

    <flatVocabParam name="samples_fc_ref_generic"
                    queryRef="GeneVQ.RnaSeqSamples"
                    prompt="Reference Sample(s)"
                    quote="false"
                    displayType="checkBox"
                    multiPick="true"
                    dependedParamRef="userDatasetParams.rna_seq_dataset,userDatasetParams.profileset_generic">
      <help>Choose one or more sample.  NOTE: if more than one is chosen the fold difference in coverage will be calculated using the specified operation applied to the samples within the group</help>
      <suggest selectMode="none" />
    </flatVocabParam>

    <flatVocabParam name="samples_fc_comp_generic"
                    queryRef="GeneVQ.RnaSeqSamples"
                    prompt="Comparison Sample(s)"
                    quote="false"
                    displayType="checkBox"
                    multiPick="true"
                    dependedParamRef="userDatasetParams.rna_seq_dataset,userDatasetParams.profileset_generic">
      <help>Choose one or more sample.  NOTE: if more than one is chosen the fold difference in coverage will be calculated using the specified operation applied to the samples within the group</help>
      <suggest selectMode="none" />
    </flatVocabParam>

    <flatVocabParam name="profileset_generic_antisense"
                    queryRef="GeneVQ.rna_seq_profileset"
                    prompt="Experiment"
                    quote="false"
                    multiPick="false"
                    dependedParamRef="userDatasetParams.rna_seq_dataset">
      <help>Choose an Experiment</help>
    </flatVocabParam>

    <flatVocabParam name="samples_fc_ref_generic_antisense"
                    queryRef="GeneVQ.RnaSeqSamplesAntisense"
                    prompt="Reference Sample(s)"
                    quote="false"
                    displayType="checkBox"
                    multiPick="true"
                    dependedParamRef="userDatasetParams.rna_seq_dataset">
      <help>Choose one or more sample.  NOTE: if more than one is chosen the fold difference in coverage will be calculated using the specified operation applied to the samples within the group</help>
      <suggest selectMode="none" />
    </flatVocabParam>

    <flatVocabParam name="samples_fc_comp_generic_antisense"
                    queryRef="GeneVQ.RnaSeqSamplesAntisense"
                    prompt="Comparison Sample(s)"
                    quote="false"
                    displayType="checkBox"
                    multiPick="true"
                    dependedParamRef="userDatasetParams.rna_seq_dataset">
      <help>Choose one or more sample.  NOTE: if more than one is chosen the fold difference in coverage will be calculated using the specified operation applied to the samples within the group</help>
      <suggest selectMode="none" />
    </flatVocabParam>

  </paramSet>


  <!--===========================================================================-->
  <!-- Vocab queries  -->
  <!--===========================================================================-->

    <querySet name="GeneVQ" queryType="vocab" isCacheable="true">

    <sqlQuery name="GeneModelCharOntology" isCacheable="false">
   <paramRef ref="geneParams.gene_or_transcript" />
   <paramRef ref="organismParams.organism_select_all"/>
      <column name="ontology_term_name"/>
      <column name="parent_ontology_term_name"/>
      <column name="display_name"/>
      <column name="description"/>
      <column name="type"/>
      <column name="units"/>
      <column name="precision"/>
      <column name="is_range"/>

      <sqlParamValue name="deprecated" includeProjects="GiardiaDB">
        <![CDATA[
          UNION
          SELECT
            'is_deprecated' as ontology_term_name, cast(null as varchar(1)) as parent_ontology_term_name,
            'Deprecated Genes' as display_name, 'Select deprecated genes' as description, cast(null as varchar(1)) as units,
            'string' as type, 0 as is_range, cast(null as varchar(1)) as precision, 7 as display_order
        ]]>
      </sqlParamValue>
      <sqlParamValue name="deprecated" excludeProjects="GiardiaDB"/>

      <sql>
        <![CDATA[
          SELECT * FROM (
            SELECT 'transcript_count' as ontology_term_name, cast(null as varchar(1)) as parent_ontology_term_name,
            'Transcript Count' as display_name, 'Number of transcripts per gene' as description, cast(null as varchar(1)) as units,
            'number' as type, 1 as is_range, cast(null as varchar(1)) as precision, 4 as display_order
            UNION
            SELECT 'transcript_exon_count' as ontology_term_name, cast(null as varchar(1)) as parent_ontology_term_name,
            'Transcript Exon Count' as display_name, 'Number of exons in the transcript' as description, cast(null as varchar(1)) as units,
            'number' as type, 1 as is_range, cast(null as varchar(1)) as precision, 6 as display_order
            UNION
            SELECT 'gene_exon_count' as ontology_term_name, cast(null as varchar(1)) as parent_ontology_term_name,
            'Gene Exon Count' as display_name, 'Number of exons in the gene' as description, cast(null as varchar(1)) as units,
            'number' as type, 1 as is_range, cast(null as varchar(1)) as precision, 5 as display_order
            UNION
            SELECT 'transcript_type' as ontology_term_name, cast(null as varchar(1)) as parent_ontology_term_name,
            'Transcript Type (SO)' as display_name, 'Select a sequence ontology term for this transcript' as description, cast(null as varchar(1)) as units,
            'string' as type, 0 as is_range, cast(null as varchar(1)) as precision, 2 as display_order
            UNION
            SELECT 'gene_type' as ontology_term_name, cast(null as varchar(1)) as parent_ontology_term_name,
            'Gene Type (SO)' as display_name, 'Select a sequence ontology term for this gene' as description, cast(null as varchar(1)) as units,
            'string' as type, 0 as is_range, cast(null as varchar(1)) as precision, 1 as display_order
            UNION
            SELECT 'gene_type_ebi' as ontology_term_name, cast(null as varchar(1)) as parent_ontology_term_name,
            'Gene Type (Biotype)' as display_name, 'Select gene biotype classification for this gene' as description, cast(null as varchar(1)) as units,
            'string' as type, 0 as is_range, cast(null as varchar(1)) as precision, 1 as display_order
            UNION
            SELECT 'organism' as ontology_term_name, cast(null as varchar(1)) as parent_ontology_term_name,
            'Organism' as display_name, 'Select organism' as description, cast(null as varchar(1)) as units,
            'string' as type, 0 as is_range, cast(null as varchar(1)) as precision, 0 as display_order
            UNION
            select distinct 'long_transcript_novelty' as ontology_term_name, cast(null as varchar(1)) as parent_ontology_term_name,
            'Support From Long Read Evidence' as display_name, 'Find genes based on overlapping models from long read RNA sequencing, for example from Oxford Nanopore or PacBio sequencing platforms. To be considered in this query, a model must have at least 5 supporting reads and be at least 20 bases long. Categories as follows: Novel in Collection (NIC): Prediction uses known splice donors and acceptors but reveals new connections (e.g., skipped exon isoforms); Incomplete Splice Match (ISM): Prediction matches subsection of a known transcript model, but has a novel putative start or end point; Novel Not In Collection (NNC): Prediction has at least one novel splice donor or acceptor; Genomic: Prediction has no overlapping splice junctions compared to known transcripts; Genomic: Prediction has no overlapping splice junctions compared to known transcripts; Known: Prediction exactly matches a known model.  NOTE: The percentage add up to more than 100% because one existing gene model can have more than associated TALON model.' as description, cast(null as varchar(1)) as units,
            'string' as type, 0 as is_range, cast(null as varchar(1)) as precision, 7 as display_order
            from apidbtuning.datasetdatasource dd, apidb.organism o
            where '$$gene_or_transcript$$' = 'gene_source_id'
              and dd.name like '%nanopore_longReadRnaSeq_RSRC'
              and o.abbrev in ($$organism_select_all$$)
              and dd.taxon_id = o.taxon_id
              and '@PROJECT_ID@' != 'EuPathDB'
            UNION
            select 'intron_junction' as ontology_term_name, cast(null as varchar(1)) as parent_ontology_term_name,
            'Support For Predicted Introns' as display_name, 'Find genes based on the number of introns with support from bulk RNA-Seq data. All-high; all introns supported with high confidence, All-low; all introns supported with low confidence, Any-high; at least one intron supported with high confidence, Any-low; at least one intron supported with low confidence.' as description, cast(null as varchar(1)) as units,
            'string' as type, 0 as is_range, cast(null as varchar(1)) as precision, 8 as display_order
            where '$$gene_or_transcript$$' = 'gene_source_id'
            and '@PROJECT_ID@' not in ('TriTrypDB', 'HostDB','TrichDB', 'EuPathDB')
            &&deprecated&&
          ) t
          ORDER BY display_order, display_name
        ]]>
      </sql>
    </sqlQuery>

   <sqlQuery name="GeneModelCharMetadata" isCacheable="false" >
     <paramRef ref="geneParams.gene_or_transcript" />
     <paramRef ref="organismParams.organism_select_all"/>
     <column name="ontology_term_name"/>
     <column name="internal"/>
     <column name="filter_item_id"/>
     <column name="number_value"/>
     <column name="date_value"/>
     <column name="string_value"/>
     <sql>

       <![CDATA[
		select $$gene_or_transcript$$ as filter_item_id
        , source_id as internal
        , ontology_term_name
        , string_value
        , number_value
        , cast(null as timestamp) as date_value
        from (
            select ontology_term_name , gene_source_id , source_id, taxon_name, number_value,
            CASE when string_value in ('Genomic') then 'Genomic'
                when string_value in ('Known') then 'Known'
                when string_value in ('NNC') then 'Novel Not In Collection'
                when string_value in ('NIC') then 'Novel In Collection'
                when string_value in ('ISM') then 'Incomplete Splice Match'
                else string_value
                end as string_value
            from webready.GeneModelCharacteristics_p gm
            where gm.org_abbrev in ($$organism_select_all$$)
            and (('$$gene_or_transcript$$' = 'gene_source_id') OR ('$$gene_or_transcript$$' = 'source_id' and ontology_term_name not in ('intron_junction', 'unique_reads','long_transcript_novelty')))
      ) o
          ]]>
    </sql>
    </sqlQuery>


      <!-- MetaCycle Param Queries -->

       <!-- placeholder -->
      <sqlQuery name="GenericMetacycleStudy" >
             <column name="internal"/>
             <column name="term"/>
          <sql>
           SELECT name AS internal, name AS term
          FROM study.nodeset
          </sql>
      </sqlQuery>



      <sqlQuery name="metacycle_study_ncraOR74A_Bharath_Circadian_Time_Course_ebi_rnaSeq_RSRC" isCacheable="false" includeProjects="FungiDB",UniDB>
            <column name="internal" />
            <column name="term" />
        <sql>
	      SELECT s.name as internal,
             CASE  WHEN s.name ='WT MetaCycle FirstStrand' THEN 'WT - Sense'
             WHEN s.name ='MSN MetaCycle FirstStrand' THEN 'ΔMSN - Sense'
             WHEN s.name ='WT MetaCycle SecondStrand' THEN 'WT - Antisense'
             ELSE 'ΔMSN Antisense' END "term"
        FROM STUDY.nodeset s, sres.externaldatabase ed, sres.externaldatabaserelease edr
        WHERE ed.name = 'ncraOR74A_Bharath_Circadian_Time_Course_ebi_rnaSeq_RSRC'
        AND ed.external_database_id = edr.external_database_id
        AND edr.external_database_release_id = s.external_database_release_id
        AND node_type IN ('RNASeq')
	    </sql>
      </sqlQuery>


      <sqlQuery name="metacycle_study_ncraOR74A_Hurley_2014_NC_3_ebi_rnaSeq_RSRC" isCacheable="false" includeProjects="FungiDB,UniDB">
            <column name="internal" />
            <column name="term" />
        <sql>
	      SELECT s.name as internal,
             CASE  WHEN s.name ='WT MetaCycle FirstStrand' THEN 'WT - Sense'
             WHEN s.name ='MSN MetaCycle FirstStrand' THEN 'ΔMSN - Sense'
             WHEN s.name ='WT MetaCycle SecondStrand' THEN 'WT - Antisense'
             ELSE 'ΔMSN Antisense' END "term"
        FROM STUDY.nodeset s, sres.externaldatabase ed, sres.externaldatabaserelease edr
        WHERE ed.name = 'ncraOR74A_Hurley_2014_NC_3_ebi_rnaSeq_RSRC'
        AND ed.external_database_id = edr.external_database_id
        AND edr.external_database_release_id = s.external_database_release_id
        AND node_type IN ('RNASeq')
      </sql>
      </sqlQuery>


      <sqlQuery name="metacycle_study_tbruTREU927_Rijo_Circadian_Regulation_ebi_rnaSeq_RSRC" includeProjects="TriTrypDB,UniDB">
             <column name="internal"/>
             <column name="term"/>
          <sql>
	   SELECT s.name as internal,
	     CASE  WHEN s.name ='BSF Alt MetaCycle' THEN 'BSF Alt'
	           WHEN s.name ='BSF Const MetaCycle' THEN 'BSF Const'
	           WHEN s.name ='PF Alt MetaCycle' THEN 'PF Alt'
	           ELSE 'PF Const' END AS term
	   FROM study.nodeset s
	   WHERE s.name like '%MetaCycle%'
          </sql>
        </sqlQuery>


      <sqlQuery name="metacycle_study_agamPEST_microarrayExpression_GSE22585_circadian_rhythm_RSRC" isCacheable="false" includeProjects="VectorBase,UniDB">
            <column name="internal" />
            <column name="term" />
        <sql>
	      SELECT s.name as internal,
             CASE  WHEN s.name ='WT MetaCycle FirstStrand' THEN 'WT - Sense'
             WHEN s.name ='MSN MetaCycle FirstStrand' THEN 'ΔMSN - Sense'
             WHEN s.name ='WT MetaCycle SecondStrand' THEN 'WT - Antisense'
             ELSE 'ΔMSN Antisense' END "term"
        FROM STUDY.nodeset s, sres.externaldatabase ed, sres.externaldatabaserelease edr
        WHERE ed.name = 'agamPEST_microarrayExpression_GSE22585_circadian_rhythm_RSRC'
        AND ed.external_database_id = edr.external_database_id
        AND edr.external_database_release_id = s.external_database_release_id
        AND node_type IN ('microarray')
    	</sql>
      </sqlQuery>




  <sqlQuery name="singleCellDataset" isCacheable="true" includeProjects="TriTrypDB,PlasmoDB,PiroplasmaDB,ToxoDB,HostDB,CryptoDB,UniDB">
    <paramRef ref="organismParams.organismsWithSingleCell" />
    <column name="term"/>
    <column name="internal"/>

      <sql>
        <![CDATA[
          SELECT CONCAT(dsp.display_name , ' (' , dsp.short_attribution , ')' ) as term
            , edr.external_database_release_id as internal
          FROM sres.externaldatabaserelease edr
            , sres.externaldatabase ed
            , apidbtuning.datasetpresenter dsp
            , apidbtuning.datasetdatasource dd
	    , apidb.organism o
          WHERE o.abbrev = $$organismsWithSingleCell$$
            AND dd.taxon_id = o.taxon_id
            AND dsp.name like '%cellxgene%'
            AND dsp.name = ed.name
            AND ed.external_database_id = edr.external_database_id
        ]]>
      </sql>
    </sqlQuery>



    <sqlQuery name="wgcnaDataset" isCacheable="false" >
      <column name="term"/>
      <column name="internal"/>

      <sql>
        <![CDATA[
          SELECT distinct d.name as term, r.external_database_release_id  as internal
          FROM sres.externaldatabase d
            , sres.externaldatabaserelease r
            , apidb.nafeatureWGCNAResults fwr
            , study.nodenodeset sl
            , study.nodeset s
          WHERE sl.protocol_app_node_id = fwr.protocol_app_node_id
            AND sl.node_set_id=  s.node_set_id
            AND r.external_database_release_id = s.external_database_release_id
            AND d.external_database_id = r.external_database_id
        ]]>
      </sql>
    </sqlQuery>


  <sqlQuery name="wgcnaParam" isCacheable="false" >
    <paramRef ref="geneParams.wgcnaDataset" />
    <column name="term"/>
    <column name="internal"/>
    <column name="display"/>
    <sql>
      <![CDATA[
        select display, internal, term from (
        select case when '@PROJECT_ID@' = 'HostDB' then CONCAT('h_', lower(display)) else CONCAT('p_', lower(display)) end as display,
               internal,
               case when '@PROJECT_ID@' = 'HostDB' then CONCAT('h_', lower(display)) else CONCAT('p_', lower(display)) end as term
          from (
        select distinct
          pan.protocol_app_node_id as internal
          , regexp_replace(pan.name,'(((\w+)\s){1}).*', '\1') as display --clean pan.name by keeping only the first full word
        from study.protocolappnode pan
          , study.nodeset s
          , study.nodenodeset sl
        where s.external_database_release_id = $$wgcnaDataset$$
          and s.node_set_id = sl.node_set_id
          and sl.protocol_app_node_id = pan.protocol_app_node_id
          and pan.name like '%module%'
         ) a
         UNION
         select 'Choose a Module' as display, -1 as internal, '1_choose_module' as term
         ) b
        order by term
      ]]>
    </sql>
  </sqlQuery>


    <sqlQuery name="geneListDataset" isCacheable="false" >
      <column name="term"/>
      <column name="internal"/>

      <sql>
        <![CDATA[
          SELECT DISTINCT d.name as term, r.external_database_release_id  as internal
          FROM sres.externaldatabase d
            , sres.externaldatabaserelease r
            , apidb.nafeaturelist fl
            , study.nodenodeset sl
            , study.nodeset s
          WHERE sl.protocol_app_node_id = fl.protocol_app_node_id
            AND sl.node_set_id=  s.node_set_id
            AND r.external_database_release_id = s.external_database_release_id
            AND d.external_database_id = r.external_database_id
        ]]>
      </sql>
    </sqlQuery>


  <sqlQuery name="geneListParam" isCacheable="false" >
    <paramRef ref="geneParams.geneListDataset" />
    <column name="term"/>
    <column name="internal"/>
    <sql>
      <![CDATA[
        select distinct replace(replace(pan.name,' (functional_data)',''), '(subcellular_localization)', '')  as term
          , pan.protocol_app_node_id as internal
        from study.protocolappnode pan, study.nodeset s, study.nodenodeset sl
          where s.external_database_release_id =$$geneListDataset$$
          and s.node_set_id = sl.node_set_id
          and sl.protocol_app_node_id = pan.protocol_app_node_id
          order by pan.protocol_app_node_id
      ]]>
    </sql>
  </sqlQuery>




   <sqlQuery name="lopitMethod" isCacheable="true" includeProjects="ToxoDB,TriTrypDB,UniDB">
     <paramRef ref="organismParams.organismWithLopitData"/>
     <column name="term"/>
     <column name="internal"/>
     <sql includeProjects="TriTrypDB">
      <![CDATA[
     SELECT CASE WHEN $$organismWithLopitData$$ = 'Trypanosoma brucei brucei TREU927'
                 THEN 'lopit Study hyperLopit'
                 WHEN $$organismWithLopitData$$ = 'Trypanosoma congolense IL3000'
                 THEN 'lopit Study hyperLopitTc'
                 END AS internal,
            'hyperLopit study' as term
       ]]>
    </sql>
     <sql includeProjects="ToxoDB">
      <![CDATA[
      select 'TAGM-MAP (default)' as term, 'TAGM-MAP-Final-Probability' as internal
      UNION
      select 'TAGM-MCMC (advanced)' as term, 'TAGM-MCMC-Joint-Probability' as internal
       ]]>
    </sql>
    <sql includeProjects="UniDB">
      <![CDATA[
     SELECT CASE WHEN $$organismWithLopitData$$ = 'Trypanosoma brucei brucei TREU927'
                 THEN 'lopit Study hyperLopit'
                 WHEN $$organismWithLopitData$$ = 'Trypanosoma congolense IL3000'
                 THEN 'lopit Study hyperLopitTc'
                 ELSE SELECT 'TAGM-MAP (default)' as term, 'TAGM-MAP-Final-Probability' as internal
                      UNION
                      SELECT 'TAGM-MCMC (advanced)' as term, 'TAGM-MCMC-Joint-Probability' as internal
                 END AS internal,
            'hyperLopit study' as term
       ]]>
    </sql>

  </sqlQuery>



   <sqlQuery name="lopitOntologyQuery" isCacheable="true" includeProjects="ToxoDB,TriTrypDB,UniDB">
     <paramRef ref="geneParams.lopit_method" />
     <column name="ontology_term_name"/>
     <column name="parent_ontology_term_name"/>
     <column name="display_name"/>
     <column name="description"/>
     <column name="type"/>
     <column name="units"/>
     <column name="precision"/>
     <column name="is_range"/>
    <sql>
      <![CDATA[
            SELECT 'Any compartments (lopit)' as ontology_term_name, cast(null as varchar(1)) as parent_ontology_term_name,'- Any compartments probability' as display_name, cast(null as varchar(1)) as description, cast(null as varchar(1)) as units,'number' as type,1 as is_range,1 as precision, cast(null as varchar(1)) as display_order
          UNION
            SELECT DISTINCT pan.name as ontology_term_name, cast(null as varchar(1)) as parent_ontology_term_name,
              CASE WHEN pan.name ='outlier (lopit)' THEN  CONCAT('- ', upper(substr(CONCAT(replace(pan.name,' (lopit)',''), ' probability'),1,1)), substr(CONCAT(replace(pan.name,' (lopit)',''), ' probability'),2,9999))
              ELSE CONCAT(upper(substr(CONCAT(replace(pan.name,' (lopit)',''), ' probability'),1,1)), substr(CONCAT(replace(pan.name,' (lopit)',''), ' probability'),2,9999)) END as display_name
              , cast(null as varchar(1)) as description, cast(null as varchar(1)) as units, 'number' as type,1 as is_range,1 as precision, cast(null as varchar(1)) as display_order
            FROM study.nodeset s , study.nodenodeset sl, study.ProtocolAppNode pan, apidb.LopitResults lr, apidbtuning.GeneAttributes ga
            WHERE s.name = $$lopit_method$$
              AND s.node_set_id = sl.node_set_id
              AND sl.protocol_app_node_id = pan.protocol_app_node_id
              AND pan.protocol_app_node_id = lr.protocol_app_node_id
              AND ga.na_feature_id = lr.na_feature_id
            ORDER BY display_name
        ]]>
    </sql>
   </sqlQuery>

    <sqlQuery name="lopitMetadataQuery" isCacheable="false" includeProjects="ToxoDB,TriTrypDB,UniDB">
      <paramRef ref="geneParams.lopit_method" />
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
        <![CDATA[
            SELECT ga.source_id as internal, pan.name as ontology_term_name, round(lr.probability_mean,2) as number_value, round(to_char(lr.probability_mean),2) as string_value, null::timestamp as date_value
            FROM study.nodeset s , study.nodenodeset sl, study.ProtocolAppNode pan, apidb.LopitResults lr, apidbtuning.GeneAttributes ga
            WHERE s.name in ($$lopit_method$$)
              AND s.node_set_id = sl.node_set_id
              AND sl.protocol_app_node_id = pan.protocol_app_node_id
              AND pan.protocol_app_node_id = lr.protocol_app_node_id
              AND ga.na_feature_id = lr.na_feature_id
          UNION
            SELECT ga.source_id as internal, 'Any compartments (lopit)' as ontology_term_name, round(lr.probability_mean,2) as number_value, round(to_char(lr.probability_mean),2) as string_value, null::timestamp as date_value
            FROM study.nodeset s , study.nodenodeset sl, study.ProtocolAppNode pan, apidb.LopitResults lr, apidbtuning.GeneAttributes ga
            WHERE s.name in ($$lopit_method$$)
              AND s.node_set_id = sl.node_set_id
              AND sl.protocol_app_node_id = pan.protocol_app_node_id
              AND pan.protocol_app_node_id = lr.protocol_app_node_id
              AND ga.na_feature_id = lr.na_feature_id
              AND pan.name  != 'outlier (lopit)'
        ]]>
      </sql>
    </sqlQuery>


    <sqlQuery name="MetadataQuery_ncraOR74A_phenotype_knockout_mutants_RSRC" doNotTest="1">
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
        <![CDATA[
            SELECT na_feature_id as internal
                 , 'conidia_number' as ontology_term_name
                 , null::numeric as number_value
                 , conidia_number as string_value
                 , null::numeric as date_value
            FROM APIDB.PHENOTYPEMUTANTS
          UNION
            SELECT na_feature_id as internal
                 , 'conidia_morphology' as ontology_term_name
                 , null::numeric as number_value
                 , conidia_morphology as string_value
                 , null::numeric as date_value
            FROM APIDB.PHENOTYPEMUTANTS
          UNION
            SELECT na_feature_id as internal
                 , 'protoperithecia_number' as ontology_term_name
                 , null::numeric as number_value
                 , protoperithecia_number as string_value
                 , null::numeric as date_value
            FROM APIDB.PHENOTYPEMUTANTS
          UNION
            SELECT na_feature_id as internal
                 , 'protoperithecial_morphology' as ontology_term_name
                 , null::numeric as number_value
                 , protoperithecial_morphology as string_value
                 , null::numeric as date_value
            FROM APIDB.PHENOTYPEMUTANTS
          UNION
            SELECT na_feature_id as internal
                 , 'perithecia_number' as ontology_term_name
                 , null::numeric as number_value
                 , perithecia_number as string_value
                 , null::numeric as date_value
            FROM APIDB.PHENOTYPEMUTANTS
          UNION
            SELECT na_feature_id as internal
                 , 'perithecia_morphology' as ontology_term_name
                 , null::numeric as number_value
                 , perithecia_morphology as string_value
                 , null::numeric as date_value
            FROM APIDB.PHENOTYPEMUTANTS
          UNION
            SELECT na_feature_id as internal
                 , 'ascospore_number' as ontology_term_name
                 , null::numeric as number_value
                 , ascospore_number as string_value
                 , null::numeric as date_value
            FROM APIDB.PHENOTYPEMUTANTS
          UNION
            SELECT na_feature_id as internal
                 , 'ascospore_morphology' as ontology_term_name
                 , null::numeric as number_value
                 , ascospore_morphology as string_value
                 , null::numeric as date_value
            FROM APIDB.PHENOTYPEMUTANTS
          UNION
            SELECT na_feature_id as internal
                 , 'basal_hyphae_growth_rate' as ontology_term_name
                 , basal_hyphae_growth_rate as number_value
                 , '' as string_value
                 , null::numeric as date_value
            FROM APIDB.PHENOTYPEMUTANTS
          UNION
            SELECT na_feature_id as internal
                 , 'aerial_hyphae_height' as ontology_term_name
                 , aerial_hyphae_height as number_value
                 , '' as string_value
                 , null::numeric as date_value
            FROM APIDB.PHENOTYPEMUTANTS
        ]]>
      </sql>
    </sqlQuery>

    <sqlQuery name="OntologyQuery_ncraOR74A_phenotype_knockout_mutants_RSRC" doNotTest="1">
      <column name="ontology_term_name"/>
      <column name="parent_ontology_term_name"/>
      <column name="display_name"/>
      <column name="description"/>
      <column name="type"/>
      <column name="units"/>
      <column name="precision"/>
      <column name="is_range"/>
      <sql>
        <![CDATA[
          SELECT *
          FROM (
                SELECT 'conidia_number' as ontology_term_name
                     , 'Conidia Number' as display_name
                     , 'string' as type
                     , 0 as is_range
              UNION
                SELECT 'conidia_morphology' as ontology_term_name
                     , 'Conidia Morphology' as display_name
                     , 'string' as type
                     , 0 as is_range
              UNION
                SELECT 'protoperithecia_number' as ontology_term_name
                     , 'Protoperithecia Number' as display_name
                     , 'string' as type
                     , 0 as is_range
              UNION
                SELECT 'protoperithecial_morphology' as ontology_term_name
                     , 'Protoperithecial Morphology' as display_name
                     , 'string' as type
                     , 0 as is_range
              UNION
                SELECT 'perithecia_number' as ontology_term_name
                     , 'Perithecia Number' as display_name
                     , 'string' as type
                     , 0 as is_range
              UNION
                SELECT 'perithecia_morphology' as ontology_term_name
                     , 'Perithecia Morphology' as display_name
                     , 'string' as type
                     , 0 as is_range
              UNION
                SELECT 'ascospore_number' as ontology_term_name
                     , 'Ascospore Number' as display_name
                     , 'string' as type
                     , 0 as is_range
              UNION
                SELECT 'ascospore_morphology' as ontology_term_name
                     , 'Ascospore Morphology' as display_name
                     , 'string' as type
                     , 0 as is_range
              UNION
                SELECT 'basal_hyphae_growth_rate' as ontology_term_name
                     , 'Basal Hyphae Growth Rate' as display_name
                     , 'Number' as type
                     , 1 as is_range
              UNION
                SELECT 'aerial_hyphae_height' as ontology_term_name
                     , 'Aerial Hyphae Height' as display_name
                     , 'Number' as type
                     , 1 as is_range
            ) t
            ,(
              SELECT cast(null as varchar(10)) as parent_ontology_term_name
               , cast(null as varchar(10)) as description
               , cast(null as varchar(10)) as units
               , 1 as precision
            ) t2
        ]]>
      </sql>
    </sqlQuery>


    <sqlQuery name="SignalpVersion" doNotTest="1">
      <column name="term"/>
      <column name="internal"/>
      <sql>
        <![CDATA[
          SELECT distinct algorithm_name as term, algorithm_name as internal
          FROM dots.signalPeptideFeature
          ORDER BY algorithm_name DESC
        ]]>
      </sql>
    </sqlQuery>


    <sqlQuery name="PhenotypeScoreDataset" doNotTest="1">
      <column name="term"/>
      <column name="internal"/>
      <sql>
        <![CDATA[
          SELECT distinct
            d.name as term
            , d.name as internal
          FROM sres.externaldatabase d
              , sres.externaldatabaserelease r
              , study.nodeset s
              , study.nodenodeset sl
              , apidb.phenotypescore ps
          WHERE d.external_database_id = r.external_database_id
            AND r.external_database_release_id = s.external_database_release_id
            AND s.node_set_id = sl.node_set_id
            AND sl.protocol_app_node_id = ps.protocol_app_node_id
        ]]>
      </sql>
    </sqlQuery>

	<sqlQuery name="PhenotypeDataset" doNotTest="1">
          <column name="term"/>
          <column name="internal"/>
          <column name="display_name"/>
          <sql>
           <![CDATA[ SELECT p.dataset_presenter_id as internal
                          , p.name as term
                          , p.display_name as display_name
                     FROM apidbtuning.datasetmodelref r
                        , apidbtuning.datasetpresenter p
                     WHERE r.target_name LIKE '%GenesByPhenotypeEdaSubset%'
                     AND r.dataset_presenter_id = p.dataset_presenter_id
                    ]]>
          </sql>
        </sqlQuery>


    <sqlQuery name="MetadataQuery_PhenotypeScore" doNotTest="1">
      <paramRef ref="geneParams.phenotypeScoreDataset"/>
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
        <![CDATA[
          SELECT ps.na_feature_id as internal
               , pan.name as ontology_term_name
               , CASE WHEN sl.name = 'pknoA1H1_phenotype_piggyBac_mutagenesis_MIS_MFS_RSRC' AND score_type like 'mutability%'
                        THEN null::NUMERIC
                        ELSE score
                   END as number_value
               , CASE WHEN sl.name = 'pknoA1H1_phenotype_piggyBac_mutagenesis_MIS_MFS_RSRC' AND score_type like 'mutability%'
                        THEN CASE when score = 0 then 'mutable' when score = 1 then 'nonmutable' else 'not_determined' end
                        ELSE null::varchar(10)
                   END as string_value
               , null::numeric as date_value
          FROM apidb.PhenotypeScore ps
             , study.protocolappnode pan
             , (SELECT DISTINCT sl.protocol_app_node_id, d.name
                FROM study.nodeset s
                   , study.nodenodeset sl
                   , sres.externaldatabase d
                   , sres.externaldatabaserelease r
                WHERE d.name = '$$phenotypeScoreDataset$$'
                  and d.external_database_id = r.external_database_id
                  and r.external_database_release_id = s.external_database_release_id
                  and s.node_set_id = sl.node_set_id
             ) sl
          WHERE ps.protocol_app_node_id = pan.protocol_app_node_id
            AND pan.protocol_app_node_id = sl.protocol_app_node_id
        ]]>
      </sql>
    </sqlQuery>

    <sqlQuery name="OntologyQuery_PhenotypeScore" doNotTest="1">
      <paramRef ref="geneParams.phenotypeScoreDataset"/>
      <column name="ontology_term_name"/>
      <column name="parent_ontology_term_name"/>
      <column name="display_name"/>
      <column name="description"/>
      <column name="type"/>
      <column name="units"/>
      <column name="precision"/>
      <column name="is_range"/>
      <sql>
        <![CDATA[
          SELECT DISTINCT pan.name as ontology_term_name
                  , cast(null as varchar(10)) as parent_ontology_term_name
                  , regexp_replace(pan.name, ' \(phenotype\)$', '')  as display_name
                  , p.score_type  as description
                  , cast(null as varchar(10)) as units
                  , CASE WHEN sl.name = 'pknoA1H1_phenotype_piggyBac_mutagenesis_MIS_MFS_RSRC' AND p.score_type like 'mutability%'
                           THEN 'string'
                      ELSE 'number' END as type
                  , CASE WHEN sl.name = 'pknoA1H1_phenotype_piggyBac_mutagenesis_MIS_MFS_RSRC' AND p.score_type like 'mutability%'
                           THEN 0
                      ELSE 1 END as is_range
                  , 1 as precision
          FROM apidb.phenotypescore p
            , study.protocolappnode pan
            , (
              SELECT distinct sl.protocol_app_node_id, d.name
              FROM study.nodeset s
                 , study.nodenodeset sl
                 , sres.externaldatabase d
                 , sres.externaldatabaserelease r
              WHERE d.name = '$$phenotypeScoreDataset$$'
                AND d.external_database_id = r.external_database_id
                AND r.external_database_release_id = s.external_database_release_id
                AND s.node_set_id = sl.node_set_id
            ) sl
          WHERE p.protocol_app_node_id = pan.protocol_app_node_id
            and pan.protocol_app_node_id = sl.protocol_app_node_id
          ORDER by pan.name
        ]]>
      </sql>
    </sqlQuery>

    <sqlQuery name="MetadataQuery_pberANKA_phenotype_Bushnell_functional_profiling_RSRC" doNotTest="1">
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
        <![CDATA[
          SELECT na_feature_id as internal
               , 'phenotype' as ontology_term_name
               , null::numeric as number_value
               , phenotype as string_value
               , null::numeric as date_value
          FROM APIDB.PHENOTYPEGROWTHRATE
          UNION
          SELECT na_feature_id as internal
               , 'relative_growth_rate' as ontology_term_name
               , relative_growth_rate as number_value
               , '' as string_value
               , null::numeric as date_value
          FROM APIDB.PHENOTYPEGROWTHRATE
        ]]>
      </sql>
    </sqlQuery>


    <sqlQuery name="OntologyQuery_pberANKA_phenotype_Bushnell_functional_profiling_RSRC" doNotTest="1">
      <column name="ontology_term_name"/>
      <column name="parent_ontology_term_name"/>
      <column name="display_name"/>
      <column name="description"/>
      <column name="type"/>
      <column name="units"/>
      <column name="precision"/>
      <column name="is_range"/>
      <sql>
        <![CDATA[
          SELECT *
          FROM (
              SELECT 'phenotype' as ontology_term_name
                   , 'Phenotype' as display_name
                   , 'string' as type
                   , 0 as is_range
              UNION
              SELECT 'relative_growth_rate' as ontology_term_name
                   , 'Relative Growth Rate' as display_name
                   , 'Number' as type
                   , 1 as is_range
            ) t
            ,(
              SELECT cast(null as varchar(10)) as parent_ontology_term_name
                   , cast(null as varchar(10)) as description
                   , cast(null as varchar(10)) as units
                   , 1 as precision
            ) t2
        ]]>
      </sql>
    </sqlQuery>


    <sqlQuery name="MetadataQuery_ncraOR74A_phenotype_GeneImage_NAFeaturePhenotypeImage_RSRC" doNotTest="1">
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
        <![CDATA[
          SELECT DISTINCT p.protocol_app_node_id as internal
              , p.property as ontology_term_name
              , null::numeric as number_value
              , lower(p.value) as string_value
              , cast(null as timestamp) as date_value
          FROM apidb.nafeaturephenotype p, study.nodeset s, study.nodenodeset sl
          WHERE s.name = 'ncraOR74A_phenotype_GeneImage_NAFeaturePhenotypeImage_RSRC'
            AND s.node_set_id = sl.node_set_id
            AND sl.protocol_app_node_id = p.protocol_app_node_id
        ]]>
      </sql>
    </sqlQuery>


    <sqlQuery name="OntologyQuery_ncraOR74A_phenotype_GeneImage_NAFeaturePhenotypeImage_RSRC" doNotTest="1">
      <column name="ontology_term_name"/>
      <column name="parent_ontology_term_name"/>
      <column name="display_name"/>
      <column name="description"/>
      <column name="type"/>
      <column name="units"/>
      <column name="precision"/>
      <column name="is_range"/>
      <sql>
        <![CDATA[
          SELECT distinct p.property as ontology_term_name
              , cast(null as varchar(10)) as parent_ontology_term_name
              , initcap(p.property) as display_name
              , cast(null as varchar(10)) as description
              , cast(null as varchar(10)) as units
              , 'string' as type
              , 0 as is_range
              , 1 as precision
          FROM apidb.nafeaturephenotype p, study.nodeset s, study.nodenodeset sl
          WHERE s.name = 'ncraOR74A_phenotype_GeneImage_NAFeaturePhenotypeImage_RSRC'
            AND s.node_set_id = sl.node_set_id
            AND sl.protocol_app_node_id = p.protocol_app_node_id
          ORDER BY initcap(p.property)
        ]]>
      </sql>
    </sqlQuery>


    <sqlQuery name="MetadataQuery_PHI-base_curated_phenotype_NAFeaturePhenotypeGeneric_RSRC" doNotTest="1">
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
        <![CDATA[
          SELECT distinct p.protocol_app_node_id as internal
              , p.property as ontology_term_name
              , null::numeric as number_value
              , p.value as string_value
              , cast(null as timestamp) as date_value
          FROM apidb.nafeaturephenotype p, study.nodeset s, study.nodenodeset sl
          WHERE s.name like '%_PHI-base_curated_phenotype_NAFeaturePhenotypeGeneric_RSRC'
            AND s.node_set_id = sl.node_set_id
            AND sl.protocol_app_node_id = p.protocol_app_node_id
            AND p.property NOT IN ('Co-mutated gene(s)','Gene inducer','PHI-base entry','PMID')
            AND p.property  NOT like 'Comments%'
        ]]>
      </sql>
    </sqlQuery>


    <sqlQuery name="OntologyQuery_PHI-base_curated_phenotype_NAFeaturePhenotypeGeneric_RSRC" doNotTest="1">
      <column name="ontology_term_name"/>
      <column name="parent_ontology_term_name"/>
      <column name="display_name"/>
      <column name="description"/>
      <column name="type"/>
      <column name="units"/>
      <column name="precision"/>
      <column name="is_range"/>
      <sql>
        <![CDATA[
          SELECT distinct p.property as ontology_term_name
              , cast(null as varchar(10)) as parent_ontology_term_name
              , initcap(p.property) as display_name
              , cast(null as varchar(10)) as description
              , cast(null as varchar(10)) as units
              , 'string' as type
              , 0 as is_range
              , 1 as precision
          FROM apidb.nafeaturephenotype p, study.nodeset s, study.nodenodeset sl
          WHERE s.name like '%_PHI-base_curated_phenotype_NAFeaturePhenotypeGeneric_RSRC'
            AND s.node_set_id = sl.node_set_id
            AND sl.protocol_app_node_id = p.protocol_app_node_id
            AND p.property NOT IN ('Co-mutated gene(s)','Gene inducer','PHI-base entry','PMID')
            AND p.property  NOT like 'Comments%'
          ORDER BY initcap(p.property)
        ]]>
      </sql>
    </sqlQuery>

    <sqlQuery name="PhenotypeGrowthRate" isCacheable="false" includeProjects="UniDB,PlasmoDB">
      <column name="internal" />
      <column name="term" />
      <sql>
        select distinct phenotype as term , phenotype as internal from APIDB.PHENOTYPEGROWTHRATE
      </sql>
    </sqlQuery>


       <sqlQuery name="geneListUserDataset" isCacheable="false">
        <paramRef ref="InternalParams.user_id"/>
            <column name="internal" />
            <column name="term" />
            <column name="display" />
        <sql>
   --force 'Choose...' line to be first, then order by display name
   select  term, internal, display from (
     select 'bla' as term, '1111' as internal, 'Choose a Gene List Dataset, if you have any' as display, 1 as num
     UNION
     select distinct aud.user_dataset_id as term, aud.user_dataset_id as internal, aud.name as display, 2 as num
      from @VDI_CONTROL_SCHEMA@.AvailableUserDatasets aud,
           @VDI_DATASETS_SCHEMA@.UD_GeneId g
      where aud.user_id = $$user_id$$
      and g.user_dataset_id = aud.user_dataset_id
   ) order by num, display
       </sql>
       </sqlQuery>

        <sqlQuery name="RnaSeqUserDataset" isCacheable="false">
          <paramRef ref="InternalParams.user_id"/>
          <column name="internal"/>
          <column name="term"/>
          <column name="display"/>
          <sql>
            <![CDATA[
              SELECT
                aud.user_dataset_id as term
              , aud.user_dataset_id as internal
              , aud.name as display
              FROM
                @VDI_CONTROL_SCHEMA@.availableuserdatasets aud
              WHERE
                user_id = $$user_id$$
                AND exists(
                  SELECT 1
                  FROM
                    @VDI_DATASETS_SCHEMA@.ud_profileset ps
                    INNER JOIN @VDI_DATASETS_SCHEMA@.ud_protocolappnode pan
                      ON ps.profile_set_id = pan.profile_set_id
                    INNER JOIN @VDI_DATASETS_SCHEMA@.ud_nafeatureexpression nfe
                      ON pan.protocol_app_node_id = nfe.protocol_app_node_id
                  WHERE
                    ps.user_dataset_id = aud.user_dataset_id
                )
              ORDER BY display
            ]]>
          </sql>
        </sqlQuery>

        <sqlQuery name="StrandedRnaSeqUserDataset" isCacheable="false">
           <paramRef ref="InternalParams.user_id"/>
           <column name="internal"/>
           <column name="term"/>
           <column name="display"/>
           <sql>
           <![CDATA[
   select term, internal, display
   from (  select da.user_dataset_id as term, da.user_dataset_id as internal,
                  dm.name as display, 2 as ordering
           from @VDI_CONTROL_SCHEMA@.availableUserDatasets da,
                @VDI_CONTROL_SCHEMA@.dataset_meta dm
           where iud.user_dataset_id
                 in (select udac.user_dataset_id
                     from @VDI_DATASETS_SCHEMA@.UserDatasetAccessControl udac,
                          @VDI_DATASETS_SCHEMA@.UD_ProfileSet ps,
                          @VDI_DATASETS_SCHEMA@.UD_ProtocolAppNode pan,
                          @VDI_DATASETS_SCHEMA@.UD_NaFeatureExpression nfe
                     where udac.user_id = $$user_id$$ -- enforce dataset access
                       and udac.user_dataset_id = ps.user_dataset_id
                       and ps.profile_set_id = pan.profile_set_id
                       and ps.name = 'sense'
                       and pan.protocol_app_node_id = nfe.protocol_app_node_id
                    )
             and (iud.is_invalid is null or iud.is_invalid = 0)
        ) order by ordering, display
             ]]>
           </sql>
        </sqlQuery>

    <sqlQuery name="PFTimeSeriesFoldChangeProfileSet" includeProjects="PlasmoDB,UniDB">
      <column name="internal" />
      <column name="term" />
      <column name="display" />
      <sql>
        SELECT DISTINCT pt.profile_set_name as term,
          pt.profile_study_id as internal,
          replace((replace (pt.profile_set_name,'DeRisi','iRBC')),'Smoothed','(48 Hour scaled)')  as display
        FROM apidbtuning.profiletype pt
        WHERE pt.profile_set_name in ('DeRisi 3D7 Smoothed','DeRisi Dd2 Smoothed','DeRisi HB3 Smoothed')
        ORDER BY pt.profile_set_name desc
      </sql>
    </sqlQuery>



    <sqlQuery name="PFTimeSeriesSamples" includeProjects="PlasmoDB,UniDB">
      <paramRef ref="geneParams.profileset_generic"/>
      <column name="parentTerm" />
      <column name="internal" />
      <column name="display" />
      <column name="term" />
      <sql>
        <![CDATA[
          SELECT display, term, internal, parentTerm, sortTerm
          FROM (
              SELECT
                CONCAT(r.value , ' Hour' ) as display
                , CONCAT(r.value , ' Hour' ) as term
                , string_agg(ps.protocol_app_node_id::text, ',' order by ps.protocol_app_node_id) as internal
                , CASE WHEN r.value > 0 AND r.value <= 8 THEN 'Early Ring'
                       WHEN r.value > 8 AND r.value <= 16 THEN 'Late Ring'
                       WHEN r.value > 16 AND r.value <= 23 THEN 'Early Trophozoite'
                       WHEN r.value > 23 AND r.value <= 30 THEN 'Late Trophozoite'
                       WHEN r.value > 30 AND r.value <= 39 THEN 'Early Schizont'
                  ELSE 'Late Schizont' END as parentTerm
                , r.value::numeric as sortTerm
              FROM APIDBTUNING.profilesamples ps
               , apidbtuning.profilesamples tpps
               , APIDB.ONTOLOGYTERMRESULT r
               , sres.ontologyterm ot
              WHERE ps.study_id =  $$profileset_generic$$
                AND tpps.study_name = (
                  CASE ps.study_name
                  WHEN 'DeRisi 3D7 Smoothed' THEN 'Timepoint Mapping And Life Stage Fractions - 3D7'
                  WHEN 'DeRisi HB3 Smoothed' THEN 'Timepoint Mapping And Life Stage Fractions - HB3'
                  WHEN 'DeRisi Dd2 Smoothed' THEN 'Timepoint Mapping And Life Stage Fractions - Dd2'
                  ELSE NULL END
                )
                AND ps.PROTOCOL_APP_NODE_NAME = tpps.PROTOCOL_APP_NODE_NAME
                AND tpps.PROTOCOL_APP_NODE_ID = r.PROTOCOL_APP_NODE_ID
                AND r.ONTOLOGY_TERM_ID = ot.ONTOLOGY_TERM_ID
                AND ot.name = 'timepoint'
                AND ps.PROFILE_TYPE = 'values'
              GROUP BY r.value
            UNION
              SELECT '1-16 Hours' as display, 'Ring' as term, '-1' as internal, '' as parentTerm, -3 as sortTerm
            UNION
              SELECT '1-8 Hours' as display, 'Early Ring' as term, '-1' as internal, 'Ring' as parentTerm, -2 as sortTerm
            UNION
              SELECT '9-16 Hours' as display, 'Late Ring' as term, '-1' as internal, 'Ring' as parentTerm, -1 as sortTerm
            UNION
              SELECT '17-30 Hours' as display, 'Trophozoite' as term, '-1' as internal, '' as parentTerm, -2 as sortTerm
            UNION
              SELECT '17-23 Hours' as display, 'Early Trophozoite' as term, '-1' as internal, 'Trophozoite' as parentTerm, -2 as sortTerm
            UNION
              SELECT '24-30 Hours' as display, 'Late Trophozoite' as term, '-1' as internal, 'Trophozoite' as parentTerm, -1 as sortTerm
            UNION
              SELECT '31-48 Hours' as display, 'Schizont' as term, '-1' as internal, '' as parentTerm, -1 as sortTerm
            UNION
              SELECT '31-39 Hours' as display, 'Early Schizont' as term, '-1' as internal, 'Schizont' as parentTerm, -2 as sortTerm
            UNION
              SELECT '40-48 Hours' as display, 'Late Schizont' as term, '-1' as internal, 'Schizont' as parentTerm, -1 as sortTerm
          ) t
          ORDER BY sortTerm
        ]]>
      </sql>
    </sqlQuery>


    <sqlQuery name="PFTimeSeriesSamplesPct" includeProjects="PlasmoDB,UniDB">
      <paramRef ref="geneParams.profileset_generic"/>
      <paramRef ref="geneParams.channel"/>
      <column name="parentTerm" />
      <column name="internal" />
      <column name="display" />
      <column name="term" />
      <sql>
        <![CDATA[
          SELECT display, term,internal,parentTerm,sortTerm
          FROM (
              SELECT CONCAT(r.value , ' Hour' ) as display
                , CONCAT(r.value , ' Hour' ) as term
                , string_agg(ps.protocol_app_node_id::text, ',' ORDER BY ps.protocol_app_node_id) as internal
                , CASE WHEN r.value > 0 AND r.value <= 8 THEN 'Early Ring'
                       WHEN r.value > 8 AND r.value <= 16 THEN 'Late Ring'
                       WHEN r.value > 16 AND r.value <= 23 THEN 'Early Trophozoite'
                       WHEN r.value > 23 AND r.value <= 30 THEN 'Late Trophozoite'
                       WHEN r.value > 30 AND r.value <= 39 THEN 'Early Schizont'
                  ELSE 'Late Schizont' END as parentTerm
                , r.value::numeric as sortTerm
              FROM APIDBTUNING.profilesamples ps
               , apidbtuning.profilesamples tpps
               , APIDB.ONTOLOGYTERMRESULT r
               , sres.ontologyterm ot
              WHERE ps.study_id =  $$profileset_generic$$
                AND tpps.study_name = (
                  CASE ps.study_name
                  WHEN 'DeRisi 3D7 Smoothed' THEN 'Timepoint Mapping And Life Stage Fractions - 3D7'
                  WHEN 'DeRisi HB3 Smoothed' THEN 'Timepoint Mapping And Life Stage Fractions - HB3'
                  WHEN 'DeRisi Dd2 Smoothed' THEN 'Timepoint Mapping And Life Stage Fractions - Dd2'
                  ELSE NULL END
                )
                AND ps.PROTOCOL_APP_NODE_NAME = tpps.PROTOCOL_APP_NODE_NAME
                AND tpps.PROTOCOL_APP_NODE_ID = r.PROTOCOL_APP_NODE_ID
                AND r.ONTOLOGY_TERM_ID = ot.ONTOLOGY_TERM_ID
                AND ot.name = 'timepoint'
                AND ps.PROFILE_TYPE = 'values'
              GROUP BY r.value
            UNION
              select '1-16 Hours' as display, 'Ring' as term, '-1' as internal, '' as parentTerm, -3 as sortTerm
            UNION
              select '1-8 Hours' as display, 'Early Ring' as term, '-1' as internal, 'Ring' as parentTerm, -2 as sortTerm
            UNION
              select '9-16 Hours' as display, 'Late Ring' as term, '-1' as internal, 'Ring' as parentTerm, -1 as sortTerm
            UNION
              select '17-30 Hours' as display, 'Trophozoite' as term, '-1' as internal, '' as parentTerm, -2 as sortTerm
            UNION
              select '17-23 Hours' as display, 'Early Trophozoite' as term, '-1' as internal, 'Trophozoite' as parentTerm, -2 as sortTerm
            UNION
              select '24-30 Hours' as display, 'Late Trophozoite' as term, '-1' as internal, 'Trophozoite' as parentTerm, -1 as sortTerm
            UNION
              select '31-48 Hours' as display, 'Schizont' as term, '-1' as internal, '' as parentTerm, -1 as sortTerm
            UNION
              select '31-39 Hours' as display, 'Early Schizont' as term, '-1' as internal, 'Schizont' as parentTerm, -2 as sortTerm
            UNION
              select '40-48 Hours' as display, 'Late Schizont' as term, '-1' as internal, 'Schizont' as parentTerm, -1 as sortTerm
          ) t
          ORDER BY sortTerm
        ]]>
      </sql>
    </sqlQuery>


    <sqlQuery name="GenericSamplesMulti" includeProjects="PlasmoDB,UniDB">

      <column name="internal"/>
      <column name="term"/>
      <column name="display"/>
      <sql>
        <![CDATA[
          SELECT distinct pan_name as term, pan_name as display, pan_id as internal
          FROM apidbTuning.Metadata
          WHERE lower(dataset_name) like '%icemr%'
	    ]]>
      </sql>
    </sqlQuery>



    <sqlQuery name="NonNuclearSequence" includeProjects="AmoebaDB,PlasmoDB,ToxoDB,FungiDB,HostDB,PiroplasmaDB,VectorBase,UniDB">
      <paramRef ref="organismParams.org_with_nonnuclear_genes" />
      <column name="internal"/>
      <column name="term"/>
      <column name="display"/>
      <sql>
        <![CDATA[
          SELECT sa.source_id as internal, sa.source_id as term, CONCAT(sa.source_id , ' - ' , ot.name ) as display
          FROM  webready.GenomicSeqAttributes_p sa, SRes.ontologyTerm ot
          WHERE sa.so_id = ot.source_id
            AND ot.name in  ('mitochondrial_chromosome', 'apicoplast_chromosome')
            AND sa.org_abbrev = $$org_with_nonnuclear_genes$$
            AND sa.source_id IN (SELECT sequence_id FROM webready.TranscriptAttributes_p where org_abbrev = $$org_with_nonnuclear_genes$$)
          ORDER BY display
	    ]]>
      </sql>
    </sqlQuery>


    <sqlQuery name="ProfileTimeNoShift">
      <column name="internal"/>
      <column name="term"/>
      <column name="display"/>
      <sql>
        SELECT 0 as internal, 0 as term, 0 as display
      </sql>
    </sqlQuery>


    <sqlQuery name="ProfileTimeShift_CryptoRTPCR" includeProjects="CryptoDB,UniDB">
      <column name="internal"/>
      <column name="term"/>
      <column name="display"/>
      <sql>
        <![CDATA[
          SELECT num AS internal, CONCAT(num ,' hours' ) as term, CONCAT(num ,' hours' ) as display
          FROM (
            SELECT generate_series(-36, 36, 12) num
          ) t
          ORDER BY t.num asc
        ]]>
      </sql>
    </sqlQuery>



    <sqlQuery name="ProfileTimeShift_Toxo" includeProjects="ToxoDB,UniDB">
      <column name="internal"/>
      <column name="term"/>
      <column name="display"/>
      <sql>
        <![CDATA[
	      SELECT num AS internal, CONCAT(num ,' hours' ) as term, CONCAT(num ,' hours' ) as display
          FROM (
            SELECT generate_series(-6, 6, 1) num
          ) t
          ORDER BY t.num asc
        ]]>
      </sql>

    </sqlQuery>

    <sqlQuery name="ProfileTimeShift" includeProjects="MicrosporidiaDB,PlasmoDB,ToxoDB,CryptoDB,FungiDB,HostDB,UniDB">
      <column name="internal"/>
      <column name="term"/>
      <column name="display"/>
      <sql includeProjects="PlasmoDB,UniDB">
        <![CDATA[
          SELECT num AS internal, CONCAT(num ,' hours' ) as term, CONCAT(num ,' hours' ) as display
          FROM (
              SELECT generate_series(-24, 24, 1) num
            ) t
          ORDER BY t.num asc
        ]]>
      </sql>
      <sql includeProjects="ToxoDB">
        <![CDATA[
	      SELECT num AS internal, CONCAT(num ,' hours' ) as term, CONCAT(num ,' hours' ) as display
          FROM (
              SELECT generate_series(-6, 6, 1) num
            ) t
          ORDER BY t.num asc
        ]]>
      </sql>
      <sql includeProjects="CryptoDB">
        <![CDATA[
          SELECT num AS internal, CONCAT(num ,' hours' ) as term, CONCAT(num ,' hours' ) as display
          FROM (
            SELECT generate_series(-36, 36, 12) num
          ) t
          ORDER BY t.num asc
        ]]>
      </sql>

      <sql includeProjects="FungiDB">
        <![CDATA[
          SELECT num AS internal, CONCAT(num ,' hours' ) as term, CONCAT(num ,' hours' ) as display
          FROM (
            SELECT generate_series(-12, 12, 12) num
          ) t
          ORDER BY t.num asc
          ]]>
      </sql>
      <sql includeProjects="HostDB,MicrosporidiaDB">
        SELECT 0 as internal, 0 as term, 0 as display
      </sql>

    </sqlQuery>



    <sqlQuery name="ProfileTimeShiftFerdig" includeProjects="PlasmoDB,UniDB">
      <column name="internal"/>
      <column name="term"/>
      <column name="display"/>
      <sql>
        <![CDATA[
	      SELECT num AS internal, CONCAT(num ,' hours' ) as term, CONCAT(num ,' hours' ) as display
          FROM (
              SELECT generate_series(-18, 18, 1) num
            ) t
          ORDER BY t.num asc
        ]]>
      </sql>
    </sqlQuery>


    <sqlQuery name="ProfileTimeShiftFungiScer" includeProjects="FungiDB,UniDB">
      <column name="internal"/>
      <column name="term"/>
      <column name="display"/>
      <sql>
        <![CDATA[
	      SELECT num AS internal, CONCAT(num ,' hours' ) as term, CONCAT(num ,' hours' ) as display
          FROM (
              SELECT generate_series(-25, 25, 1) num
            ) t
          ORDER BY t.num asc
        ]]>
      </sql>
    </sqlQuery>



    <sqlQuery name="ProfileTimeShiftFungiNcrass" includeProjects="FungiDB,UniDB">
      <column name="internal"/>
      <column name="term"/>
      <column name="display"/>
      <sql>
        <![CDATA[
	      SELECT num AS internal, CONCAT(num ,' hours' ) as term, CONCAT(num ,' hours' ) as display
          FROM (
              SELECT generate_series(-48 48, 1) num
            ) t
          ORDER BY t.num asc
        ]]>
      </sql>
    </sqlQuery>



    <sqlQuery name="ProfileTimeShiftBirkholtzGametocyte" includeProjects="PlasmoDB,UniDB">
      <column name="internal"/>
      <column name="term"/>
      <column name="display"/>
      <sql>
        <![CDATA[
	      SELECT 0 AS internal, '0 hours' AS term, '0 hours' AS display
        ]]>
      </sql>
    </sqlQuery>



    <sqlQuery name="ProfileProfileSet_CryptoRTPCR" includeProjects="CryptoDB,UniDB">
      <column name="display"/>
      <column name="internal"/>
      <column name="term"/>
      <sql>
        SELECT
          'Cparvum_RT_PCR_Kissinger' as term,
          'Cparvum_RT_PCR_Kissinger' as internal,
          'C. parvum post-infection semi quantitative Real Time PCR' as display
      </sql>
    </sqlQuery>



    <sqlQuery name="ProfileProfileSet_Toxo" includeProjects="ToxoDB,UniDB">
      <column name="display"/>
      <column name="internal"/>
      <column name="term"/>
      <sql>
        select
          'M.White Cell Cycle Microarray spline smoothed' as term,
          'M.White Cell Cycle Microarray spline smoothed' as internal,
          'M.White Cell Cycle Microarray spline smoothed' as display
      </sql>
    </sqlQuery>



    <sqlQuery name="ProfileProfileSet" includeProjects="ToxoDB,CryptoDB,MicrosporidiaDB,PlasmoDB,FungiDB,HostDB,UniDB">
      <column name="display"/>
      <column name="internal"/>
      <column name="term"/>
      <sql includeProjects="ToxoDB">
        select
          'M.White Cell Cycle Microarray spline smoothed' as term,
          'M.White Cell Cycle Microarray spline smoothed' as internal,
          'M.White Cell Cycle Microarray spline smoothed' as display
      </sql>
      <sql includeProjects="CryptoDB">
        SELECT
          'Cparvum_RT_PCR_Kissinger' as term,
          'Cparvum_RT_PCR_Kissinger' as internal,
          'C. parvum post-infection semi quantitative Real Time PCR' as display
      </sql>
      <sql includeProjects="PlasmoDB,UniDB">
        SELECT DISTINCT profile_set_name as term,
          profile_set_name as internal,
          profile_set_name as display
        FROM apidbTuning.profile
        WHERE profile_set_name like 'DeRisi % Smoothed'
      </sql>
      <sql includeProjects="FungiDB">
        SELECT DISTINCT profile_set_name as term,
          profile_set_name AS internal,
          REGEXP_REPLACE (profile_set_name, '\[(.)+\]', '')  AS display
        FROM apidbtuning.profiletype
        WHERE dataset_name = 'cneoH99_Haase_Kelliher_Cell_Cycle_rnaSeq_RSRC'
      </sql>
      <sql includeProjects="HostDB">
        SELECT DISTINCT profile_set_name,
          profile_set_name AS internal,
          REGEXP_REPLACE (profile_set_name, '\[(.)+\]', '')  AS display
        FROM apidbtuning.profiletype
        WHERE dataset_name = 'mmusC57BL6J_Saeij_Jeroen_strains_rnaSeq_RSRC'
      </sql>
      <sql includeProjects="MicrosporidiaDB">
        SELECT DISTINCT profile_set_name as term,
          profile_set_name AS internal,
          REGEXP_REPLACE (profile_set_name, '\[(.)+\]', '')  AS display
        FROM apidbtuning.profiletype
        WHERE dataset_name ='nparERTm1_Troemel_Time_Course_ebi_rnaSeq_RSRC'
      </sql>
    </sqlQuery>



    <sqlQuery name="ProfileProfileSetFerdig" includeProjects="PlasmoDB,UniDB">
      <column name="display"/>
      <column name="internal"/>
      <column name="term"/>
      <sql>
        SELECT
          'Profiles of DD2-HB3 expression from Ferdig' as term,
          'Profiles of DD2-HB3 expression from Ferdig' as internal,
          'Profiles of DD2-HB3 expression from Ferdig' as display
      </sql>
    </sqlQuery>


    <sqlQuery name="ProfileProfileSetBirkholtzGametocyte" includeProjects="PlasmoDB,UniDB">
      <column name="display"/>
      <column name="internal"/>
      <column name="term"/>
      <sql>
        select
          'Pfal3D7 Gametocyte time course' as term,
          'Pfal3D7 Gametocyte time course' as internal,
          'Pfal3D7 Gametocyte time course' as display
      </sql>
    </sqlQuery>



    <sqlQuery name="ProfileProfileSetFungiScer" includeProjects="FungiDB,UniDB">
      <column name="display"/>
      <column name="internal"/>
      <column name="term"/>
      <sql>
        SELECT DISTINCT profile_set_name as term,
          profile_set_name AS internal,
          REGEXP_REPLACE (profile_set_name, '\[(.)+\]', '')  AS display
        FROM apidbtuning.profiletype
        WHERE dataset_name = 'scerS288c_Haase_Kelliher_Cell_Cycle_rnaSeq_RSRC'
      </sql>
    </sqlQuery>


    <sqlQuery name="ProfileProfileSetFungiNcrass" includeProjects="FungiDB,UniDB">
      <column name="display"/>
      <column name="internal"/>
      <column name="term"/>
      <sql>
        SELECT DISTINCT profile_set_name as term,
          profile_set_name AS internal,
          REGEXP_REPLACE (profile_set_name, '\[(.)+\]', '')  AS display
        FROM apidbtuning.profiletype
        WHERE dataset_name = 'scerS288c_Haase_Kelliher_Cell_Cycle_ebi_rnaSeq_RSRC'
      </sql>
    </sqlQuery>



    <sqlQuery name="regulatedDirection"  >
      <column name="internal" />
      <column name="term" />
      <sql>
        SELECT 'up or down regulated' as term, 'abs' as internal
        UNION
        SELECT 'down-regulated' as term, '-' as internal
        UNION
        SELECT 'up-regulated' as term, '+' as internal
      </sql>
    </sqlQuery>

    <sqlQuery name="hardFloor">
      <paramRef ref="geneParams.profileset_generic"/>
      <column name="internal" />
      <column name="term" />
      <column name="display" />
      <sql>
        SELECT * FROM (
          SELECT '1' as term, '1' as internal, '1' as display, 1 as num
          UNION
          SELECT '0.1' as term, '0.1' as internal, '0.1' as display, 2 as num
          UNION
          SELECT '0.01' as term, '0.01' as internal, '0.01' as display, 3 as num
          UNION
          SELECT '0' as term, '0' as internal, '0' as display, 4 as num
          UNION
          SELECT '0.0000001' as term, '0.0000001' as internal, '0.0000001' as display, 5 as num
        ) t
        ORDER BY num
      </sql>
    </sqlQuery>

    <sqlQuery name="hardFloorRnaSeq" >
      <paramRef ref="geneParams.profileset_generic"/>
      <column name="internal" />
      <column name="term" />
      <column name="display" />
      <sql>
        WITH floor AS (
          SELECT min(coalesce(power(10,7) * stats.avg_transcript_length / stats.avg_unique_reads, 0)) as value
          FROM
            study.nodeset s,
             ( select oa.avg_transcript_length, rs.avg_unique_reads, rs.study_id
               from apidbTuning.OrganismAttributes oa
               , webready.RnaSeqStats_p rs
               where rs.taxon_id = oa.component_taxon_id
            ) stats
         WHERE s.node_set_id= stats.study_id
         AND s.node_set_id in ($$profileset_generic$$)
        )
        SELECT *
        FROM (
          SELECT '10 reads' as display, f.value as term, f.value as internal, 1 as num
          FROM floor f
          UNION
          SELECT '5 reads' as display, f.value/2 as term, f.value/2 as internal, 2 as num
          FROM floor f
          UNION
          SELECT '20 reads' as display, f.value*2 as term, f.value*2 as internal, 3 as num
          FROM floor f
          UNION
          SELECT '50 reads' as display, f.value*5 as term, f.value*5 as internal, 4 as num
          FROM floor f
          UNION
          SELECT '100 reads' as display, f.value*10 as term, f.value*10 as internal, 5 as num
          FROM floor f
        ) t
        ORDER BY num
      </sql>
    </sqlQuery>


    <sqlQuery name="antisenseFloor" >
      <paramRef ref="geneParams.samples_comp_antisense"/>
      <column name="internal" />
      <column name="term" />
      <column name="display" />
      <sql>
        WITH tpm AS (
          SELECT coalesce(round((power(10,10)/(num_reads * tx_length))::numeric, 2), 1) as value
          FROM (
            SELECT min(rs.avg_unique_reads) as num_reads, min(oa.avg_transcript_length) as tx_length
            FROM apidbTuning.ProfileSamples ps
              , webready.RnaSeqStats_p rs
              , apidbTuning.OrganismAttributes oa
            WHERE ps.study_id = rs.study_id
              AND rs.taxon_id = oa.component_taxon_id
              AND ps.profile_type = 'values'
              AND protocol_app_node_id in ($$samples_comp_antisense$$)
          ) t
        )
        SELECT *
        FROM (
          SELECT CONCAT('10 reads (', f.value::varchar, ' TPM)') as display, f.value as term, f.value as internal, 1 as num
          FROM tpm f
          UNION
          SELECT CONCAT('5 reads (', (f.value/2)::varchar, ' TPM)') as display, f.value/2 as term, f.value/2 as internal, 2 as num
          FROM tpm f
          UNION
          SELECT CONCAT('20 reads (', (f.value*2)::varchar, ' TPM)') as display, f.value*2 as term, f.value*2 as internal, 3 as num
          FROM tpm f
          UNION
          SELECT CONCAT('50 reads (', (f.value*5)::varchar, ' TPM)') as display, f.value*5 as term, f.value*5 as internal, 4 as num
          FROM tpm f
          UNION
          SELECT CONCAT('100 reads (', (f.value*10)::varchar, ' TPM)') as display, f.value*10 as term, f.value*10 as internal, 5 as num
          FROM tpm f
        ) t
        ORDER BY num
      </sql>

    </sqlQuery>


    <sqlQuery name="AntisenseSamples" >
      <column name="internal" />
      <column name="term" />
      <sql>
        SELECT name as term, string_agg(protocol_app_node_id::text, ',' ORDER BY name) as internal
        FROM (
          SELECT CONCAT(profile_set_suffix , ' ' , protocol_app_node_name ) as name
            , protocol_app_node_id
          FROM apidbtuning.profilesamples
          where dataset_name like '%rnaSeq_RSRC%'
            AND profile_type = 'values'
            AND study_name not like '%nonunique%'
            AND (profile_set_suffix IS NULL OR profile_set_suffix not like '%scaled%')
        ) t
        GROUP BY name
      </sql>
    </sqlQuery>


    <sqlQuery name="pcynM_Galinski_infected_Mmulatta_rnaSeq_RSRCAntisenseSamples" >
      <column name="internal" />
      <column name="term" />
      <sql>
        SELECT name as term, string_agg(protocol_app_node_id::text, ',' ORDER BY name) as internal
        FROM (
          SELECT CONCAT(profile_set_suffix , ' ' , protocol_app_node_name ) as name
            , protocol_app_node_id
          FROM apidbtuning.profilesamples
          WHERE dataset_name = 'pcynM_Galinski_infected_Mmulatta_rnaSeq_RSRC'
            AND profile_type = 'values'
            AND study_name not like '%nonunique%'
        ) t
        group by name
      </sql>
    </sqlQuery>

    <sqlQuery name="AntisenseDirection">
      <column name="internal" />
      <column name="term" />
      <sql>
        SELECT * FROM (
          SELECT 'increase' as term, 1 as internal, 1 as num
          UNION
          SELECT 'decrease' as term, -1 as internal, 2 as num
        ) t
        ORDER BY num
      </sql>
    </sqlQuery>

    <sqlQuery name="SenseDirection">
      <column name="internal" />
      <column name="term" />
      <sql>
        SELECT * FROM (
          SELECT 'decrease' as term, -1 as internal, 1 as num
          UNION
          SELECT 'increase' as term, 1 as internal, 2 as num
        ) t
        ORDER BY num
      </sql>
    </sqlQuery>


    <sqlQuery name="regulatedDirRNAi"  >
      <column name="internal" />
      <column name="term" />
      <column name="display" />
      <sql>
        SELECT 'Decrease in coverage' as display, 'down-regulated' as term, '-' as internal
      </sql>
    </sqlQuery>






    <sqlQuery name="HornRNAiSeqProfiles" includeProjects="TriTrypDB,UniDB">
      <column name="display"/>
      <column name="internal"/>
      <column name="term"/>
      <sql>
        SELECT profile_study_id as internal
          , profile_set_name as term
          ,  case when profile_set_name like '%cds coord%'
            then'Quantitated from the CDS Sequence'
            else 'Quantitated from gene model (5 prime UTR + CDS)'
          end as display
        FROM apidbtuning.profiletype
        WHERE profile_set_name in (
            'T.brucei paired end RNA Seq data from Horn aligned with cds coordinates',
            'T.brucei paired end RNA Seq data from Horn'
          )
          AND profile_type = 'values'
        ORDER BY term desc
      </sql>
    </sqlQuery>




        <!-- TEMPLATE_ANCHOR directComparisonGenericPValueSamplesParamQuery -->
       <sqlQuery name="LifeCycStgTbruceiRnaSeqRef" doNotTest="1" includeProjects="TriTrypDB,UniDB">
             <paramRef ref="geneParams.profileset_generic"/>
             <column name="display"/>
	     <column name="internal"/>
	     <column name="term"/>
	  <sql>
         SELECT 'No_Tet' as term,
                 pan.protocol_app_node_id as internal,
                 'Uninduced sample' as display
          from  study.protocolappnode pan
              , study.nodenodeset sl
          where sl.node_set_id = $$profileset_generic$$
          and sl.protocol_app_node_id = pan.protocol_app_node_id
          and pan.name like 'No_Tet%tpm%'
          </sql>
        </sqlQuery>



    <sqlQuery name="LifeCycStgTbruceiRnaSeq" doNotTest="1" includeProjects="TriTrypDB,UniDB">
      <paramRef ref="geneParams.profileset_generic"/>
      <column name="display"/>
      <column name="internal"/>
      <column name="term"/>
      <sql>
        SELECT pan.name as term,
          pan.protocol_app_node_id as internal,
          CASE WHEN (pan.name like 'PF%') THEN 'Induced in procyclic forms (PS) forms, 9 days (9 doublings)'
          WHEN (pan.name like 'BFD3%') THEN 'Induced in bloodstream (BS) forms, 3 days (10 doublings)'
          WHEN (pan.name like 'BFD6%') THEN 'Induced in bloodstream (BS) forms, 6 days (20 doublings)'
          WHEN (pan.name like 'DIF%') THEN CONCAT('Induced throughout differentiation (DIF = 7 BS doublings + 6 PS doublings)', chr(185))
          END as display
        FROM study.protocolappnode pan
          , study.nodenodeset sl
        WHERE sl.node_set_id = $$profileset_generic$$
          AND sl.protocol_app_node_id = pan.protocol_app_node_id
          AND pan.name not like 'No_Tet%'
          AND pan.name like '%tpm%'
        ORDER BY pan.node_order_num
      </sql>
    </sqlQuery>



    <sqlQuery name="regulatedDirectionImmune"  isCacheable="false">
      <column name="internal" />
      <column name="term" />
      <sql>
        SELECT 'increased immunogenicity' as term, 'increased' as internal
        UNION
        SELECT 'decreased immunogenicity' as term, 'decreased' as internal
      </sql>
    </sqlQuery>



    <!-- removed BACI group because it has no species in it and screws up the search results -->
    <sqlQuery name="PhyleticIndentMap" doNotTest="1" >
      <column name="internal" />
      <column name="term" />
      <column name="display" />
      <sql>
        <![CDATA[
          WITH RECURSIVE cte AS (
            SELECT depth_first_index, orthomcl_clade_id, 0 AS level, three_letter_abbrev
            FROM apidb.orthomclClade
            WHERE orthomcl_clade_id = (
              SELECT min(orthomcl_clade_id)
              FROM apidb.orthomclClade
            )
            UNION
            SELECT sub.depth_first_index, sub.orthomcl_clade_id, cte.level + 1, sub.three_letter_abbrev
            FROM apidb.orthomclclade sub, cte
            WHERE sub.parent_id = cte.orthomcl_clade_id
          )
          SELECT level AS internal, level AS display, three_letter_abbrev AS term
          FROM cte
          WHERE level > 0
            AND three_letter_abbrev NOT IN ('BACI')
          ORDER BY depth_first_index ASC, level ASC, three_letter_abbrev ASC
        ]]>
      </sql>
    </sqlQuery>
    <!--
-->
    <sqlQuery name="TfbsNames"  includeProjects="PlasmoDB,UniDB">
      <column name="internal" />
      <column name="term" />
      <sql>
        SELECT DISTINCT bg.name as term, bg.name as internal
        FROM webready.TFBSGene_p bg,
          sres.externaldatabase d, sres.externaldatabaserelease rel
        WHERE d.name = 'pfal3D7_genomeFeature_Llinas_TransFactorBindingSites_GFF2_RSRC'
          AND d.external_database_id  = rel.external_database_id
          AND rel.external_database_release_id = bg.external_database_release_id
        ORDER BY bg.name
      </sql>
    </sqlQuery>


    <!-- removed BACI group because it has no species in it and screws up the search results -->
    <sqlQuery name="PhyleticTermMap" doNotTest="1">
      <column name="internal" />
      <column name="term" />
      <column name="display" />
      <sql>
        SELECT three_letter_abbrev as term, name as internal, name as display
        FROM apidb.orthomclclade
        WHERE three_letter_abbrev not in ('BACI')
        ORDER BY depth_first_index  ASC, three_letter_abbrev ASC
      </sql>
    </sqlQuery>
    <!--
-->



    <sqlQuery name="ChIPAntibodyToxo" includeProjects="ToxoDB,UniDB" doNotTest="1">
      <paramRef ref="geneParams.chip_strains" quote="true"/>
      <column name="internal" />
      <column name="term" />
      <column name="display" />
      <sql>
        SELECT replace(display,' - none','') as display,
          internal as internal,
          term as term
        FROM (
          SELECT DISTINCT  CONCAT(cpp.antibody,'|',cpp.treatment ) as term,
            CONCAT(cpp.antibody,'|',cpp.treatment ) as internal,
            CASE
            WHEN cpp.antibody IN (
              SELECT cpp.antibody
              FROM ApidbTuning.ChIPProtocolParams cpp
              WHERE cpp.replicate = 2
            )
            THEN CASE
              WHEN cpp.antibody like 'H3K%'
              THEN CONCAT('(1)  ', cpp.antibody, ' - ', cpp.treatment)
              ELSE CONCAT('(3)  ', cpp.antibody)
              END
            ELSE CONCAT('(2)  ', cpp.antibody, ' - ', cpp.treatment, ' - No Replicates ')
            END as display
          FROM ApidbTuning.ChIPProtocolParams cpp
          WHERE cpp.strain = $$chip_strains$$
            AND cpp.antibody != 'H3K4me1'
            AND cpp.protocol_type = 'called_peaks'
        ) t
        ORDER BY display
      </sql>
    </sqlQuery>



    <sqlQuery name="ChIPReplicates" includeProjects="ToxoDB,UniDB" doNotTest="1">
      <paramRef ref="geneParams.chip_strains" quote="true"/>
      <column name="internal" />
      <column name="term" />
      <column name="display" />
      <sql>
        SELECT term,internal,display from (select 'Yes' as term, 1 as internal,'Yes' as display
        FROM (
          SELECT count(distinct replicate) as replicates from ApidbTuning.ChIPProtocolParams where strain = $$chip_strains$$ and protocol_type = 'called_peaks') cpp where cpp.replicates > 1
          UNION
          SELECT 'No' as term, 0 as internal, 'No' as display
          FROM (select count(distinct replicate) as replicates from ApidbTuning.ChIPProtocolParams where strain = $$chip_strains$$ and protocol_type = 'called_peaks') cpp where cpp.replicates > 1
          UNION
          SELECT 'No' as term, 0 as internal, 'Not Applicable' as display
          FROM (select count(distinct replicate) as replicates from ApidbTuning.ChIPProtocolParams where strain = $$chip_strains$$ and protocol_type = 'called_peaks') cpp where cpp.replicates in (1,0)
        ) t
        ORDER BY display asc
      </sql>
    </sqlQuery>


    <sqlQuery name="PlasmoChIPReplicates" includeProjects="PlasmoDB,UniDB" doNotTest="1">
      <paramRef ref="geneParams.chip_experiment"/>
      <column name="internal" />
      <column name="term" />
      <column name="display" />
      <sql>
        SELECT DISTINCT
          CASE replicate WHEN null THEN 'Not Applicable' ELSE 'Yes' END as display,
          CASE replicate WHEN null THEN 0 ELSE 1 END as term,
          CASE replicate WHEN null THEN 0 ELSE 1 END as internal
        FROM APIDBTUNING.chipprotocolparams
        WHERE protocol_type = 'called_peaks'
          AND experiment_name = '$$chip_experiment$$'
        UNION
        SELECT 'No' as display, 0 as term, 0 as internal
        FROM APIDBTUNING.chipprotocolparams
        WHERE protocol_type = 'called_peaks'
          AND replicate is not null
          AND experiment_name = '$$chip_experiment$$'
      </sql>
    </sqlQuery>



    <sqlQuery name="ChIPAntibodyPlasmo" includeProjects="PlasmoDB,UniDB" doNotTest="1">
      <paramRef ref="geneParams.chip_experiment"/>
      <column name="internal" />
      <column name="term" />
      <column name="display" />
      <sql>
        SELECT
          CASE
            WHEN display like '%H3K4%' THEN CONCAT(display, ' (only wild type)')
            WHEN display like '%H4K20%' THEN CONCAT(display, ' (only wild type)')
            ELSE display
          END as display,
          term, internal
        FROM (
          SELECT DISTINCT
            coalesce(antibody, 'Not Applicable') as display,
            coalesce(antibody, 'Not Applicable') as term,
            coalesce(antibody, 'Not Applicable') as internal
          FROM APIDBTUNING.chipprotocolparams
          WHERE experiment_name = '$$chip_experiment$$'
            AND protocol_type = 'called_peaks'
        ) t
      </sql>
    </sqlQuery>



    <sqlQuery name="ChIPGenotype" includeProjects="PlasmoDB,UniDB" doNotTest="1">
      <paramRef ref="geneParams.chip_experiment"/>
      <column name="internal" />
      <column name="term" />
      <column name="display" />
      <sql>
        SELECT DISTINCT
          replace(coalesce(genotype, 'Not Applicable'), '_', ' ') as display,
          coalesce(genotype, 'Not Applicable') as term,
          coalesce(genotype, 'Not Applicable') as internal
        FROM APIDBTUNING.chipprotocolparams
        WHERE experiment_name = '$$chip_experiment$$'
          AND protocol_type = 'called_peaks'
      </sql>
    </sqlQuery>



    <sqlQuery name="ChIp_Assays" includeProjects="ToxoDB,UniDB">
      <column name="internal" />
      <column name="term" />
      <column name="display" />
      <sql>
        SELECT DISTINCT cpp.strain as term,
          cpp.strain as internal,
          CASE WHEN cpp.strain = 'CTG' THEN 'CTG (TypeIII)' WHEN cpp.strain = 'RH' THEN 'RH (TypeI)' WHEN cpp.strain = 'PLK' THEN 'PLK (TypeII)' END as display
        FROM ApidbTuning.ChIPProtocolParams cpp
        WHERE cpp.protocol_type = 'called_peaks' AND cpp.strain is not null and cpp.strain != 'unknown'
      </sql>
    </sqlQuery>



    <sqlQuery name="ChIp_Experiments" includeProjects="PlasmoDB,UniDB">
      <column name="internal" />
      <column name="term" />
      <column name="display" />
      <sql>
        SELECT term,internal,display
        FROM (
          SELECT 'Histone modifications in wild type and Sir2 knock-outs' as term, 'pfal3D7_Artur_Scherf' as internal,'(1)   Histone modifications in wild type and Sir2 knock-outs' as display
          UNION
          SELECT 'Genome-wide assoc. of (Hp-1) with virulence gene clusters' as term, 'pfal3D7_Till_Voss' as internal, '(2)   Genome-wide assoc. of Hp-1 with virulence gene clusters' as display
        ) t
        ORDER BY display asc
      </sql>
    </sqlQuery>




    <sqlQuery name="MetbPathwaysList" includeProjects="PlasmoDB,UniDB" doNotTest="1">
      <column name="internal" />
      <column name="term" />
      <column name="display" />
      <sql>
        SELECT DISTINCT CONCAT(n.description ,' (', n.name,')' ) as display,
          n.network_context_id as term,
          n.network_context_id as internal
        FROM apidb.networkContext n
      </sql>
    </sqlQuery>


    <sqlQuery name="EcNumberList" >
      <column name="internal" />
      <column name="term" />
      <column name="display"/>

      <sql>
        SELECT ec.ec_number AS internal,
          ec.ec_number AS term,
          CONCAT(ec.ec_number , ' (' , ec.description , ')' ) as display,ecct.ctint as ct
        FROM sres.enzymeClass ec,
          (
            SELECT enzyme_class_id,count(*) as ctint
            FROM dots.AaSequenceEnzymeClass asec
            GROUP BY enzyme_class_id
          ) ecct
        WHERE ecct.enzyme_class_id = ec.enzyme_class_id
        UNION
        SELECT 'N/A' AS internal, 'N/A' AS term, 'N/A' AS display, 0.5 as ct
        ORDER by ct desc
      </sql>
    </sqlQuery>



    <sqlQuery name="EcNumberSource" >
      <column name="internal"/>
      <column name="term"/>
      <column name="display"/>
      <sql>
        SELECT DISTINCT evidence_code AS internal,
          CASE evidence_code
            WHEN 'OrthoMCLDerived' THEN 'inferred from OrthoMCL'
            WHEN 'gb' THEN 'GenBank'
            WHEN 'Hagai' THEN 'MPMP'
            ELSE evidence_code
          END as display,
          CASE evidence_code
            WHEN 'OrthoMCLDerived' THEN 'computationally inferred from Orthology'
            WHEN 'gb' THEN 'GenBank'
            WHEN 'Hagai' THEN 'MPMP'
            ELSE evidence_code
          END as term
        FROM dots.aaSequenceEnzymeClass
      </sql>
    </sqlQuery>


      <!--+++++++++++++++++++++++++++++++++++++++++++++++-->
      <!-- Transcript Novelty Long Read-->
      <!--+++++++++++++++++++++++++++++++++++++++++++++++-->

       <sqlQuery name="TranscriptSource" includeProjects="PlasmoDB,ToxoDB,UniDB">
            <column name="internal"/>
            <column name="term"/>
            <column name="display"/>
            <sql>
		SELECT DISTINCT transcript_novelty AS internal,
              decode(transcript_novelty,'NNC', 'Novel Transcript not in collection',
              'NIC', 'Novel Transctipt in Collection',
              'Genomic', 'Genomic','ISM', 'Incomplete Splice Match' ,transcript_novelty) as display,
              decode(transcript_novelty,'NNC', 'Novel_Not_In_Collection',
              'NIC', 'Novel_In_Collection',
              'Genomic', 'Genomic','ISM', 'Incomplete_Splice_Match' ,transcript_novelty) as term
              FROM  apidb.longreadtranscript
	    </sql>
        </sqlQuery>



	<sqlQuery name="DatasetSource" includeProjects="PlasmoDB,ToxoDB,UniDB">
            <column name="internal"/>
            <column name="term"/>
            <column name="display"/>
            <sql>
	    select distinct dataset_name as internal, display_name as display, dataset_name as term from (
                select ed.name as dataset_name , dp.display_name as display_name
                ,lrt.* from apidb.longreadtranscript lrt
                ,sres.externaldatabaserelease edr
                ,sres.externaldatabase ed
                ,apidbtuning.TranscriptAttributes ta
                ,apidbtuning.datasetPresenter dp
                where edr.external_database_release_id = lrt.external_database_release_id
                and ed.external_database_id = edr.external_database_id
                and lrt.transcript_source_id = ta.source_id
                and ed.name = dp.name
                ) t
            </sql>
        </sqlQuery>



        <sqlQuery name="mismatch_type" includeProjects="PlasmoDB,ToxoDB,UniDB">
            <column name="internal"/>
            <column name="term"/>
            <column name="display"/>
            <sql>
		SELECT DISTINCT incomplete_splice_match_type AS internal,
              decode(incomplete_splice_match_type,'None', 'None',
              'Both', 'Both Suffix and Prefix',
              'Prefix', 'Prefix incomolete mismatch (5 prime end)','Suffix', 'Suffix incomolete mismatch (3 prime end)' ,transcript_novelty) as display,
              decode(incomplete_splice_match_type,'None', 'None',
              'Both', 'Both Suffix and Prefix',
              'Prefix', 'Prefix incomolete mismatch (5 prime end)','Suffix', 'Suffix incomolete mismatch (3 prime end)' ,transcript_novelty) as term
              FROM  apidb.longreadtranscript
            </sql>
        </sqlQuery>




      <sqlQuery name="ism_types" includeProjects="PlasmoDB,ToxoDB,UniDB">
        <paramRef ref="geneParams.long_read_datasets"/>
      	<column name="internal"/>
      	<column name="term"/>
      	<column name="parentTerm"/>
      	<sql>
       	 <![CDATA[

select distinct transcript_novelty as internal, 'null' as parentterm,
CASE when transcript_novelty in ('Genomic') then 'Genomic'
 when transcript_novelty in ('Known') then 'Known'
 when transcript_novelty in ('NNC') then 'Novel Not In Collection'
 when transcript_novelty in ('NIC') then 'Novel In Collection'
 when transcript_novelty in ('ISM') then 'Incomplete Splice Match'
end as term
                from apidb.longreadtranscript lrt
                ,apidbtuning.TranscriptAttributes ta
                ,sres.externaldatabaserelease edr
                ,sres.externaldatabase ed
                ,apidbtuning.datasetPresenter dp
                where ta.gene_source_id = lrt.gene_source_id
                and edr.external_database_release_id = lrt.external_database_release_id
                and ed.external_database_id = edr.external_database_id
                and ed.name = dp.name
                and ed.name = '$$long_read_datasets$$'

        union

        select distinct incomplete_splice_match_type as internal,
        case when transcript_novelty in ('ISM') then 'Incomplete Splice Match'
        end as parentterm,
         incomplete_splice_match_type as term
                from apidb.longreadtranscript
        where transcript_novelty = 'ISM'
        order by parentterm

        ]]>
      </sql>
    </sqlQuery>



      <sqlQuery name="ism_types_span" includeProjects="PlasmoDB,ToxoDB,UniDB">
        <column name="internal"/>
        <column name="term"/>
        <column name="parentTerm"/>
        <sql>
	<![CDATA[

	select distinct transcript_novelty as internal, 'null' as parentterm,
CASE when transcript_novelty in ('Genomic') then 'Genomic'
 when transcript_novelty in ('Known') then 'Known'
 when transcript_novelty in ('NNC') then 'Novel Not In Collection'
 when transcript_novelty in ('NIC') then 'Novel In Collection'
 when transcript_novelty in ('ISM') then 'Incomplete Splice Match'
 else transcript_novelty
end as term
                from apidb.longreadtranscript lrt
                ,sres.externaldatabaserelease edr
                ,sres.externaldatabase ed
                ,apidbtuning.datasetPresenter dp
                where
                edr.external_database_release_id = lrt.external_database_release_id
                and ed.external_database_id = edr.external_database_id
	]]>

      </sql>
    </sqlQuery>


<!--+++++++++++++++++++++++++++++++++++++++++++++++-->


    <sqlQuery name="EcNumberAllSources" >
      <column name="internal"/>
      <column name="term"/>
      <sql>
        SELECT 'all' as term,
          string_agg('''' || evidence_code || '''', ', ') as internal
        FROM dots.aaSequenceEnzymeClass
      </sql>
    </sqlQuery>



    <sqlQuery name="GoTermList" >
      <paramRef ref="geneParams.go_term_slim"/>
      <column name="internal" />
      <column name="term" />
      <column name="display"/>
      <sql>
        SELECT gt.go_id AS internal,
          gt.go_id AS term,
          CONCAT(gt.go_id, ' : ', gt.go_term_name, ' : ', max(CASE WHEN gt.depth is NULL THEN 0 ELSE gt.depth END)) AS display,
          count(*) as ct
        FROM   webready.GoTermSummary_p gt
        WHERE ($$go_term_slim$$ = 'No' or gt.IS_GO_SLIM = 1)
          AND (project_id = '@PROJECT_ID@' or 'UniDB' = '@PROJECT_ID@')
        GROUP BY gt.go_id, gt.go_term_name
        UNION
        SELECT 'N/A' as internal,
          'N/A' as term,
          'N/A' as display,
          0.5 as ct
        ORDER BY ct desc
      </sql>
    </sqlQuery>



    <sqlQuery name="GoTermListCL" >

      <column name="internal" />
      <column name="term" />
      <column name="display"/>
      <sql>
        SELECT gt.go_id AS internal,
          gt.go_id AS term,
          CONCAT(gt.go_id, ' : ', gt.go_term_name, ' : ', max(CASE WHEN gt.depth is NULL THEN 0 ELSE gt.depth END)) AS display,
          count(*) as ct
        FROM   webready.GoTermSummary_p gt
        WHERE gt.source in ('DawsonLab', 'TrypTag')
        GROUP BY gt.go_id, gt.go_term_name
        UNION
          SELECT 'N/A' as internal,
          'N/A' as term,
          'N/A' as display,
          0.5 as ct
        ORDER BY ct desc
      </sql>
    </sqlQuery>


    <sqlQuery name="MassAssay" excludeProjects="SchistoDB">
      <column name="internal" />
      <column name="term" />
      <column name="parentTerm" />
      <column name="display" />
      <sql>
        <![CDATA[
          WITH OrganismConstraint AS (
            SELECT DISTINCT sdi.sample_display_name as sample, org.organism as organism,
                CASE WHEN dsp.short_attribution IS NULL THEN dsp.display_name
                     ELSE CONCAT(dsp.display_Name, ' (', dsp.short_attribution, ')')
                END AS Experiment_Display,
                CASE WHEN dsp.dataset_name_pattern IS NULL
                     THEN dsp.name
                     ELSE CONCAT(org.organism, '_', dsp.dataset_name_pattern)
                END AS experiment,
                org.Project_Id,
                replace(sdi.sample,'.tab', '')  as internal_id,
                sdi.sort_order
            FROM apidbTuning.sampledisplayinfo sdi,
                  apidbTuning.datasetPresenter dsp,
                  apidbTuning.datasetdatasource dd,
                  apidbTuning.datasetContact dsc,
                  (SELECT DISTINCT ta.organism,ta.taxon_id,ta.project_id
                    FROM apidbtuning.TranscriptAttributes ta, apidb.massspecpeptide msf
                    WHERE msf.protein_source_id = ta.protein_source_id
                   and (ta.project_id = '@PROJECT_ID@' OR 'UniDB' = '@PROJECT_ID@')
                  ) org
            WHERE sdi.dataset_name like '%_massSpec_%'
              AND sdi.dataset_name = dd.name
              AND dsc.dataset_presenter_id = dd.dataset_presenter_id
              AND dsp.dataset_presenter_id = dd.dataset_presenter_id
              AND Dsc.Is_Primary_Contact = true
              AND dd.taxon_id = org.taxon_id
          )
          SELECT replace(replace(term,',',''),(''''), '') as term,
              replace(replace(parentTerm,',', ''),(''''), '') as parentTerm,
              display as display,
              internal,
              sort_order,
              chars,
              nums
          FROM (
              SELECT
                CASE WHEN mst.sample = mst.experiment
                   THEN mst.experiment_display
                   ELSE mst.sample
                   END as display,
                CASE WHEN mst.sample = mst.experiment
                   THEN CONCAT(mst.experiment, '_', mst.organism)
                   ELSE CONCAT(mst.sample, '_', mst.organism)
                   END as term,
                CASE WHEN mst.sample = mst.experiment
                   THEN mst.organism
                   ELSE mst.experiment
                   END as parentTerm,
                mst.internal_id as internal,
                mst.sort_order as sort_order,
                REGEXP_REPLACE(mst.sample,'[0-9]','') as chars,
                nullif(REGEXP_REPLACE(mst.sample,'[^0-9]','','g'),'')::numeric as nums
              FROM OrganismConstraint mst
              WHERE mst.experiment is not null
              UNION
              SELECT mst.experiment_display as display,
                    mst.experiment as term,
                    mst.organism as parentTerm,
                    '-1' as internal,
                    mst.sort_order as sort_order,
                    '' as chars,
                    NULL as nums
              FROM OrganismConstraint mst
              WHERE mst.experiment is not null
                AND mst.experiment <> mst.sample
            UNION
              SELECT CONCAT('<b>', mst.organism ,'</b>' ) as display,
                    mst.organism as term,
                    REGEXP_REPLACE(mst.organism,'(.*) (.*) (.*)','\1 \2') as parentTerm,
                    '-1' as internal,
                    mst.sort_order as sort_order,
                    '' as chars,
                    NULL as nums
              FROM OrganismConstraint mst
              WHERE mst.experiment is not null
                AND mst.experiment <> mst.sample
            UNION
              SELECT CONCAT('<b>', REGEXP_REPLACE(mst.organism,'(.*) (.*) (.*)','\1 \2'), '</b>') as display
                , REGEXP_REPLACE(mst.organism,'(.*) (.*) (.*)','\1 \2') as term
                , REGEXP_REPLACE(mst.organism,'(.*) (.*) (.*)','\1') as parentTerm
                , '-1' as internal
                , mst.sort_order as sort_order
                , '' as chars
                , NULL as nums
              FROM OrganismConstraint mst
              WHERE mst.experiment is not null
                AND mst.experiment <> mst.sample
              UNION
              SELECT CONCAT('<b>', REGEXP_REPLACE(mst.organism,'(.*) (.*) (.*)','\1'), '</b>') as display,
                    REGEXP_REPLACE(mst.organism,'(.*) (.*) (.*)','\1') as term,
                    '' as parentTerm,
                    '-1' as internal,
                    mst.sort_order as sort_order,
                    '' as chars,
                    NULL as nums
              FROM OrganismConstraint mst
              WHERE mst.experiment is not null
                AND mst.experiment <> mst.sample
          ) t
          ORDER BY display
        ]]>
      </sql>
    </sqlQuery>



    <sqlQuery name="PTMAssay" includeProjects="PiroplasmaDB,PlasmoDB,ToxoDB,TriTrypDB,FungiDB,HostDB,UniDB" >
      <paramRef ref="geneParams.ptm_type"/>
      <column name="internal"/>
      <column name="term"/>
      <column name="parentTerm"/>
      <column name="display"/>
      <sql>
        <![CDATA[
          WITH organismMods AS (
            SELECT DISTINCT ta.organism
            , ms.*
            , CASE WHEN dp.short_attribution IS NULL THEN dp.display_name
                   ELSE CONCAT(dp.display_Name, ' (', dp.short_attribution, ')')
                END AS experiment_name
            FROM apidbtuning.msmodifiedpeptidesummary_p ms
            , apidbtuning.TranscriptAttributes ta
            , apidbtuning.datasetpresenter dp
            WHERE ms.source_id = ta.source_id
              AND (ms.modification_type in ( $$ptm_type$$ ) OR $$ptm_type$$ = 'any')
              AND (ms.external_database_name = dp.name OR regexp_replace(ms.external_database_name, '^.+?_', '_') = dp.name)
          )
            SELECT DISTINCT sample_display_name AS display
            , replace(sample_display_name, ',', '') AS term
            , replace(CONCAT(experiment, '_', organism), ',', '') AS parentterm
            , sample_display_name AS internal
            FROM organismMods
          UNION
            SELECT DISTINCT experiment_name AS display
            , replace(CONCAT(experiment, '_', organism), ',', '') AS term
            , organism AS parentterm
            , '-1' AS internal
            FROM organismMods
          UNION
            SELECT CONCAT('<b>' , organism , '</b>' ) as display
            , organism AS term
            , REGEXP_REPLACE(organism,'(.*) (.*) (.*)','\1 \2') as parentTerm
            , '-1' AS internal
            FROM  organismMods
          UNION
            SELECT CONCAT('<b>', REGEXP_REPLACE(organism,'(.*) (.*) (.*)','\1 \2'), '</b>') AS display
            , REGEXP_REPLACE(organism,'(.*) (.*) (.*)','\1 \2') AS term
            , REGEXP_REPLACE(organism,'(.*) (.*) (.*)','\1') as parentTerm
            , '-1' AS internal
            FROM organismMods
          UNION
            SELECT CONCAT('<b>', REGEXP_REPLACE(organism,'(.*) (.*) (.*)','\1'), '</b>') AS display
            , REGEXP_REPLACE(organism,'(.*) (.*) (.*)','\1') AS term
            , '' AS parentterm
            , '-1' AS internal
            FROM organismMods
        ]]>
      </sql>
    </sqlQuery>


    <sqlQuery name="PTMType" includeProjects="PiroplasmaDB,PlasmoDB,ToxoDB,TriTrypDB,FungiDB,HostDB,UniDB" >
      <column name="internal"/>
      <column name="term"/>
      <column name="display"/>
      <sql>
        <![CDATA[
            SELECT DISTINCT modification_type AS internal
            , modification_type AS term
            , replace(replace(replace(modification_type, '-', ' '), '_', ' '), 'binding site', 'ubiquitin binding site') AS display
            , CASE WHEN modification_type = 'phosphorylation_site' THEN 1 ELSE 2 END as sort_order
            FROM apidbtuning.msmodifiedpeptidesummary_p
          where modification_type is not NULL  -- FIX; REMOVE after all mod_type data is loaded
          UNION
            SELECT
              'any' as internal
              , 'any' as term
              , 'any' as display
              , 10 as sort_order
            ORDER BY sort_order, term
        ]]>
      </sql>
    </sqlQuery>


    <sqlQuery name="DomainAccession"  doNotTest="1">
      <paramRef ref="geneParams.domain_database"/>
      <column name="internal" />
      <column name="term" />
      <column name="display"/>

      <sql>
        SELECT interpro_primary_id as internal
          , interpro_primary_id AS term --  || CONCAT(' : ' , interpro_secondary_id ) as term
          , CONCAT(interpro_primary_id, ' : ', -- CONCAT(interpro_secondary_id , ' ' ,
            interpro_desc) as display
          , count(*) as ct_hits
        FROM apidb.interproResults
        WHERE interpro_db_name = $$domain_database$$
        GROUP BY interpro_primary_id, interpro_secondary_id, interpro_desc
        UNION
        SELECT 'N/A', 'N/A', 'N/A', 0.5
        ORDER BY ct_hits desc
      </sql>
    </sqlQuery>





    <sqlQuery name="GeneTypes" >
      <column name="internal"/>
      <column name="term"/>
      <sql>
        SELECT DISTINCT
          replace(
            CASE ga.gene_type
              WHEN 'non protein coding' THEN 'misc RNA'
              WHEN 'non_protein_coding' THEN 'misc RNA'
              WHEN 'protein coding gene' THEN 'protein coding'
              WHEN 'ncRNA gene' THEN 'misc RNA'
              ELSE ga.gene_type
            END
            , '_', ' '
          ) AS term
          , ga.gene_type as internal
        FROM apidbtuning.TranscriptAttributes ga
      </sql>
    </sqlQuery>

    <sqlQuery name="Reagents" includeProjects="CryptoDB,PlasmoDB,ToxoDB,UniDB">
      <column name="internal"/>
      <column name="term"/>
      <sql>
        SELECT term, internal FROM
        (
          SELECT reagent_type AS term, reagent_type AS internal,
          rownum AS ord
          FROM (
            SELECT DISTINCT lower(dr.secondary_identifier) AS reagent_type
            FROM sres.DbRef dr,
              sres.ExternalDatabaseRelease edr,
              sres.ExternalDatabase ed
            WHERE dr.external_database_release_id = edr.external_database_release_id
              AND edr.external_database_id = ed.external_database_id
              AND ed.name in ('MR4DBxRefs','pfal3D7_dbxref_simple_gene2MR4Reagents_RSRC','AntibodyDBxRefs')
            ORDER BY lower(dr.secondary_identifier)
          ) t
          UNION SELECT 'any' AS term, 'any' AS internal, 0 AS ord
        ) t2
        ORDER BY ord
      </sql>
    </sqlQuery>


    <sqlQuery name="Clades" >
      <column name="internal"/>
      <column name="term"/>
      <column name="display"/>
      <sql>
        SELECT tn.name AS term, taxon_id AS internal,
          CASE WHEN tn.name ='Archaea' THEN 'Archaea'
          WHEN tn.name ='Bacteria' THEN 'Bacteria'
          WHEN tn.name ='Eukaryota' THEN 'Eukaryota - all'
          ELSE CONCAT('Eukaryota - only ', tn.name)
          END as display
        FROM sres.taxonname tn
        WHERE tn.name_class = 'scientific name'
          AND tn.name IN ('Archaea', 'Eukaryota', 'Bacteria')
          OR tn.name IN (SELECT DISTINCT term FROM APIDBTUNING.organismtree WHERE parentterm is null)
        ORDER BY display
      </sql>
    </sqlQuery>


    <sqlQuery name="DomainDatabase" >
      <column name="internal"/>
      <column name="term"/>
      <sql>
        SELECT DISTINCT
          interpro_db_name as internal
          , CASE WHEN upper(interpro_db_name) like 'INTERPRO%'
            THEN 'INTERPRO'  ELSE interpro_db_name
            END AS term
        FROM apidb.interproResults
        ORDER BY term
      </sql>
    </sqlQuery>




    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

    <!-- keep this one at the end of the file because its embedded quote mark throws off
             emacs' syntax highlighting
        -->
    <sqlQuery name="MetabolicPathways" includeProjects="PlasmoDB,ToxoDB,UniDB">
      <paramRef ref="organismParams.org_with_Hagai_pathways"/>
      <column name="display"/>
      <column name="internal"/>
      <column name="term"/>

      <sql>
        SELECT DISTINCT dr.lowercase_secondary_identifier AS internal,
          TRIM(
            REPLACE(
              CASE dr.lowercase_secondary_identifier
              WHEN null THEN dr.primary_identifier
              ELSE dr.lowercase_secondary_identifier END
              , CHR(191),''
            )
          ) AS display,
          replace(dr.lowercase_secondary_identifier, ',', '-')  AS term
        FROM sres.DbRef dr, sres.ExternalDatabaseRelease edr, sres.ExternalDatabase ed,
          dots.DbRefNaFeature drnf, apidbtuning.GeneAttributes gf
        WHERE dr.external_database_release_id = edr.external_database_release_id
          AND edr.external_database_id = ed.external_database_id
          AND ed.name in ('pfal3D7_dbxref_simple_gene2HagaiPathway_RSRC','tgonME49_dbxref_protein2Pathways_Feng_RSRC')
          AND dr.primary_identifier != 'qualityControl'
          AND drnf.db_ref_id = dr.db_ref_id
          AND gf.na_feature_id = drnf.na_feature_id
          AND gf.org_abbrev = $$org_with_Hagai_pathways$$
        ORDER BY display
      </sql>

    </sqlQuery>


    <sqlQuery name="phenotypeQualifier" includeProjects="TriTrypDB,FungiDB,UniDB">
      <paramRef ref="organismParams.organismwithPhenotype"/>
      <column name="display"/>
      <column name="internal"/>
      <column name="term"/>
      <sql>
        <![CDATA[
          SELECT display, term, internal FROM (
            SELECT
              case  when opq.name is null then 'HAS' else opq.name end as display
              ,case  when opq.name is null then 'HAS' else opq.name end as term
              ,case  when opq.name is null then 'HAS' else opq.name end as internal
              ,count(distinct pm.na_feature_id) as order_num
            FROM
              , webready.TranscriptAttributes_p ta
              , apidb.phenotypemodel pm
              , APIDB.NAFEATUREPHENOTYPEMODEL na
              , APIDB.PHENOTYPERESULT pr
              LEFT JOIN sres.ontologyterm opq ON pr.phenotype_quality_term_id = opq.ontology_term_id
            WHERE ta.gene_na_feature_id = na.na_feature_id
              AND pm.PHENOTYPE_MODEL_ID = na.PHENOTYPE_MODEL_ID
              AND pm.PHENOTYPE_MODEL_ID = pr.PHENOTYPE_MODEL_ID
              AND ta.org_abbrev = '$$organismwithPhenotype$$'
              AND pr.phenotype_entity_term_id is not null
            GROUP BY opq.name
          ) t
          ORDER BY order_num desc
        ]]>
      </sql>
    </sqlQuery>


    <sqlQuery name="phenotype" includeProjects="TriTrypDB, FungiDB,UniDB">
      <paramRef ref="organismParams.organismwithPhenotype"/>
      <paramRef ref="geneParams.phenotypeQualifier"/>
      <column name="display"/>
      <column name="internal"/>
      <column name="term"/>
      <sql>
        <![CDATA[
          SELECT display,term,internal FROM (
            SELECT
              oen.name as display
              , replace(oen.name, ',', ' -') as term
              , replace(oen.name,Chr(39), Chr(39)||Chr(39)) as internal
              , count(distinct pm.na_feature_id) as order_num
            FROM
              webready.TranscriptAttributes_p ta
              INNER JOIN APIDB.NAFEATUREPHENOTYPEMODEL na ON ta.gene_na_feature_id = na.na_feature_id
              INNER JOIN apidb.PhenotypeModel pm ON pm.phenotype_model_id = na.phenotype_model_id
              INNER JOIN apidb.PhenotypeResult pr ON pm.phenotype_model_id = pr.phenotype_model_id
              LEFT JOIN sres.OntologyTerm opq ON pr.phenotype_quality_term_id = opq.ontology_term_id
              LEFT JOIN sres.OntologyTerm oen ON pr.phenotype_entity_term_id = oen.ontology_term_id
            WHERE
              AND oen.name is not null
              AND (opq.name = '$$phenotypeQualifier$$' or (opq.name is null and 'HAS' = '$$phenotypeQualifier$$'))
              AND ta.org_abbrev = '$$organismwithPhenotype$$'
            GROUP BY oen.name
          ) t
          ORDER BY order_num desc
       ]]>
      </sql>
    </sqlQuery>




    <sqlQuery name="phenotypeQualifierMagnaporthe" includeProjects="TriTrypDB,FungiDB,UniDB">
      <paramRef ref="organismParams.organismwithPhenotype"/>
      <column name="display"/>
      <column name="internal"/>
      <column name="term"/>
      <sql>
        <![CDATA[
          SELECT display,term,internal FROM (
            SELECT
              case  when opq.name like 'information on putatively essential gene'
                   then 'putatively essential' else opq.name end as display  -- EUPATH_0043245
              , opq.name as term
              , opq.name as internal
              , count(distinct pm.na_feature_id) as order_num
            FROM
               webready.TranscriptAttributes_p ta
              , apidb.phenotypemodel pm
              , APIDB.NAFeaturePhenotypeModel na
              , sres.externalDatabase ed
              , sres.externalDatabaseRelease edr
              , apidb.phenotypeResult pr
              LEFT JOIN sres.ontologyterm opq ON pr.phenotype_quality_term_id = opq.ontology_term_id
            WHERE ta.gene_na_feature_id = na.na_feature_id
              AND pm.external_database_release_id = edr.external_database_release_id
              AND edr.external_database_id = ed.external_database_id
              AND ed.name = 'mory70-15_phenotype_Magnaporthe_Pheno_RSRC'
              AND pm.phenotype_model_id = na.phenotype_model_id
              AND pm.phenotype_model_id = pr.phenotype_model_id
              AND ta.org_abbrev = '$$organismwithPhenotype$$'
              AND pr.phenotype_entity_term_id is not null
            GROUP BY opq.name
          ) t
          ORDER BY order_num desc
      ]]>
      </sql>
    </sqlQuery>



    <sqlQuery name="phenotypeMagnaporthe" includeProjects="TriTrypDB, FungiDB,UniDB">
      <paramRef ref="organismParams.organismwithPhenotype"/>
      <paramRef ref="geneParams.phenotypeQualifier"/>
      <column name="display"/>
      <column name="internal"/>
      <column name="term"/>
      <sql>
        <![CDATA[
          SELECT display,term,internal FROM (
            SELECT
              case when oen.name like 'information on putatively essential gene'
                   then 'putatively essential' else oen.name end as display  -- EUPATH_0043245
              , oen.name as term
              , oen.name as internal
              , count(distinct pm.na_feature_id) as order_num
            FROM
              webready.TranscriptAttributes_p ta
              INNER JOIN Apidb.NAFeaturePhenotypeModel na ON ta.gene_na_feature_id = na.na_feature_id
              INNER JOIN apidb.PhenotypeModel pm ON pm.phenotype_model_id = na.phenotype_model_id
              INNER JOIN sres.externalDatabase ed ON edr.external_database_id = ed.external_database_id
              INNER JOIN sres.externalDatabaseRelease edr ON pm.external_database_release_id = edr.external_database_release_id
              INNER JOIN apidb.PhenotypeResult pr ON pm.phenotype_model_id = pr.phenotype_model_id
              LEFT JOIN sres.OntologyTerm opq ON pr.phenotype_quality_term_id = opq.ontology_term_id
              LEFT JOIN sres.OntologyTerm oen ON pr.phenotype_entity_term_id = oen.ontology_term_id
            WHERE
              ed.name = 'mory70-15_phenotype_Magnaporthe_Pheno_RSRC'
              AND oen.name is not null
              AND (opq.name = '$$phenotypeQualifier$$')
              AND ta.org_abbrev = '$$organismwithPhenotype$$'
            GROUP BY oen.name
          ) t
          ORDER BY order_num desc
       ]]>
      </sql>
    </sqlQuery>



    <!-- #################################################################################################  -->
    <!-- generic expression queries                             ##########################################  -->
    <!-- #################################################################################################  -->


    <sqlQuery name="MinMaxAvgComp" >
      <paramRef ref="geneParams.regulated_dir"/>
      <column name="internal"/>
      <column name="term"/>
      <column name="display"/>
      <sql>
        <![CDATA[
          SELECT * FROM (
            SELECT CONCAT(term , p.so ) as term, internal,display, p.so
            FROM (
                SELECT 'average' as term,
                      'average' as internal,
                      'average' as display,
                       1
                       as so
                UNION
                SELECT 'minimum' as term,
                      'minimum' as internal,
                      'minimum' as display,
                       2  as so
                UNION
                SELECT 'maximum' as term,
                      'maximum' as internal,
                      'maximum' as display,
                       2  as so
                UNION
                SELECT 'median' as term,
                      'median' as internal,
                      'median' as display,
                      2 as so
              ) p,
              (
                SELECT 'abs' as type
                UNION
                SELECT '+' as type
                UNION
                SELECT '-' as type
              ) t,
              (
                SELECT 1 as so
                UNION
                SELECT 2 as so
                UNION
                SELECT 3 as so
              ) o
            WHERE p.so = o.so and type = '$$regulated_dir$$'
            ORDER BY p.so
          ) t
          WHERE '$$regulated_dir$$' != 'abs' OR ('$$regulated_dir$$' = 'abs' AND term like 'average%')
        ]]>
      </sql>
    </sqlQuery>


    <sqlQuery name="MinMaxAvgRef" >
      <paramRef ref="geneParams.regulated_dir"/>
      <column name="internal"/>
      <column name="term"/>
      <column name="display"/>
      <sql>
        <![CDATA[
          SELECT * FROM (
            SELECT CONCAT(term , p.so ) as term, internal,display, p.so
            FROM (
                SELECT 'average' as term,
                      'average' as internal,
                      'average' as display,
                       1 as so
                UNION
                SELECT 'minimum' as term,
                      'minimum' as internal,
                      'minimum' as display,
                       2  as so
                UNION
                SELECT 'maximum' as term,
                      'maximum' as internal,
                      'maximum' as display,
                       2  as so
                UNION
                SELECT 'median' as term,
                      'median' as internal,
                      'median' as display,
                      2 as so
              ) p,
              (
                SELECT 'abs' as type
                UNION
                SELECT '+' as type
                UNION
                SELECT '-' as type
              ) t,
              (
                SELECT 1 as so
                UNION
                SELECT 2 as so
                UNION
                SELECT 3 as so
              ) o
            WHERE p.so = o.so and type = '$$regulated_dir$$'
            ORDER BY p.so
          ) t
          WHERE '$$regulated_dir$$' != 'abs' OR ('$$regulated_dir$$' = 'abs' AND term like 'average%')
        ]]>
      </sql>
    </sqlQuery>


    <sqlQuery name="MinMaxAvgMed" >
      <column name="internal"/>
      <column name="term"/>
      <column name="display"/>
      <sql>
        <![CDATA[
          SELECT 'average' as term,
                'average' as internal,
                'average' as display
          UNION
          SELECT 'minimum' as term,
                'minimum' as internal,
                'minimum' as display
          UNION
          SELECT 'maximum' as term,
                'maximum' as internal,
                'maximum' as display
          UNION
          SELECT 'median' as term,
                'median' as internal,
                'median' as display
        ]]>
      </sql>
    </sqlQuery>



    <sqlQuery name="GenericDirectSamples" >
      <paramRef ref="geneParams.profileset_generic"/>
      <column name="internal"/>
      <column name="term"/>
      <column name="display"/>
      <sql>
        SELECT name as term,
          profile_element_name_id as internal,
          name as display
        FROM apidb.profileelementname
        ORDER BY element_order
      </sql>
    </sqlQuery>


    <sqlQuery name="GenericDirectSamplesFDR" >
      <column name="internal"/>
      <column name="term"/>
      <column name="display"/>
      <sql>
        SELECT name as term,
          profile_element_name_id as internal,
          name as display
        FROM apidb.profileelementname
        ORDER BY element_order
      </sql>
    </sqlQuery>


    <sqlQuery name="GenericDirectPageSamples" >
      <paramRef ref="geneParams.profileset_generic"/>
      <column name="internal"/>
      <column name="term"/>
      <column name="display"/>
      <sql>
        SELECT distinct pan.name as term
          , pan.PROTOCOL_APP_NODE_ID as internal
          , pan2.name as display
          , pan2.node_order_num
        FROM study.nodenodeset sl
          , study.protocolappnode pan
          , RESULTS.NAFEATUREDIFFRESULT dr
          , webready.PANIO_p io
          , study.protocolappnode pan2
        WHERE sl.node_set_id = '$$profileset_generic$$'
          AND sl.PROTOCOL_APP_NODE_ID = pan.PROTOCOL_APP_NODE_ID
          AND pan.PROTOCOL_APP_NODE_ID = dr.PROTOCOL_APP_NODE_ID
          AND pan.protocol_app_node_id = io.output_pan_id
          AND io.input_pan_id = pan2.protocol_app_node_id
        ORDER BY pan2.node_order_num
      </sql>
    </sqlQuery>


    <sqlQuery name="GenericSamples" >
      <paramRef ref="geneParams.profileset_generic"/>
      <column name="internal"/>
      <column name="term"/>
      <column name="display"/>
      <sql>
        SELECT
          protocol_app_node_id as internal, protocol_app_node_name as term,
          protocol_app_node_name AS display
        FROM (
          SELECT DISTINCT protocol_app_node_id, protocol_app_node_name, node_order_num
          FROM apidbtuning.ProfileSamples
          WHERE study_id in ($$profileset_generic$$)
          ORDER BY node_order_num
        ) t
      </sql>
    </sqlQuery>


    <sqlQuery name="GenericPercentileSamples" >
      <paramRef ref="geneParams.profileset_generic"/>
      <paramRef ref="geneParams.channel"/>
      <column name="internal"/>
      <column name="term"/>
      <sql>
        SELECT protocol_app_node_id as internal, protocol_app_node_name as term, node_order_num
        FROM apidbtuning.ProfileSamples
        WHERE study_id in ($$profileset_generic$$)
          AND profile_type like CONCAT('%', '$$channel$$', '%')
        ORDER BY node_order_num
      </sql>
    </sqlQuery>


    <sqlQuery name="GenericCoverageSamples" >
      <paramRef ref="geneParams.profileset_generic_coverage"/>
      <column name="internal"/>
      <column name="term"/>
      <column name="display"/>
      <sql>
        SELECT
          protocol_app_node_id as internal, protocol_app_node_name as term,
          REGEXP_REPLACE (protocol_app_node_name, '\s*\[(.)*\]\s*(.*)\s*', '')   AS display
        FROM (
          SELECT DISTINCT protocol_app_node_id, protocol_app_node_name, node_order_num
          FROM apidbtuning.ProfileSamples
          WHERE study_id = '$$profileset_generic$$'
          ORDER BY node_order_num
        ) t
      </sql>
    </sqlQuery>

    <sqlQuery name="RnaSeqSamples" >
      <paramRef ref="userDatasetParams.rna_seq_dataset"/>
      <paramRef ref="userDatasetParams.profileset_generic"/>
      <column name="internal"/>
      <column name="term"/>
      <column name="display"/>
      <sql>
        SELECT protocol_app_node_id as internal, name as term,
          name as display
        FROM (
          SELECT protocol_app_node_id, name, node_order_num
          FROM @VDI_DATASETS_SCHEMA@.ud_ProtocolAppNode
          WHERE profile_set_id = '$$profileset_generic$$'
          ORDER BY node_order_num, protocol_app_node_id
        ) t
      </sql>
    </sqlQuery>


    <sqlQuery name="RnaSeqSamplesAntisense" >
      <paramRef ref="userDatasetParams.rna_seq_dataset"/>
      <column name="internal"/>
      <column name="term"/>
      <sql>
        SELECT name as term,
        string_agg(protocol_app_node_id::text, ',' ORDER BY name) as internal
        FROM (
          SELECT pan.protocol_app_node_id, pan.node_order_num,
            regexp_replace(regexp_replace(pan.name, '-forward$', ''), '-reverse$', '') as name
          FROM @VDI_DATASETS_SCHEMA@.ud_ProtocolAppNode pan, @VDI_DATASETS_SCHEMA@.ud_ProfileSet ps
          WHERE pan.profile_set_id = ps.profile_set_id
            AND ps.user_dataset_id = $$rna_seq_dataset$$
        ) t
        GROUP BY name
        ORDER BY max(node_order_num), name
      </sql>
    </sqlQuery>


    <sqlQuery name="GenericDESeqSamples" >
      <paramRef ref="geneParams.profileset_generic"/>
      <column name="internal"/>
      <column name="term"/>
      <column name="display"/>
      <sql>
        WITH perc_samples AS (
          SELECT REGEXP_REPLACE (study_name, ' \[.+\]', '') as study_name,
            protocol_app_node_name, node_order_num
          FROM ApidbTuning.ProfileSamples
          WHERE profile_type='channel1_percentiles'
        )
        SELECT distinct ap.value as term, ap.value as internal, ap.value as display, ps.node_order_num
        FROM Study.ProtocolAppNode an, Study.ProtocolAppParam ap,
          Study.nodenodeset sl, Study.nodeset s, Study.Output o, perc_samples ps
        WHERE sl.node_set_id = $$profileset_generic$$
          AND o.protocol_app_node_id = sl.protocol_app_node_id
          AND o.protocol_app_id = ap.protocol_app_id
          AND an.name like '%DESeq%'
          AND o.protocol_app_node_id = an.protocol_app_node_id
          AND sl.node_set_id = s.node_set_id
          AND ps.study_name = regexp_replace (s.name, ' \[.+\]', '')
          AND ap.value = ps.protocol_app_node_name
        ORDER BY ps.node_order_num
      </sql>
    </sqlQuery>


    <!-- placeholder -->
    <sqlQuery name="GenericProfiles" >
      <column name="display"/>
      <column name="internal"/>
      <column name="term"/>
      <sql>
        SELECT profile_study_id AS internal, profile_set_name AS term,
          profile_set_name AS display
        FROM apidbtuning.profileType
      </sql>
    </sqlQuery>


    <sqlQuery name="DatasetUrl" >
      <column name="internal"/>
      <column name="term"/>
      <sql>
        SELECT
          CONCAT('https://${projectName}.org/a/app/record/dataset/' , dataset_presenter_id ) as internal,
          CONCAT('https://${projectName}.org/a/app/record/dataset/' , dataset_presenter_id ) as term
        FROM ApidbTuning.DatasetPresenter
      </sql>
    </sqlQuery>



    <sqlQuery name="rna_seq_profileset"  isCacheable="false">
      <paramRef ref="userDatasetParams.rna_seq_dataset"/>
      <column name="display"/>
      <column name="internal"/>
      <column name="term"/>
      <sql>
        SELECT
          profile_set_id AS internal,
          profile_set_id AS term,
          name AS display
        FROM @VDI_DATASETS_SCHEMA@.ud_profileset
        WHERE user_dataset_id = $$rna_seq_dataset$$
      </sql>
    </sqlQuery>



    <sqlQuery name="GenericSamplesConfidence"  isCacheable="false">
      <paramRef ref="geneParams.profileset_generic"/>
      <column name="internal"/>
      <column name="term"/>
      <column name="display"/>
      <sql>
        SELECT DISTINCT
          ndr.protocol_app_node_id as internal, pan.name as term,
          pan.name as display
        FROM results.nafeaturediffresult ndr, study.protocolappnode pan, study.nodenodeset sl
        WHERE pan.protocol_app_node_id = sl.protocol_app_node_id
          AND ndr.protocol_app_node_id = pan.protocol_app_node_id
          AND sl.node_set_id = '$$profileset_generic$$'
      </sql>
    </sqlQuery>



    <sqlQuery name="KissingerRTPCRProfiles" includeProjects="CryptoDB,UniDB">
      <column name="display"/>
      <column name="internal"/>
      <column name="term"/>
      <sql>
        SELECT
          profile_study_id AS internal, profile_set_name AS term,
          'C.parvum expression profiles based on RT-PCR' as display
        FROM apidbtuning.profileType
        WHERE profile_set_name = 'Cparvum_RT_PCR_Kissinger'
      </sql>
    </sqlQuery>


     <sqlQuery name="CoexpSource">
             <column name="internal"/>
             <column name="term"/>
          <sql>
	    SELECT 'Meyer' AS internal, 'Meyer' as term
          </sql>
     </sqlQuery>

     <sqlQuery name="CoexpSource_OMeara">
             <column name="internal"/>
             <column name="term"/>
          <sql>
	    SELECT 'OMeara' AS internal, 'OMeara' as term
          </sql>
     </sqlQuery>

    <!-- sqlQueries for Splice Site Q -->

    <!-- placeholder -->

    <sqlQuery name="SpliceSiteExperiment" includeProjects="TriTrypDB,UniDB">
      <column name="internal" />
      <column name="term" />
      <column name="display" />
      <sql>
        SELECT ed.name as term, edr.external_database_release_id as internal, ed.name as display
        FROM sres.externaldatabase ed, sres.externaldatabaserelease edr
        WHERE ed.name like '%Spliced_Leader_rnaSeqSplicedLeaderAndPolyASites_RSRC'
          AND edr.external_database_id = ed.external_database_id
      </sql>
    </sqlQuery>



    <sqlQuery name="SpliceSiteSample" doNotTest="1" includeProjects="TriTrypDB,UniDB">
      <paramRef ref="geneParams.splice_site_generic" quote="false"/>
      <column name="internal" />
      <column name="term" />
      <column name="display" />
      <sql>
        SELECT DISTINCT
          o.name AS term, o.protocol_app_node_id AS internal,
          replace (o.name, ' [feature_loc](SpliceSites)', '') AS display
        FROM webready.PANIO_p ioo
          , study.protocolappnode i
          , webready.PANIO_p ioi
          , study.protocolappnode o
          , apidbtuning.profilesamples ps
        WHERE ioo.output_pan_id = ps.protocol_app_node_id
          AND ioo.input_pan_id = i.protocol_app_node_id
          AND ioi.input_pan_id = i.protocol_app_node_id
          AND ioi.output_pan_id = o.protocol_app_node_id
          AND ps.dataset_name ='$$splice_site_generic$$'
          AND o.NAME LIKE '%feature_loc%'
        ORDER BY o.name
      </sql>
    </sqlQuery>

    <!--
-->
    <sqlQuery name="SamplesMetadataMulti" doNotTest="1" includeProjects="PlasmoDB,UniDB">
      <column name="term" />
      <column name="value"/>
      <column name="property" />
      <sql>
        <![CDATA[
          SELECT DISTINCT pan_name as term, property, string_value
          FROM apidbTuning.Metadata
          WHERE lower(dataset_name) like '%icemr%'
        ]]>
      </sql>
    </sqlQuery>

    <sqlQuery name="SamplesMetadataMultiWiz" doNotTest="1">
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
        <![CDATA[
          SELECT DISTINCT md.pan_id as internal,
                          md.property as ontology_term_name,
                          md.number_value,
                          md.string_value,
                          md.date_value
          FROM apidbTuning.Metadata md
          WHERE lower(dataset_name) like '%icemr%'
        ]]>
      </sql>
    </sqlQuery>


    <sqlQuery name="OntologyMetadataSpec_ICEMR_Wiz" doNotTest="1">
      <column name="ontology_term_name"/>
      <column name="parent_ontology_term_name"/>
      <column name="display_name"/>
      <column name="description"/>
      <column name="type"/>
      <column name="units"/>
      <column name="precision"/>
      <column name="is_range"/>
      <sql>
        <![CDATA[
          SELECT distinct ontology_term_name, parent_ontology_term_name, display_name,
                          description, units, type, is_range, precision
          FROM apidbTuning.Ontology
          WHERE lower(dataset_name) like '%icemr%'
        ]]>
      </sql>
    </sqlQuery>


    <sqlQuery name="SamplesMetadataLoffler" doNotTest="1" >
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
        <![CDATA[
          SELECT DISTINCT md.pan_id as internal,
                          md.property as ontology_term_name,
                          md.number_value,
                          md.string_value,
                          md.date_value
          FROM apidbTuning.Metadata md
          WHERE lower(dataset_name) like '%loffler%'
        ]]>
      </sql>
    </sqlQuery>


    <sqlQuery name="OntologyMetadataSpec_Loffler" doNotTest="1">
      <column name="ontology_term_name"/>
      <column name="parent_ontology_term_name"/>
      <column name="display_name"/>
      <column name="description"/>
      <column name="type"/>
      <column name="units"/>
      <column name="precision"/>
      <column name="is_range"/>
      <sql>
        <![CDATA[
          SELECT DISTINCT ontology_term_name, parent_ontology_term_name, display_name,
                          description, units, type, is_range, precision
          FROM apidbTuning.Ontology
          WHERE lower(dataset_name) like '%loffler%'
        ]]>
      </sql>
    </sqlQuery>




        <!-- TEMPLATE_ANCHOR coexpressionSourceQuery -->


        <!-- TEMPLATE_ANCHOR antisenseSamplesParamQuery -->
        <!-- TEMPLATE_ANCHOR rnaSeqProfileSetParamQuery -->
        <!-- TEMPLATE_ANCHOR datasetUrlParamQuery -->
	<!-- TEMPLATE_ANCHOR rnaSeqPctProfileSetParamQuery -->

	<!-- TEMPLATE_ANCHOR rnaSeqProfileSetParamQueryTroemelTC -->
    <!-- TEMPLATE_ANCHOR rnaSeqProfileSetParamQueryHehlToxo -->
    <!-- TEMPLATE_ANCHOR rnaSeqPctProfileSetParamQueryHehlToxo -->
    <!-- TEMPLATE_ANCHOR antisenseSamplesParamQueryHehlToxo -->

    <!-- TEMPLATE_ANCHOR rnaSeqProfileSimilarityParamQuery -->
    <!-- TEMPLATE_ANCHOR rnaSeqProfileSimilarityTimeShiftParamQuery -->

    <!-- TEMPLATE_ANCHOR expressionProfileSetParamQuery -->

    <!-- TEMPLATE_ANCHOR expressionSamplesParamQueryDirect -->
    <!-- TEMPLATE_ANCHOR expressionPctSamplesParamQueryDirect -->

    <!-- TEMPLATE_ANCHOR antibodyArrayProfileSetParamQuery -->

    <!-- TEMPLATE_ANCHOR expressionSamplesParamQueryDirectFDR -->

    <!-- TEMPLATE_ANCHOR PageProfileSetParamQuery -->

    <!-- TEMPLATE_ANCHOR  spliceSitesProfileSetParamQuery-->
    <!-- TEMPLATE_ANCHOR  spliceSitesProfileSetsQuery-->

    <!-- TEMPLATE_ANCHOR DESeqProfileSetParamQuery-->




    <sqlQuery name="TextFields">
      <column name="internal"/>
      <column name="term"/>
      <sql>
        SELECT field_name as internal,
          case field_name
          when 'Blastp' then 'Similar proteins (BLAST hits v. NRDB/PDB)'
          when 'CellularLocalization' then 'Cellular localization'
          when 'EcNumber' then 'EC descriptions'
          when 'GeneId' then 'Gene ID'
          when 'Notes' then 'Gene notes'
          when 'PreviousReleaseGenes' then 'Genes of previous release'
          when 'Product' then 'Gene product'
          when 'GoTerms' then 'GO terms and definitions'
          when 'MetabolicPathways' then 'Metabolic pathway names and descriptions'
          when 'InterPro' then 'Protein domain names and descriptions'
          when 'RodMalPhenotype' then 'Rodent malaria phenotype'
          when 'Comments' then 'User comments'
          when 'CommunityAnnotation' then 'Community annotation'
          else field_name
          end as term
        FROM (
          SELECT field_name from ApidbTuning.GeneTextSearch
          UNION
          SELECT 'Blastp' as field_name
          UNION
          SELECT 'Comments' as field_name
          UNION
          SELECT 'CommunityAnnotation' as field_name from ApidbTuning.GeneTextSearch where project_id in ('ToxoDB', 'GiardiaDB')
        ) t
        order by term
      </sql>
    </sqlQuery>

    <sqlQuery name="missingOrFoundTranscripts"  >
      <paramRef ref="geneParams.genesWithTranscripts" />
      <column name="display" />
      <column name="term" />
      <column name="internal" />
      <sql>
        SELECT 'missing in the result' as display, 'missing_transcripts' as term, 'missing_transcripts' as internal WHERE $$genesWithTranscripts$$ = 'genes_missing_transcripts'
        UNION
        SELECT 'returned in the result' as display, 'found_transcripts' as term, 'found_transcripts' as internal WHERE $$genesWithTranscripts$$ = 'genes_missing_transcripts'
        UNION
        SELECT 'all' as display, 'all_transcripts' as term, 'all_transcripts' as internal
      </sql>
    </sqlQuery>



    <sqlQuery name="SnpChipMetadataDatasets" doNotTest="1" includeProjects="PlasmoDB,UniDB">
      <column name="term" />
      <column name="display" />
      <column name="internal"/>
      <sql>
        <![CDATA[
          SELECT dd.name AS term
            , dd.name as internal
            , dsp.display_name AS display
          FROM
              apidbtuning.datasetpresenter dsp
            , apidbtuning.datasetdatasource dd
          WHERE
            dsp.dataset_presenter_id = dd.dataset_presenter_id
            AND dsp.subtype in ('Broad_3k_array', 'Broad_75K_array', 'Broad_barcode', 'NIH_10k')
          ORDER BY dd.name DESC
        ]]>
      </sql>
    </sqlQuery>

  </querySet>

  <groupSet name="geneParamGroupSet">

    <!-- groups for testing wizard -->

    <group name="reference_samples" displayName="Reference Samples" displayType="ShowHide">
      <description>
        <![CDATA[
          Select samples for the reference set
        ]]>
      </description>
    </group>

    <group name="comparison_samples" displayName="Comparison Samples" displayType="ShowHide">
      <description>
        <![CDATA[
          Select samples for the comparison set
        ]]>
      </description>
    </group>

    <group name="direction" displayName="Direction" displayType="ShowHide">
      <description>
        <![CDATA[
          Choose whether to look for increased or decreased immunogenicity.
        ]]>
      </description>
    </group>

    <group name="significance" displayName="Significance" displayType="ShowHide">
      <description>
        <![CDATA[
          Select the P value signficance threshold
        ]]>
      </description>
    </group>

    <!-- end of wizard groups -->

  </groupSet>

</wdkModel>
