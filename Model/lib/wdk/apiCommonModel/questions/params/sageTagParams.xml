<wdkModel>

  <paramSet name="sageTagParams" includeProjects="EuPathDB,ToxoDB,TriTrypDB,PlasmoDB,GiardiaDB">


        <stringParam name="single_gene_id"
                     prompt="Gene ID"
                     number="false">
            <help>Gene IDs (locus tags) are quite different for each species. We use the gene IDs provided by the sequence generator.</help>

           <suggest default="%%defaultGene%%"/>

        </stringParam>

        <stringParam name="sequence"
                     prompt="Tag Sequence"
                     number="false">
            <help>
               Enter a SAGE Tag Sequence.
            </help>
           <suggest includeProjects="ToxoDB"
                    default="CATGCAGCGAAGTG"/>
           <suggest includeProjects="PlasmoDB"
                    default="GTAATAAATG"/>
           <suggest includeProjects="GiardiaDB"
                    default="GGGCTCTAGTG"/>
           <suggest includeProjects="TriTrypDB"
                    default="CATGTTCAGCAGCTCCATCA"/>
           <suggest includeProjects="EuPathDB"
                    default="GTAATAAATG"/>
           <regex>[ACGTacgt ]*</regex>
        </stringParam>


        <datasetParam name="rad_source_id"
                      recordClassRef="SageTagRecordClasses.SageTagRecordClass"
                     prompt="SAGE Tag ID input set">
            <help>Input a comma delimited set of SAGE Tag IDs, or upload a file. Wildcards (*) are allowed.</help>
           <suggest includeProjects="GiardiaDB"
                    default="670"/>
           <suggest includeProjects="ToxoDB"
                    default="TGME49_chrVI-484416-484430.1"/>
           <suggest includeProjects="TriTrypDB"
                    default="Tb927_01_v4-1001573-1001594.1"/>
           <suggest includeProjects="PlasmoDB"
                    default="Pf3D7_11_v3-1295356-1295370.0"/>
<suggest includeProjects="EuPathDB"
                    default="670,Pf3D7_11_v3-1295356-1295370.0"/>

	</datasetParam>
<!--
       <stringParam name="rad_source_id" includeProjects="EuPathDB"
                     prompt="ID"
                     substitute="yes">
            <help>
               Enter an external identifier or a SAGE Tag ID. Wildcards (*) are allowed.
            </help>
           <suggest includeProjects="EuPathDB"
                    default="670"/>
        </stringParam>
-->

        <enumParam name="is_within_gene"
                     prompt="Within Genes Only"
                     multiPick="false"
                     quote="false">
<noTranslation value="true" includeProjects="EuPathDB" />
          <help>
             SAGE Tags are short sequences and can align to several geomic coordinates.  Choose Yes to restrict to SAGE tags falling within a gene.
          </help>
          <enumList>   
            <enumValue>
              <term>Yes</term>
              <internal> </internal>
            </enumValue>
            <enumValue>
              <term>No</term>
              <internal>(+)</internal>
            </enumValue>
          </enumList>   
        </enumParam>

        <enumParam name="is_within_gene_not"
                     prompt="Within Genes Only"
                     multiPick="false"
                     quote="false">
<noTranslation value="true" includeProjects="EuPathDB" />
          <help>
             SAGE Tags are short sequences and can align to several geomic coordinates.  Choose Yes to restrict to SAGE tags falling within a gene.
          </help>
          <enumList>   
            <enumValue>
              <term>Yes</term>
              <internal>not</internal>
            </enumValue>
            <enumValue>
              <term>No</term>
              <internal> </internal>
            </enumValue>
          </enumList>   
        </enumParam>


       <stringParam name="st_min_count" includeProjects="PlasmoDB,ToxoDB,GiardiaDB,TriTrypDB,EuPathDB"
                     prompt="Minimum tag count"
                     number="true">
            <help>Enter the minimum frequency of the SAGE tags meeting your criteria (raw/normalized).  Tags must have this minimum frequency in at least one selected SAGE library.</help>
             <suggest default="2"/>
           <regex>\d+(\.\d+)?</regex>
        </stringParam>

        <enumParam name="raw_normalized"
                     prompt="Data Type"
                     multiPick="false"
                     quote="false">
<noTranslation value="true" includeProjects="EuPathDB" />
          <help>
             Choose normalized or raw data.
          </help>
          <enumList>   
            <enumValue>
              <term>Normalized</term>
              <internal>n</internal>
            </enumValue>
            <enumValue>
              <term>Raw</term>
              <internal>r</internal>
            </enumValue>
          </enumList>   
        </enumParam>

       <flatVocabParam name="sage_experiment" includeProjects="PlasmoDB,ToxoDB,GiardiaDB,TriTrypDB,EuPathDB" 
                     excludeProjects="TriTrypDB"
                     queryRef="SAGEtgVQ.experimentname"
                     prompt="Experiment Name"
                     multiPick="false">
        <help>
           Choose SAGE tag experiment name.
        </help>    
       </flatVocabParam>

       
    <answerParam name="sageTag_result"
                  prompt="Input Result Set"
                  readonly="true"
                  visible="false">
        <recordClass ref="SageTagRecordClasses.SageTagRecordClass" />
    </answerParam>

  </paramSet>

    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!--  Vocab queries-->  
    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
 <querySet name="SAGEtgVQ" queryType="vocab" isCacheable="true">
   <sqlQuery name="experimentname" includeProjects="PlasmoDB,GiardiaDB,TriTrypDB,ToxoDB">
            <column name="internal"/>
            <column name="term"/>
            <sql includeProjects="PlasmoDB,GiardiaDB,ToxoDB">
         <![CDATA[
            select q.name as internal, q.name as term
            from core.TABLEINFO t, rad.QUANTIFICATION q
            where t.table_id = q.result_table_id
            and t.name = 'SAGETagResult'
            order by quantification_id
         ]]>
            </sql>
            <sql includeProjects="TriTrypDB">
         <![CDATA[
            select q.name as internal, q.name as term
            from core.TABLEINFO t, rad.QUANTIFICATION q
            where t.table_id = q.result_table_id
            and t.name = 'SAGETagResult'
            and q.name in ('bloodstream_gambiense', 'procyclic_gambiense','bloodstream_brucei')
            order by q.name
         ]]>
            </sql>
   </sqlQuery>
   <processQuery name="experimentname" processName="org.apidb.apicomplexa.wsfplugin.apifed.ApiFedPlugin" includeProjects="EuPathDB">
            <wsColumn name="internal" width="100"/>
            <wsColumn name="term" width="100"/>
   </processQuery>
  </querySet>
</wdkModel>
